<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>擴展讀取能力 — 系統架構圖解</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang HK", "Microsoft JhengHei", sans-serif;
      background: #0f1117;
      color: #e0e0e0;
      min-height: 100vh;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 40px 24px;
    }

    header {
      text-align: center;
      margin-bottom: 40px;
    }

    header h1 {
      font-size: 2rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
    }

    header p {
      font-size: 1rem;
      color: #9ca3af;
      line-height: 1.6;
    }

    .tabs {
      display: flex;
      gap: 4px;
      background: #1a1d27;
      border-radius: 12px;
      padding: 4px;
      margin-bottom: 32px;
      overflow-x: auto;
    }

    .tab-btn {
      flex: 1;
      padding: 12px 16px;
      border: none;
      background: transparent;
      color: #9ca3af;
      font-size: 0.9rem;
      font-weight: 500;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.25s ease;
      white-space: nowrap;
      font-family: inherit;
    }

    .tab-btn:hover {
      color: #e0e0e0;
      background: rgba(255, 255, 255, 0.05);
    }

    .tab-btn.active {
      background: #6366f1;
      color: #ffffff;
      font-weight: 600;
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: #1a1d27;
      border-radius: 16px;
      padding: 32px;
      margin-bottom: 24px;
      border: 1px solid #2a2d3a;
    }

    .card h2 {
      font-size: 1.5rem;
      color: #ffffff;
      margin-bottom: 8px;
    }

    .card .subtitle {
      font-size: 0.95rem;
      color: #6366f1;
      font-weight: 500;
      margin-bottom: 16px;
    }

    .card p {
      font-size: 0.95rem;
      color: #c0c4cc;
      line-height: 1.8;
      margin-bottom: 12px;
    }

    .card h3 {
      color: #fff;
      font-size: 1.1rem;
      margin-bottom: 12px;
    }

    .diagram-container {
      background: #13151c;
      border-radius: 12px;
      padding: 24px;
      margin: 24px 0;
      overflow-x: auto;
      border: 1px solid #2a2d3a;
    }

    .diagram-container svg {
      display: block;
      margin: 0 auto;
      max-width: 100%;
      height: auto;
    }

    .steps {
      list-style: none;
      padding: 0;
      margin: 16px 0;
    }

    .steps li {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px solid #2a2d3a;
      font-size: 0.95rem;
      color: #c0c4cc;
      line-height: 1.6;
    }

    .steps li:last-child {
      border-bottom: none;
    }

    .step-num {
      flex-shrink: 0;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #6366f1;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 700;
    }

    .pros-cons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-top: 16px;
    }

    @media (max-width: 640px) {
      .pros-cons {
        grid-template-columns: 1fr;
      }
    }

    .pros, .cons {
      background: #13151c;
      border-radius: 10px;
      padding: 16px;
    }

    .pros h4 {
      color: #34d399;
      font-size: 0.9rem;
      margin-bottom: 8px;
    }

    .cons h4 {
      color: #f87171;
      font-size: 0.9rem;
      margin-bottom: 8px;
    }

    .pros ul, .cons ul {
      list-style: none;
      padding: 0;
    }

    .pros li, .cons li {
      font-size: 0.85rem;
      color: #c0c4cc;
      padding: 4px 0;
      line-height: 1.5;
    }

    .pros li::before {
      content: "✓ ";
      color: #34d399;
      font-weight: 700;
    }

    .cons li::before {
      content: "✗ ";
      color: #f87171;
      font-weight: 700;
    }

    .highlight-box {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05));
      border-left: 3px solid #6366f1;
      border-radius: 0 10px 10px 0;
      padding: 16px 20px;
      margin-top: 16px;
    }

    .highlight-box h4 {
      color: #a5b4fc;
      font-size: 0.9rem;
      margin-bottom: 6px;
    }

    .highlight-box p {
      font-size: 0.9rem;
      color: #c0c4cc;
      margin-bottom: 0;
    }

    .highlight-box.green {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.04));
      border-left-color: #22c55e;
    }

    .highlight-box.green h4 {
      color: #4ade80;
    }

    .highlight-box.amber {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.04));
      border-left-color: #f59e0b;
    }

    .highlight-box.amber h4 {
      color: #fbbf24;
    }

    @media (max-width: 600px) {
      .container {
        padding: 24px 16px;
      }

      header h1 {
        font-size: 1.5rem;
      }

      .tab-btn {
        font-size: 0.8rem;
        padding: 10px 12px;
      }

      .card {
        padding: 20px;
      }
    }
    /* AI Viber */
    .prompt-card { background: #13151c; border-radius: 12px; padding: 20px; margin-bottom: 16px; border: 1px solid #2a2d3a; }
    .prompt-card h4 { color: #a5b4fc; font-size: 0.95rem; margin-bottom: 12px; }
    .prompt-text { background: #0a0b10; border-radius: 8px; padding: 16px; font-size: 0.85rem; color: #c0c4cc; line-height: 1.8; white-space: pre-wrap; word-break: break-word; border: 1px solid #2a2d3a; position: relative; }
    .prompt-text .placeholder { color: #fbbf24; font-weight: 600; }
    .copy-btn { margin-top: 10px; padding: 8px 16px; background: #6366f1; color: #fff; border: none; border-radius: 8px; font-size: 0.8rem; cursor: pointer; font-family: inherit; transition: all 0.2s ease; }
    .copy-btn:hover { background: #4f46e5; }
    .copy-btn.copied { background: #10B981; }
  
    .related-topics { margin-top: 32px; }
    .related-topics h3 { color: #ffffff; font-size: 1.1rem; margin-bottom: 14px; }
    .related-links { display: flex; flex-wrap: wrap; gap: 10px; }
    .related-link { display: inline-block; padding: 8px 16px; background: #13151c; border: 1px solid #2a2d3a; border-radius: 20px; color: #a5b4fc; font-size: 0.85rem; text-decoration: none; transition: all 0.2s ease; }
    .related-link:hover { background: #6366f1; color: #ffffff; border-color: #6366f1; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Scale Reads — 擴展讀取能力</h1>
      <p>點樣應對：App 突然爆紅，一夜之間由 0 去到 100 萬用戶</p>
    </header>

    <div class="tabs">
      <button class="tab-btn active" data-tab="overview">① 全局思路</button>
      <button class="tab-btn" data-tab="indexing">② 優化查詢 + 索引</button>
      <button class="tab-btn" data-premium="true" data-tab="caching">③ 三層 Cache</button>
      <button class="tab-btn" data-premium="true" data-tab="replicas">④ 讀取副本</button>
      <button class="tab-btn" data-premium="true" data-tab="ai-viber">⑤ AI Viber</button>
    </div>

    <!-- ===================== TAB 1: Overview ===================== -->
    <div class="tab-content active" id="overview">
      <div class="card">
        <h2>全局思路 — 逐步解決讀取瓶頸</h2>
        <div class="subtitle">一個好重要嘅原則：唔好亂嚟，先搵出邊度出事</div>
        <p>
          用個比喻嚟理解。想像開咗間餐廳，突然一夜之間排晒隊入嚟——第一件事唔係即刻請多 50 個廚師，而係先搵出邊度最塞：係落單嗰度慢？定係廚房煮嘢慢？定係上菜太慢？系統設計都係一樣，第一步永遠係「搵出瓶頸喺邊」。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 520" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowRed">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#ef4444" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <filter id="glowGreenResult">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#22c55e" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradStep1" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a2520"/>
              </linearGradient>
              <linearGradient id="gradStep2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1e2e25"/>
              </linearGradient>
              <linearGradient id="gradStep3" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#252040"/>
              </linearGradient>
              <linearGradient id="gradStep4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a2040"/>
              </linearGradient>
              <marker id="arrowP" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#6366f1"/>
              </marker>
              <marker id="arrowDown" markerWidth="8" markerHeight="8" refX="4" refY="7" orient="auto">
                <path d="M0,0 L4,8 L8,0 Z" fill="#6366f1"/>
              </marker>
            </defs>

            <!-- Title -->
            <text x="400" y="25" text-anchor="middle" fill="#9ca3af" font-size="13" font-weight="600">解決讀取瓶頸嘅四個層級</text>

            <!-- Problem -->
            <g transform="translate(250,40)" filter="url(#glowRed)">
              <rect width="300" height="55" rx="14" fill="#1e293b" stroke="#ef4444" stroke-width="2" filter="url(#shadow)"/>
              <text x="150" y="22" text-anchor="middle" fill="#f87171" font-size="13" font-weight="700">🔥 問題：App 頂唔住百萬用戶</text>
              <text x="150" y="42" text-anchor="middle" fill="#9ca3af" font-size="10.5">資料庫被大量讀取請求壓爆</text>
            </g>
            <line x1="400" y1="97" x2="400" y2="120" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowDown)"/>

            <!-- Step 1 -->
            <g transform="translate(200,123)">
              <rect width="400" height="55" rx="14" fill="url(#gradStep1)" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
              <text x="30" y="22" fill="#fbbf24" font-size="12" font-weight="700">第一步</text>
              <text x="30" y="42" fill="#9ca3af" font-size="11">搵出瓶頸喺邊：Server？資料庫讀取？寫入？</text>
              <rect x="310" y="10" width="72" height="22" rx="6" fill="rgba(245,158,11,0.15)"/>
              <text x="346" y="26" text-anchor="middle" fill="#fbbf24" font-size="9" font-weight="600">診斷問題</text>
            </g>
            <line x1="400" y1="180" x2="400" y2="203" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowDown)"/>

            <!-- Step 2 -->
            <g transform="translate(200,206)">
              <rect width="400" height="55" rx="14" fill="url(#gradStep2)" stroke="#22c55e" stroke-width="2" filter="url(#shadow)"/>
              <text x="30" y="22" fill="#4ade80" font-size="12" font-weight="700">第二步</text>
              <text x="30" y="42" fill="#9ca3af" font-size="11">優化查詢 + 加 Index（索引）加速資料庫</text>
              <rect x="310" y="10" width="72" height="22" rx="6" fill="rgba(34,197,94,0.15)"/>
              <text x="346" y="26" text-anchor="middle" fill="#4ade80" font-size="9" font-weight="600">最低成本</text>
            </g>
            <line x1="400" y1="263" x2="400" y2="286" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowDown)"/>

            <!-- Still not enough? -->
            <g transform="translate(540,248)">
              <rect width="120" height="24" rx="12" fill="rgba(248,113,113,0.12)"/>
              <text x="60" y="16" text-anchor="middle" fill="#f87171" font-size="9" font-weight="600">仲係唔夠快？⬇</text>
            </g>

            <!-- Step 3 -->
            <g transform="translate(200,289)">
              <rect width="400" height="55" rx="14" fill="url(#gradStep3)" stroke="#6366f1" stroke-width="2" filter="url(#shadow)"/>
              <text x="30" y="22" fill="#a5b4fc" font-size="12" font-weight="700">第三步</text>
              <text x="30" y="42" fill="#9ca3af" font-size="11">加 Cache（三層快取：伺服器、CDN、裝置）</text>
              <rect x="310" y="10" width="72" height="22" rx="6" fill="rgba(99,102,241,0.15)"/>
              <text x="346" y="26" text-anchor="middle" fill="#a5b4fc" font-size="9" font-weight="600">大幅提速</text>
            </g>
            <line x1="400" y1="346" x2="400" y2="369" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowDown)"/>

            <!-- Still not enough? -->
            <g transform="translate(540,331)">
              <rect width="120" height="24" rx="12" fill="rgba(248,113,113,0.12)"/>
              <text x="60" y="16" text-anchor="middle" fill="#f87171" font-size="9" font-weight="600">仲係唔夠？⬇</text>
            </g>

            <!-- Step 4 -->
            <g transform="translate(200,372)">
              <rect width="400" height="55" rx="14" fill="url(#gradStep4)" stroke="#818cf8" stroke-width="2" filter="url(#shadow)"/>
              <text x="30" y="22" fill="#c4b5fd" font-size="12" font-weight="700">第四步</text>
              <text x="30" y="42" fill="#9ca3af" font-size="11">加 Read Replicas（讀取副本），分擔資料庫壓力</text>
              <rect x="310" y="10" width="72" height="22" rx="6" fill="rgba(129,140,248,0.15)"/>
              <text x="346" y="26" text-anchor="middle" fill="#c4b5fd" font-size="9" font-weight="600">終極方案</text>
            </g>

            <!-- Final result -->
            <line x1="400" y1="429" x2="400" y2="452" stroke="#22c55e" stroke-width="2" marker-end="url(#arrowDown)"/>
            <g transform="translate(250,455)" filter="url(#glowGreenResult)">
              <rect width="300" height="45" rx="12" fill="rgba(34,197,94,0.1)" stroke="#22c55e" stroke-width="1.5"/>
              <text x="150" y="20" text-anchor="middle" fill="#4ade80" font-size="12" font-weight="700">✓ 系統可以頂住百萬用戶</text>
              <text x="150" y="37" text-anchor="middle" fill="#9ca3af" font-size="10">每一步都係建基於上一步唔夠嘅時候</text>
            </g>
          </svg>
        </div>

        <h3>核心思路：逐層加碼</h3>
        <ol class="steps">
          <li>
            <span class="step-num">1</span>
            <span><strong>先搵出瓶頸</strong>——係 Server 唔夠力？定係資料庫頂唔住讀取？定係寫入太多？重點係唔好未搞清就亂加嘢，呢個好重要。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span><strong>優化查詢同加 Index</strong>——呢個成本最低、效果最快。就好似間餐廳先優化流程，再諗請人。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span><strong>加 Cache</strong>——三個地方：伺服器前面、CDN 邊緣節點、用戶裝置上。大部分讀取請求都唔使再去資料庫。後面會詳細講解。</span>
          </li>
          <li>
            <span class="step-num">4</span>
            <span><strong>加 Read Replicas</strong>——如果 Cache 都唔夠（例如大部分查詢都係獨特嘅），就開多幾個資料庫副本一齊分擔讀取。呢個係最後嘅大招。</span>
          </li>
        </ol>

        <div class="highlight-box amber">
          <h4>⚠️ 關鍵重點</h4>
          <p>唔好一開始就跳去最複雜嘅方案。面試嘅時候，展示識得「逐步升級」嘅思路，比直接講最複雜嘅答案更加加分。常見嘅錯誤係一上嚟就講 Sharding，面試官反而覺得唔識判斷輕重。</p>
        </div>
      </div>
    </div>

    <!-- ===================== TAB 2: Indexing ===================== -->
    <div class="tab-content" id="indexing">
      <div class="card">
        <h2>優化查詢 + 加索引（Index）</h2>
        <div class="subtitle">成本最低嘅第一步：唔使加機器，改善查詢就有效果</div>
        <p>
          用個比喻嚟解釋。去圖書館搵一本書。如果冇索引（目錄），要行晒每一行書架先搵到。但如果有索引，可以直接知道本書喺邊個書架、邊個位置。資料庫嘅 Index 就係咁——幫資料庫快速搵到需要嘅資料，唔使逐條記錄慢慢揾。呢個概念必須要理解。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 380" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="sh2" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowRedBox">
                <feGaussianBlur stdDeviation="4" result="blur"/>
                <feFlood flood-color="#ef4444" flood-opacity="0.2"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <filter id="glowGreenBox">
                <feGaussianBlur stdDeviation="4" result="blur"/>
                <feFlood flood-color="#22c55e" flood-opacity="0.2"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradBad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a1e22"/>
              </linearGradient>
              <linearGradient id="gradGood" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1e2e25"/>
              </linearGradient>
              <linearGradient id="gradPractice" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="rgba(99,102,241,0.08)"/>
                <stop offset="100%" stop-color="rgba(99,102,241,0.02)"/>
              </linearGradient>
              <marker id="arrG2" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#22c55e"/>
              </marker>
              <marker id="arrR2" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#ef4444"/>
              </marker>
            </defs>

            <!-- Without Index -->
            <text x="200" y="25" text-anchor="middle" fill="#f87171" font-size="13" font-weight="700">✗ 冇 Index</text>
            <g transform="translate(50,35)" filter="url(#glowRedBox)">
              <rect width="300" height="140" rx="14" fill="url(#gradBad)" stroke="#ef4444" stroke-width="1.5" filter="url(#sh2)"/>
              <!-- Table rows -->
              <text x="20" y="25" fill="#9ca3af" font-size="10">查詢：SELECT * WHERE name = 'hillman'</text>
              <g transform="translate(20,40)">
                <rect width="260" height="18" rx="4" fill="rgba(239,68,68,0.08)" stroke="#ef4444" stroke-width="0.5"/>
                <text x="8" y="13" fill="#f87171" font-size="9">→ 逐條記錄睇... 第 1 條</text>
              </g>
              <g transform="translate(20,62)">
                <rect width="260" height="18" rx="4" fill="rgba(239,68,68,0.08)" stroke="#ef4444" stroke-width="0.5"/>
                <text x="8" y="13" fill="#f87171" font-size="9">→ 逐條記錄睇... 第 2 條</text>
              </g>
              <g transform="translate(20,84)">
                <rect width="260" height="18" rx="4" fill="rgba(239,68,68,0.08)" stroke="#ef4444" stroke-width="0.5"/>
                <text x="8" y="13" fill="#f87171" font-size="9">→ 逐條記錄睇... 第 999,999 條 😰</text>
              </g>
              <text x="150" y="125" text-anchor="middle" fill="#f87171" font-size="11" font-weight="600">🐌 超慢！要掃晒全部記錄</text>
            </g>

            <!-- With Index -->
            <text x="600" y="25" text-anchor="middle" fill="#4ade80" font-size="13" font-weight="700">✓ 有 Index</text>
            <g transform="translate(450,35)" filter="url(#glowGreenBox)">
              <rect width="300" height="140" rx="14" fill="url(#gradGood)" stroke="#22c55e" stroke-width="1.5" filter="url(#sh2)"/>
              <text x="20" y="25" fill="#9ca3af" font-size="10">查詢：SELECT * WHERE name = 'hillman'</text>
              <g transform="translate(20,40)">
                <rect width="260" height="18" rx="4" fill="rgba(34,197,94,0.08)" stroke="#22c55e" stroke-width="0.5"/>
                <text x="8" y="13" fill="#4ade80" font-size="9">→ 查索引：'hillman' 在第 42,567 行</text>
              </g>
              <g transform="translate(20,62)">
                <rect width="260" height="18" rx="4" fill="rgba(34,197,94,0.08)" stroke="#22c55e" stroke-width="0.5"/>
                <text x="8" y="13" fill="#4ade80" font-size="9">→ 直接跳去第 42,567 行攞資料</text>
              </g>
              <g transform="translate(20,84)">
                <rect width="260" height="18" rx="4" fill="rgba(34,197,94,0.15)" stroke="#22c55e" stroke-width="1"/>
                <text x="8" y="13" fill="#4ade80" font-size="9">✓ 搞掂！只用咗 2 步</text>
              </g>
              <text x="150" y="125" text-anchor="middle" fill="#4ade80" font-size="11" font-weight="600">⚡ 超快！直接定位到資料</text>
            </g>

            <!-- VS arrow -->
            <text x="400" y="110" text-anchor="middle" fill="#6366f1" font-size="24" font-weight="700">VS</text>

            <!-- Bottom section: What to do -->
            <g transform="translate(100,210)">
              <rect width="600" height="150" rx="14" fill="url(#gradPractice)" stroke="#6366f1" stroke-width="1.5"/>
              <text x="300" y="28" text-anchor="middle" fill="#a5b4fc" font-size="13" font-weight="700">🔍 實際點做</text>

              <text x="30" y="55" fill="#4ade80" font-size="11" font-weight="600">❶ 檢查邊啲查詢最慢</text>
              <text x="50" y="72" fill="#9ca3af" font-size="10">搵出花最多時間嘅 query，呢啲就係瓶頸</text>

              <text x="30" y="97" fill="#4ade80" font-size="11" font-weight="600">❷ 確認用啱資料庫類型</text>
              <text x="50" y="114" fill="#9ca3af" font-size="10">SQL？NoSQL？唔同嘅資料結構適合唔同嘅資料庫</text>

              <text x="30" y="139" fill="#4ade80" font-size="11" font-weight="600">❸ 為最常用嘅查詢加 Index</text>
              <text x="50" y="152" fill="#9ca3af" font-size="10" font-style="italic">（就好似幫圖書館加個目錄，即刻快好多）</text>
            </g>
          </svg>
        </div>

        <h3>具體做法</h3>
        <ol class="steps">
          <li>
            <span class="step-num">1</span>
            <span><strong>檢查邊啲查詢最慢</strong>——用 monitoring 工具搵出花最多時間嘅 query，呢啲就係需要優化嘅重點。建議用 EXPLAIN 嚟分析。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span><strong>確認資料庫類型啱唔啱</strong>——如果資料係大量 key-value 查詢，用 SQL 可能唔係最快。揀啱嘅工具好重要，常見嘅錯誤係用錯 DB 類型。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span><strong>加 Index</strong>——為最常被查詢嘅欄位加索引。資料庫就可以跳過逐條掃描，直接搵到需要嘅記錄。呢步一定要優先做。</span>
          </li>
        </ol>

        <div class="pros-cons">
          <div class="pros">
            <h4>👍 好處</h4>
            <ul>
              <li>成本最低——唔使加機器、唔使改架構</li>
              <li>效果明顯——常見查詢可能快幾十倍</li>
              <li>最優先做呢一步</li>
            </ul>
          </div>
          <div class="cons">
            <h4>👎 限制</h4>
            <ul>
              <li>Index 會令寫入慢少少（因為每次寫都要更新索引）</li>
              <li>如果讀取量太大，純靠 Index 都頂唔住</li>
            </ul>
          </div>
        </div>

        <div class="highlight-box green">
          <h4>💡 重點記住</h4>
          <p>面試嘅時候，永遠先講呢一步。核心思維方式係：「用最低成本先解決問題」。面試官好鍾意呢種答法，因為佢展示咗工程判斷力。</p>
        </div>
      </div>
    </div>

    <!-- ===================== TAB 3: 3-Layer Caching ===================== -->
    <div class="tab-content" id="caching">
      <div class="card">
        <h2>三層 Cache — 層層攔截讀取請求</h2>
        <div class="subtitle">喺三個唔同嘅地方放 Cache，令大部分請求根本唔使去到資料庫</div>
        <p>
          用個比喻嚟理解。想像一間超人氣餐廳。與其每個客人都要入廚房問廚師，可以：① 喺前台放個餐牌（伺服器 Cache）、② 喺附近嘅分店都放（CDN）、③ 俾客人帶餐牌返屋企（裝置 Cache）。咁樣大部分人根本唔使行到廚房。呢個就係「層層攔截」嘅概念。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 530" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="sh3" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowGreenLayer">
                <feGaussianBlur stdDeviation="4" result="blur"/>
                <feFlood flood-color="#22c55e" flood-opacity="0.2"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <filter id="glowAmberLayer">
                <feGaussianBlur stdDeviation="4" result="blur"/>
                <feFlood flood-color="#f59e0b" flood-opacity="0.2"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <filter id="glowIndigoLayer">
                <feGaussianBlur stdDeviation="4" result="blur"/>
                <feFlood flood-color="#6366f1" flood-opacity="0.2"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradDevice" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1e2e25"/>
              </linearGradient>
              <linearGradient id="gradCDN" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a2520"/>
              </linearGradient>
              <linearGradient id="gradServer" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#252040"/>
              </linearGradient>
              <linearGradient id="gradDBs" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1a2e2a"/>
              </linearGradient>
              <marker id="arrB3" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#6366f1"/>
              </marker>
              <marker id="arrG3" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#22c55e"/>
              </marker>
              <marker id="arrA3" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#f59e0b"/>
              </marker>
            </defs>

            <!-- Users -->
            <g transform="translate(50,50)">
              <circle cx="25" cy="18" r="16" fill="#6366f1" opacity="0.8"/>
              <text x="25" y="23" text-anchor="middle" fill="#fff" font-size="12">👤</text>
            </g>
            <g transform="translate(50,95)">
              <circle cx="25" cy="18" r="16" fill="#6366f1" opacity="0.8"/>
              <text x="25" y="23" text-anchor="middle" fill="#fff" font-size="12">👤</text>
            </g>
            <g transform="translate(50,140)">
              <circle cx="25" cy="18" r="16" fill="#6366f1" opacity="0.8"/>
              <text x="25" y="23" text-anchor="middle" fill="#fff" font-size="12">👤</text>
            </g>
            <text x="75" y="190" text-anchor="middle" fill="#a5b4fc" font-size="11">百萬用戶</text>

            <!-- Layer 3: Device Cache -->
            <g transform="translate(145,45)" filter="url(#glowGreenLayer)">
              <rect width="150" height="150" rx="14" fill="url(#gradDevice)" stroke="#22c55e" stroke-width="2" filter="url(#sh3)"/>
              <text x="75" y="24" text-anchor="middle" fill="#22c55e" font-size="12" font-weight="700">📱 裝置 Cache</text>
              <text x="75" y="42" text-anchor="middle" fill="#9ca3af" font-size="9">（第三層）</text>
              <text x="75" y="65" text-anchor="middle" fill="#c0c4cc" font-size="9.5">睇過嘅嘢存喺手機</text>
              <text x="75" y="80" text-anchor="middle" fill="#c0c4cc" font-size="9.5">想翻睇？直接攞！</text>
              <text x="75" y="100" text-anchor="middle" fill="#4ade80" font-size="10" font-weight="600">攔截：~30% 請求</text>
              <rect x="20" y="112" width="110" height="24" rx="6" fill="rgba(34,197,94,0.12)"/>
              <text x="75" y="129" text-anchor="middle" fill="#4ade80" font-size="9">例：翻睇啱啱睇過嘅片</text>
            </g>

            <!-- Arrow -->
            <path d="M 97 120 Q 120 118 143 120" fill="none" stroke="#22c55e" stroke-width="2" marker-end="url(#arrG3)"/>

            <!-- Layer 2: CDN -->
            <g transform="translate(340,45)" filter="url(#glowAmberLayer)">
              <rect width="150" height="150" rx="14" fill="url(#gradCDN)" stroke="#f59e0b" stroke-width="2" filter="url(#sh3)"/>
              <text x="75" y="24" text-anchor="middle" fill="#fbbf24" font-size="12" font-weight="700">🌐 CDN 邊緣快取</text>
              <text x="75" y="42" text-anchor="middle" fill="#9ca3af" font-size="9">（第二層）</text>
              <text x="75" y="65" text-anchor="middle" fill="#c0c4cc" font-size="9.5">全球分布嘅伺服器</text>
              <text x="75" y="80" text-anchor="middle" fill="#c0c4cc" font-size="9.5">熱門內容就近回覆</text>
              <text x="75" y="100" text-anchor="middle" fill="#fbbf24" font-size="10" font-weight="600">攔截：~50% 請求</text>
              <rect x="20" y="112" width="110" height="24" rx="6" fill="rgba(245,158,11,0.12)"/>
              <text x="75" y="129" text-anchor="middle" fill="#fbbf24" font-size="9">例：爆紅影片、熱門內容</text>
            </g>

            <!-- Arrow -->
            <text x="320" y="115" text-anchor="middle" fill="#9ca3af" font-size="9">冇 hit →</text>
            <path d="M 297 120 Q 318 118 338 120" fill="none" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrA3)"/>

            <!-- Layer 1: Server Cache -->
            <g transform="translate(535,45)" filter="url(#glowIndigoLayer)">
              <rect width="150" height="150" rx="14" fill="url(#gradServer)" stroke="#6366f1" stroke-width="2" filter="url(#sh3)"/>
              <text x="75" y="24" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="700">⚡ 伺服器 Cache</text>
              <text x="75" y="42" text-anchor="middle" fill="#9ca3af" font-size="9">（第一層）</text>
              <text x="75" y="65" text-anchor="middle" fill="#c0c4cc" font-size="9.5">放喺 Server 同 DB 之間</text>
              <text x="75" y="80" text-anchor="middle" fill="#c0c4cc" font-size="9.5">常見查詢直接回覆</text>
              <text x="75" y="100" text-anchor="middle" fill="#a5b4fc" font-size="10" font-weight="600">攔截：~15% 請求</text>
              <rect x="20" y="112" width="110" height="24" rx="6" fill="rgba(99,102,241,0.12)"/>
              <text x="75" y="129" text-anchor="middle" fill="#a5b4fc" font-size="9">例：Redis / Memcached</text>
            </g>

            <!-- Arrow -->
            <text x="515" y="115" text-anchor="middle" fill="#9ca3af" font-size="9">冇 hit →</text>
            <path d="M 492 120 Q 513 118 533 120" fill="none" stroke="#6366f1" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrB3)"/>

            <!-- Database -->
            <g transform="translate(535,240)">
              <rect width="150" height="70" rx="14" fill="url(#gradDBs)" stroke="#34d399" stroke-width="2" filter="url(#sh3)"/>
              <text x="75" y="28" text-anchor="middle" fill="#34d399" font-size="13" font-weight="700">🗄 資料庫</text>
              <text x="75" y="48" text-anchor="middle" fill="#9ca3af" font-size="10">只處理 ~5% 嘅請求</text>
              <text x="75" y="62" text-anchor="middle" fill="#4ade80" font-size="9" font-weight="600">壓力大減！✓</text>
            </g>
            <line x1="610" y1="197" x2="610" y2="238" stroke="#34d399" stroke-width="1.5" stroke-dasharray="5,3"/>
            <text x="640" y="222" fill="#9ca3af" font-size="9">冇 hit ↓</text>

            <!-- Summary bar -->
            <g transform="translate(80,350)">
              <rect width="640" height="80" rx="14" fill="rgba(34,197,94,0.06)" stroke="#22c55e" stroke-width="1.5"/>
              <text x="320" y="25" text-anchor="middle" fill="#4ade80" font-size="13" font-weight="700">💡 三層 Cache 嘅效果</text>
              <text x="320" y="48" text-anchor="middle" fill="#c0c4cc" font-size="11">裝置 Cache 攔截重複請求 → CDN 攔截熱門內容 → 伺服器 Cache 攔截常見查詢</text>
              <text x="320" y="68" text-anchor="middle" fill="#4ade80" font-size="11" font-weight="600">最終只有好少嘅請求真正去到資料庫</text>
            </g>

            <!-- Percentage bar -->
            <g transform="translate(80,455)">
              <!-- Full bar background -->
              <rect width="640" height="30" rx="6" fill="#1e293b"/>
              <!-- Device -->
              <rect width="192" height="30" rx="6" fill="rgba(34,197,94,0.3)"/>
              <text x="96" y="20" text-anchor="middle" fill="#4ade80" font-size="10" font-weight="600">📱 30%</text>
              <!-- CDN -->
              <rect x="192" width="320" height="30" fill="rgba(245,158,11,0.3)"/>
              <text x="352" y="20" text-anchor="middle" fill="#fbbf24" font-size="10" font-weight="600">🌐 50%</text>
              <!-- Server cache -->
              <rect x="512" width="96" height="30" fill="rgba(99,102,241,0.3)"/>
              <text x="560" y="20" text-anchor="middle" fill="#a5b4fc" font-size="10" font-weight="600">⚡ 15%</text>
              <!-- DB -->
              <rect x="608" width="32" height="30" rx="0 6 6 0" fill="rgba(52,211,153,0.3)"/>
              <text x="624" y="20" text-anchor="middle" fill="#4ade80" font-size="8" font-weight="600">5%</text>
            </g>
            <text x="400" y="505" text-anchor="middle" fill="#9ca3af" font-size="10">← 越左邊越近用戶，越多請求被攔截 →</text>
          </svg>
        </div>

        <h3>三層 Cache 分別點用</h3>
        <ol class="steps">
          <li>
            <span class="step-num">1</span>
            <span><strong>伺服器 Cache（Redis / Memcached）</strong>——放喺 Server 同資料庫之間。好常見嘅查詢（例如攞一條爆紅影片嘅資料）唔使每次都打去資料庫。建議由呢層開始實作。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span><strong>CDN 邊緣快取</strong>——全球各地都有伺服器。用戶喺東京？就從東京嘅 CDN 攞內容，唔使飛去美國嘅主伺服器。重點係，熱門內容根本唔使去到 origin server。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span><strong>裝置 Cache</strong>——用戶啱啱睇完一條片，想翻睇？直接喺手機攞，完全唔使發任何請求。呢個係最快嘅一層，因為根本唔使經網絡。</span>
          </li>
        </ol>

        <div class="highlight-box">
          <h4>💡 點解要三層</h4>
          <p>每一層 Cache 擋住唔同類型嘅請求。裝置擋住重複嘅、CDN 擋住熱門嘅、伺服器 Cache 擋住常見嘅。三層加埋，資料庫只需要處理好少嘅請求。關鍵在於呢個「層層防禦」嘅概念。</p>
        </div>
      </div>
    </div>

    <!-- ===================== TAB 4: Read Replicas ===================== -->
    <div class="tab-content" id="replicas">
      <div class="card">
        <h2>Read Replicas — 讀取副本</h2>
        <div class="subtitle">當 Cache 都唔夠用，開多幾個資料庫一齊分擔</div>
        <p>
          用個比喻嚟理解。餐廳得一個廚房（資料庫），就算前台做咗好多分流，廚房仲係忙到頂唔住。解決方法？開多幾個廚房（Read Replicas），每個廚房都有同一份餐牌同食材，可以同時服務唔同嘅客人。重點係：只有一個「主廚房」負責更新食譜，其他都係跟住同步。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 440" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="sh4" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowAmberPrimary">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#f59e0b" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradLB" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#252040"/>
              </linearGradient>
              <linearGradient id="gradPrimary" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a2520"/>
              </linearGradient>
              <linearGradient id="gradReplica" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1e2e25"/>
              </linearGradient>
              <marker id="arrB4" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#6366f1"/>
              </marker>
              <marker id="arrG4" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#22c55e"/>
              </marker>
              <marker id="arrA4" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#f59e0b"/>
              </marker>
            </defs>

            <!-- Users -->
            <g transform="translate(40,160)">
              <circle cx="25" cy="18" r="16" fill="#6366f1" opacity="0.8"/>
              <text x="25" y="23" text-anchor="middle" fill="#fff" font-size="12">👤</text>
              <text x="25" y="50" text-anchor="middle" fill="#a5b4fc" font-size="10">百萬用戶</text>
            </g>

            <!-- Server / Load Balancer -->
            <g transform="translate(150,130)">
              <rect width="140" height="80" rx="14" fill="url(#gradLB)" stroke="#6366f1" stroke-width="2" filter="url(#sh4)"/>
              <text x="70" y="28" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="700">🔀 Server</text>
              <text x="70" y="45" text-anchor="middle" fill="#9ca3af" font-size="9">（負載均衡器）</text>
              <text x="70" y="65" text-anchor="middle" fill="#9ca3af" font-size="9">分配讀取請求</text>
            </g>
            <path d="M 87 178 Q 118 175 148 172" fill="none" stroke="#6366f1" stroke-width="2" marker-end="url(#arrB4)"/>

            <!-- Primary DB -->
            <g transform="translate(400,20)" filter="url(#glowAmberPrimary)">
              <rect width="170" height="80" rx="14" fill="url(#gradPrimary)" stroke="#f59e0b" stroke-width="2" filter="url(#sh4)"/>
              <text x="85" y="25" text-anchor="middle" fill="#fbbf24" font-size="12" font-weight="700">🗄 主資料庫</text>
              <text x="85" y="43" text-anchor="middle" fill="#9ca3af" font-size="9">（Primary / Master）</text>
              <text x="85" y="62" text-anchor="middle" fill="#fbbf24" font-size="9.5">負責所有寫入操作</text>
            </g>

            <!-- Replica 1 -->
            <g transform="translate(400,135)">
              <rect width="170" height="70" rx="14" fill="url(#gradReplica)" stroke="#22c55e" stroke-width="2" filter="url(#sh4)"/>
              <text x="85" y="22" text-anchor="middle" fill="#4ade80" font-size="11" font-weight="700">📗 讀取副本 1</text>
              <text x="85" y="40" text-anchor="middle" fill="#9ca3af" font-size="9">（Read Replica）</text>
              <text x="85" y="56" text-anchor="middle" fill="#4ade80" font-size="9">處理讀取請求 ✓</text>
            </g>

            <!-- Replica 2 -->
            <g transform="translate(400,230)">
              <rect width="170" height="70" rx="14" fill="url(#gradReplica)" stroke="#22c55e" stroke-width="2" filter="url(#sh4)"/>
              <text x="85" y="22" text-anchor="middle" fill="#4ade80" font-size="11" font-weight="700">📗 讀取副本 2</text>
              <text x="85" y="40" text-anchor="middle" fill="#9ca3af" font-size="9">（Read Replica）</text>
              <text x="85" y="56" text-anchor="middle" fill="#4ade80" font-size="9">處理讀取請求 ✓</text>
            </g>

            <!-- Replica 3 -->
            <g transform="translate(400,325)">
              <rect width="170" height="70" rx="14" fill="url(#gradReplica)" stroke="#22c55e" stroke-width="2" filter="url(#sh4)"/>
              <text x="85" y="22" text-anchor="middle" fill="#4ade80" font-size="11" font-weight="700">📗 讀取副本 3</text>
              <text x="85" y="40" text-anchor="middle" fill="#9ca3af" font-size="9">（Read Replica）</text>
              <text x="85" y="56" text-anchor="middle" fill="#4ade80" font-size="9">處理讀取請求 ✓</text>
            </g>

            <!-- Arrows: Server -> Replicas (reads) — curved -->
            <path d="M 292 155 Q 345 148 398 165" fill="none" stroke="#22c55e" stroke-width="2" marker-end="url(#arrG4)"/>
            <path d="M 292 175 Q 345 220 398 260" fill="none" stroke="#22c55e" stroke-width="2" marker-end="url(#arrG4)"/>
            <path d="M 292 185 Q 345 290 398 355" fill="none" stroke="#22c55e" stroke-width="2" marker-end="url(#arrG4)"/>

            <!-- Read labels -->
            <text x="338" y="148" text-anchor="middle" fill="#4ade80" font-size="9" font-weight="500">讀取</text>
            <text x="330" y="220" text-anchor="middle" fill="#4ade80" font-size="9" font-weight="500">讀取</text>
            <text x="320" y="290" text-anchor="middle" fill="#4ade80" font-size="9" font-weight="500">讀取</text>

            <!-- Sync arrows: Primary -> Replicas -->
            <line x1="530" y1="102" x2="530" y2="133" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrA4)"/>
            <line x1="572" y1="102" x2="572" y2="228" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrA4)"/>
            <line x1="555" y1="102" x2="555" y2="323" stroke="#f59e0b" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrA4)"/>

            <!-- Sync label -->
            <g transform="translate(620,155)">
              <rect width="130" height="48" rx="10" fill="rgba(245,158,11,0.08)" stroke="#f59e0b" stroke-width="1" stroke-dasharray="4,3"/>
              <text x="65" y="18" text-anchor="middle" fill="#fbbf24" font-size="10" font-weight="600">🔄 自動同步</text>
              <text x="65" y="34" text-anchor="middle" fill="#9ca3af" font-size="9">主 DB 嘅資料</text>
              <text x="65" y="46" text-anchor="middle" fill="#9ca3af" font-size="9">會複製到每個副本</text>
            </g>

            <!-- Write arrow (small) -->
            <g transform="translate(620,60)">
              <rect width="130" height="30" rx="10" fill="rgba(248,113,113,0.08)" stroke="#f87171" stroke-width="1" stroke-dasharray="4,3"/>
              <text x="65" y="20" text-anchor="middle" fill="#f87171" font-size="9">✎ 寫入只去主 DB</text>
            </g>
          </svg>
        </div>

        <h3>運作原理</h3>
        <ol class="steps">
          <li>
            <span class="step-num">1</span>
            <span><strong>主資料庫（Primary）</strong>負責所有寫入操作——改資料、加資料、刪資料全部喺佢度做。重點係，寫入永遠只去一個地方。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span><strong>讀取副本（Read Replicas）</strong>係主資料庫嘅複製品。佢哋有同一份資料，但只負責讀取。可以理解為「只讀嘅影印本」。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span><strong>Server 做負載均衡</strong>——將用戶嘅讀取請求分配俾唔同嘅副本，每個副本都分擔一部分壓力。建議用 round-robin 或者 least-connections 策略。</span>
          </li>
          <li>
            <span class="step-num">4</span>
            <span><strong>主 DB 自動同步</strong>——每次主 DB 有新嘅資料，就會自動複製去所有副本。要注意，呢個同步有短暫延遲。</span>
          </li>
        </ol>

        <div class="pros-cons">
          <div class="pros">
            <h4>👍 好處</h4>
            <ul>
              <li>讀取能力可以線性擴展——加多個副本就多一份力</li>
              <li>就算 Cache 幫唔到（例如大量獨特查詢），都有效</li>
              <li>副本掛咗都唔影響主 DB，系統更加穩定</li>
            </ul>
          </div>
          <div class="cons">
            <h4>👎 壞處</h4>
            <ul>
              <li>同步會有短暫延遲——副本嘅資料可能慢幾毫秒</li>
              <li>只解決讀取問題，寫入仲係去主 DB</li>
              <li>管理多個資料庫比較複雜</li>
            </ul>
          </div>
        </div>

        <div class="highlight-box">
          <h4>💡 適用場景</h4>
          <p>當大部分請求都係獨特嘅資料（唔重複），Cache 幫唔到太多嘅時候。例如：每個用戶查自己嘅訂單、個人化推薦結果等。呢啲查詢冇辦法用 Cache 攔截，所以要靠多個 DB 副本一齊頂住。要記住，呢個係最後嘅大招，唔好太早用。</p>
        </div>
      </div>
    </div>

    <div class="tab-content" id="ai-viber">
      <div class="card">
        <h2>AI Viber</h2>
        <div class="subtitle">複製 Prompt，貼去 AI 工具，即刻開始 Build</div>

        <div class="prompt-card">
          <h4>Prompt 1 — 設計讀取擴展策略</h4>
          <div class="prompt-text" id="prompt1">幫手設計一個完整嘅讀取擴展策略，應對 App 突然爆紅嘅場景。

項目背景：
- 應用類型：<span class="placeholder">[例如：社交平台 / 影片串流 / 電商]</span>
- 目前用戶量：<span class="placeholder">[例如：1 萬]</span>，目標：<span class="placeholder">[例如：100 萬]</span>
- 資料庫：<span class="placeholder">[例如：PostgreSQL / MySQL]</span>
- 讀寫比例：<span class="placeholder">[例如：讀 90% / 寫 10%]</span>
- 目前瓶頸：<span class="placeholder">[例如：資料庫 CPU 長期 >80%，查詢延遲 >500ms]</span>

請按以下四個層級逐步設計：

第一步：優化查詢 + 加 Index
- 分析常見嘅慢查詢模式
- 建議加邊啲 Index
- 用 EXPLAIN 驗證效果

第二步：加 Cache（三層快取）
- 伺服器 Cache（Redis）：Cache 咩數據、TTL 策略、Invalidation 方案
- CDN Cache：靜態資源同 API Response Cache 設定
- 客戶端 Cache：HTTP Cache Header 策略

第三步：Read Replicas
- 幾多個副本、負載均衡策略
- 處理 Replication Lag 嘅方案

第四步：進階方案（如果需要）
- CQRS Pattern 考量
- 資料庫 Sharding 策略

每一步都要標明「幾時應該用」同「預期效果」。</div>
          <button class="copy-btn" onclick="copyPrompt('prompt1', this)">📋 複製</button>
        </div>

        <div class="prompt-card">
          <h4>Prompt 2 — 實現 Read Replica 架構</h4>
          <div class="prompt-text" id="prompt2">幫手實現一個 Read Replica 架構，包含完整嘅配置同 Application 層設計。

技術棧：
- 資料庫：<span class="placeholder">[例如：PostgreSQL / MySQL]</span>
- 雲平台：<span class="placeholder">[例如：AWS RDS / GCP Cloud SQL / 自建]</span>
- 應用層語言：<span class="placeholder">[例如：Node.js / Python / Go]</span>

架構要求：
1. 一個 Primary DB（負責所有寫入）
2. <span class="placeholder">[2-3]</span> 個 Read Replica（負責讀取）
3. Application 層嘅讀寫分離邏輯：
   - 所有 SELECT 查詢自動路由到 Replica
   - 所有 INSERT / UPDATE / DELETE 路由到 Primary
   - 寫入後嘅即時讀取要路由到 Primary（避免 Replication Lag 問題）

需要提供：
- 資料庫 Replication 配置步驟
- Application 層嘅 Connection Pool 設計
- 讀寫分離嘅 Middleware / Proxy 實現
- Replication Lag 監控同 Alert 設定
- Failover 策略：Replica 掛咗點處理

請提供完整嘅配置檔案同 code 範例。</div>
          <button class="copy-btn" onclick="copyPrompt('prompt2', this)">📋 複製</button>
        </div>
      </div>
    </div>

    <div class="related-topics">
      <div class="card">
        <h3>相關課題</h3>
        <div class="related-links">
        <a href="database-basics.html" class="related-link">Database 基礎</a>
        <a href="distributed-cache.html" class="related-link">Distributed Cache 分佈式快取</a>
        <a href="cache-invalidation.html" class="related-link">Cache 失效策略</a>
        <a href="load-balancer.html" class="related-link">Load Balancer 負載均衡器</a>
        </div>
      </div>
    </div>
  </div>

  <script src="../premium-gate.js"></script>
  <script>
    const tabs = document.querySelectorAll('.tab-btn');
    const contents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));

        tab.classList.add('active');
        const target = document.getElementById(tab.dataset.tab);
        if (target) target.classList.add('active');
      });
    });

    function copyPrompt(id, btn) {
      const text = document.getElementById(id).innerText;
      navigator.clipboard.writeText(text).then(() => {
        btn.textContent = '✅ 已複製';
        btn.classList.add('copied');
        setTimeout(() => { btn.textContent = '📋 複製'; btn.classList.remove('copied'); }, 2000);
      });
    }
  </script>
</body>
</html>
