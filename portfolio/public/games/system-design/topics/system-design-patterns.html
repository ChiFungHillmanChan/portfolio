<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>系統設計模式總覽</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang HK", "Microsoft JhengHei", sans-serif; background: #0f1117; color: #e0e0e0; min-height: 100vh; }
    .container { max-width: 960px; margin: 0 auto; padding: 40px 24px; }
    header { text-align: center; margin-bottom: 40px; }
    header h1 { font-size: 2rem; font-weight: 700; color: #ffffff; margin-bottom: 8px; }
    header p { font-size: 1rem; color: #9ca3af; line-height: 1.6; }
    .card { background: #1a1d27; border-radius: 16px; padding: 32px; margin-bottom: 24px; border: 1px solid #2a2d3a; }
    .card h2 { font-size: 1.5rem; color: #ffffff; margin-bottom: 8px; }
    .card .subtitle { font-size: 0.95rem; color: #6366f1; font-weight: 500; margin-bottom: 16px; }
    .card p { font-size: 0.95rem; color: #c0c4cc; line-height: 1.8; margin-bottom: 12px; }
    .diagram-container { background: #13151c; border-radius: 12px; padding: 24px; margin: 24px 0; overflow-x: auto; border: 1px solid #2a2d3a; }
    .diagram-container svg { display: block; margin: 0 auto; max-width: 100%; height: auto; }
    .steps { list-style: none; padding: 0; margin: 16px 0; }
    .steps li { display: flex; align-items: flex-start; gap: 12px; padding: 12px 0; border-bottom: 1px solid #2a2d3a; font-size: 0.95rem; color: #c0c4cc; line-height: 1.6; }
    .steps li:last-child { border-bottom: none; }
    .step-num { flex-shrink: 0; width: 28px; height: 28px; border-radius: 50%; background: #6366f1; color: #fff; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: 700; }
    .key-points { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px; }
    @media (max-width: 600px) { .key-points { grid-template-columns: 1fr; } .container { padding: 24px 16px; } header h1 { font-size: 1.5rem; } .card { padding: 20px; } }
    .key-point { background: #13151c; border-radius: 10px; padding: 16px; border-left: 3px solid #6366f1; }
    .key-point h4 { color: #a5b4fc; font-size: 0.9rem; margin-bottom: 6px; }
    .key-point p { font-size: 0.85rem; color: #c0c4cc; margin-bottom: 0; line-height: 1.6; }
    .use-case { background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05)); border-left: 3px solid #6366f1; border-radius: 0 10px 10px 0; padding: 16px 20px; margin-top: 16px; }
    .use-case h4 { color: #a5b4fc; font-size: 0.9rem; margin-bottom: 6px; }
    .use-case p { font-size: 0.9rem; color: #c0c4cc; margin-bottom: 0; }
    .tabs { display: flex; gap: 4px; background: #1a1d27; border-radius: 12px; padding: 4px; margin-bottom: 24px; overflow-x: auto; }
    .tab-btn { flex: 1; padding: 12px 16px; border: none; background: transparent; color: #9ca3af; font-size: 0.9rem; font-weight: 500; border-radius: 8px; cursor: pointer; transition: all 0.25s ease; white-space: nowrap; font-family: inherit; }
    .tab-btn:hover { color: #e0e0e0; background: rgba(255, 255, 255, 0.05); }
    .tab-btn.active { background: #6366f1; color: #ffffff; font-weight: 600; }
    .tab-content { display: none; animation: fadeIn 0.3s ease; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>系統設計模式總覽</h1>
      <p>大多數系統都遵循相同嘅模式 — 掌握呢啲核心模式，就可以應對絕大部分嘅系統設計挑戰</p>
    </header>

    <div class="tabs">
      <button class="tab-btn active" data-tab="tab-scale">擴展模式</button>
      <button class="tab-btn" data-tab="tab-realtime">實時與異步</button>
      <button class="tab-btn" data-tab="tab-reliability">可靠性模式</button>
    </div>

    <!-- ============ TAB 1: 擴展模式 ============ -->
    <div id="tab-scale" class="tab-content active">

      <div class="card">
        <h2>Scale Reads — 擴展讀取</h2>
        <div class="subtitle">Caching / Read Replicas / Database Indexing</div>
        <p>當系統嘅讀取流量遠大於寫入流量時，擴展讀取能力係首要任務。核心策略有三個：</p>
        <ul class="steps">
          <li>
            <span class="step-num">1</span>
            <span><strong>Caching</strong> — 將頻繁讀取嘅數據暫存喺高速存儲層（如 Redis / Memcached），避免每次都查詢數據庫。重點係設計合理嘅 Cache Invalidation 策略。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span><strong>Read Replicas</strong> — 建立數據庫嘅只讀副本，將讀取請求分散到多個副本上。主庫負責寫入，副本負責讀取，有效分擔讀取壓力。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span><strong>Database Indexing</strong> — 為常用查詢字段建立索引，大幅減少數據庫掃描嘅數據量。關鍵在於揀選正確嘅字段同避免過度索引。</span>
          </li>
        </ul>
      </div>

      <div class="card">
        <h2>Scale Writes — 擴展寫入</h2>
        <div class="subtitle">Sharding / Batching / Asynchronous Writes</div>
        <p>當寫入流量成為瓶頸時，需要透過分散同延遲寫入嚟提升吞吐量：</p>
        <ul class="steps">
          <li>
            <span class="step-num">1</span>
            <span><strong>Sharding</strong> — 將數據按照特定規則（如 User ID）分佈到多個數據庫分片上，每個分片只處理一部分數據，從而水平擴展寫入能力。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span><strong>Batching</strong> — 將多個小寫入合併成一個大批量寫入操作，減少數據庫交互次數，顯著提升寫入效率。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span><strong>Asynchronous Writes</strong> — 寫入請求先放入隊列，由後台 Worker 異步處理。前端即時回應用戶，實際寫入延遲完成。</span>
          </li>
        </ul>
      </div>

      <div class="card">
        <h2>CQRS — 讀寫分離</h2>
        <div class="subtitle">Command Query Responsibility Segregation</div>
        <p>CQRS 嘅核心概念係將讀取（Query）同寫入（Command）嘅數據模型完全分開。寫入端用針對寫入優化嘅模型，讀取端用針對查詢優化嘅模型，各司其職。</p>
        <p>呢個模式特別適用於讀寫比例差異極大、或者讀寫有唔同性能需求嘅系統。重點係保持兩個模型之間嘅數據最終一致性（Eventual Consistency）。</p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 380" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="readGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#34d399" stop-opacity="0.25" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <linearGradient id="writeGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#f59e0b" stop-opacity="0.25" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <linearGradient id="cqrsGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#6366f1" stop-opacity="0.4" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <linearGradient id="clientGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#a5b4fc" stop-opacity="0.3" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <filter id="glowCqrs">
                <feGaussianBlur stdDeviation="6" result="blur" />
                <feMerge>
                  <feMergeNode in="blur" />
                  <feMergeNode in="SourceGraphic" />
                </feMerge>
              </filter>
              <filter id="shadow">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4" />
              </filter>
              <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#34d399" />
              </marker>
              <marker id="arrowAmber" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b" />
              </marker>
              <marker id="arrowIndigo" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1" />
              </marker>
            </defs>

            <!-- Client -->
            <rect x="320" y="20" width="160" height="50" rx="14" fill="url(#clientGrad)" stroke="#a5b4fc" stroke-width="1.5" filter="url(#shadow)" />
            <text x="400" y="50" text-anchor="middle" fill="#e0e0e0" font-size="14" font-weight="600">Client</text>

            <!-- CQRS Center Node (with glow) -->
            <rect x="325" y="120" width="150" height="55" rx="14" fill="url(#cqrsGrad)" stroke="#6366f1" stroke-width="2" filter="url(#glowCqrs)" />
            <text x="400" y="148" text-anchor="middle" fill="#a5b4fc" font-size="15" font-weight="700">CQRS</text>
            <text x="400" y="165" text-anchor="middle" fill="#9ca3af" font-size="10">Command / Query Split</text>

            <!-- Arrow: Client → CQRS -->
            <path d="M400,70 C400,85 400,105 400,118" stroke="#a5b4fc" stroke-width="1.5" fill="none" marker-end="url(#arrowIndigo)" />

            <!-- READ side (left) -->
            <rect x="50" y="230" width="160" height="50" rx="14" fill="url(#readGrad)" stroke="#34d399" stroke-width="1.5" filter="url(#shadow)" />
            <text x="130" y="258" text-anchor="middle" fill="#34d399" font-size="13" font-weight="600">Read Model</text>

            <rect x="50" y="310" width="70" height="40" rx="14" fill="url(#readGrad)" stroke="#34d399" stroke-width="1" filter="url(#shadow)" />
            <text x="85" y="334" text-anchor="middle" fill="#c0c4cc" font-size="10">Cache</text>

            <rect x="140" y="310" width="70" height="40" rx="14" fill="url(#readGrad)" stroke="#34d399" stroke-width="1" filter="url(#shadow)" />
            <text x="175" y="334" text-anchor="middle" fill="#c0c4cc" font-size="10">Replicas</text>

            <!-- Arrow: CQRS → Read Model -->
            <path d="M325,155 C250,160 180,200 130,228" stroke="#34d399" stroke-width="1.5" fill="none" marker-end="url(#arrowGreen)" />

            <!-- Arrow: Read Model → Cache -->
            <path d="M100,280 C95,290 90,300 87,308" stroke="#34d399" stroke-width="1" fill="none" marker-end="url(#arrowGreen)" />

            <!-- Arrow: Read Model → Replicas -->
            <path d="M160,280 C165,290 170,300 173,308" stroke="#34d399" stroke-width="1" fill="none" marker-end="url(#arrowGreen)" />

            <!-- WRITE side (right) -->
            <rect x="590" y="230" width="160" height="50" rx="14" fill="url(#writeGrad)" stroke="#f59e0b" stroke-width="1.5" filter="url(#shadow)" />
            <text x="670" y="258" text-anchor="middle" fill="#f59e0b" font-size="13" font-weight="600">Write Model</text>

            <rect x="590" y="310" width="70" height="40" rx="14" fill="url(#writeGrad)" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)" />
            <text x="625" y="334" text-anchor="middle" fill="#c0c4cc" font-size="10">Sharding</text>

            <rect x="680" y="310" width="70" height="40" rx="14" fill="url(#writeGrad)" stroke="#f59e0b" stroke-width="1" filter="url(#shadow)" />
            <text x="715" y="334" text-anchor="middle" fill="#c0c4cc" font-size="10">Batching</text>

            <!-- Arrow: CQRS → Write Model -->
            <path d="M475,155 C550,160 620,200 670,228" stroke="#f59e0b" stroke-width="1.5" fill="none" marker-end="url(#arrowAmber)" />

            <!-- Arrow: Write Model → Sharding -->
            <path d="M640,280 C635,290 630,300 627,308" stroke="#f59e0b" stroke-width="1" fill="none" marker-end="url(#arrowAmber)" />

            <!-- Arrow: Write Model → Batching -->
            <path d="M700,280 C705,290 710,300 713,308" stroke="#f59e0b" stroke-width="1" fill="none" marker-end="url(#arrowAmber)" />

            <!-- Sync arrow between Read and Write -->
            <path d="M215,255 C300,240 500,240 588,255" stroke="#6366f1" stroke-width="1" stroke-dasharray="6,4" fill="none" marker-end="url(#arrowIndigo)" />
            <text x="400" y="237" text-anchor="middle" fill="#9ca3af" font-size="10">Eventual Consistency</text>

            <!-- Labels -->
            <text x="130" y="220" text-anchor="middle" fill="#34d399" font-size="11" font-weight="500">Query Side</text>
            <text x="670" y="220" text-anchor="middle" fill="#f59e0b" font-size="11" font-weight="500">Command Side</text>
          </svg>
        </div>

        <div class="use-case">
          <h4>適用場景</h4>
          <p>電商平台（大量商品瀏覽 vs 少量下單寫入）、社交媒體（大量 Feed 讀取 vs 少量發帖寫入）、分析報表系統（複雜查詢 vs 原始數據寫入）。</p>
        </div>
      </div>
    </div>

    <!-- ============ TAB 2: 實時與異步 ============ -->
    <div id="tab-realtime" class="tab-content">

      <div class="card">
        <h2>Real-time Data — 實時數據傳輸</h2>
        <div class="subtitle">WebSockets / Server-Sent Events / Long Polling</div>
        <p>當應用需要即時推送數據畀客戶端時，有三種主流模式可以揀選。每種模式各有優劣，關鍵在於根據具體場景做出取捨：</p>

        <div class="key-points">
          <div class="key-point">
            <h4>WebSockets</h4>
            <p>建立全雙工持久連接，客戶端同服務端可以隨時互相發送數據。適合需要雙向實時通訊嘅場景，例如聊天室、多人遊戲、協作編輯。</p>
          </div>
          <div class="key-point">
            <h4>Server-Sent Events (SSE)</h4>
            <p>服務端單向推送數據畀客戶端嘅輕量級方案。基於 HTTP，自動重連，適合通知推送、實時股價更新等只需要服務端推送嘅場景。</p>
          </div>
          <div class="key-point">
            <h4>Long Polling</h4>
            <p>客戶端發送請求後，服務端保持連接直到有新數據先回應。兼容性最好但效率最低，適合唔支持 WebSocket 嘅環境作為後備方案。</p>
          </div>
          <div class="key-point">
            <h4>點樣揀選？</h4>
            <p>雙向通訊用 WebSocket；單向推送用 SSE；兼容性優先用 Long Polling。大部分現代應用推薦 WebSocket 配合 SSE 作為降級方案。</p>
          </div>
        </div>
      </div>

      <div class="card">
        <h2>Long-running Processes — 長時間運行嘅流程</h2>
        <div class="subtitle">Message Queues / Worker Pools / Workflow Engines</div>
        <p>好多業務操作唔係即時完成嘅 — 可能需要幾秒、幾分鐘甚至幾個鐘。處理呢類長時間運行嘅流程，核心概念係將任務從主請求流程中分離出嚟：</p>

        <div class="key-points">
          <div class="key-point">
            <h4>Message Queues</h4>
            <p>將任務放入隊列（如 RabbitMQ、Kafka），由消費者異步處理。解耦生產者同消費者，提供緩衝能力同重試機制。</p>
          </div>
          <div class="key-point">
            <h4>Worker Pools</h4>
            <p>維護一組 Worker 線程或進程，從隊列中取出任務並行處理。重點係控制併發數量，避免資源耗盡同保證任務公平分配。</p>
          </div>
          <div class="key-point">
            <h4>Workflow Engines</h4>
            <p>管理複雜嘅多步驟流程（如 Temporal、Airflow），支持狀態追蹤、錯誤恢復、條件分支。適合跨服務嘅長流程編排。</p>
          </div>
          <div class="key-point">
            <h4>常見組合模式</h4>
            <p>Message Queue + Worker Pool 係最常見嘅組合。對於更複雜嘅場景，再加上 Workflow Engine 做流程編排，形成完整嘅異步處理架構。</p>
          </div>
        </div>

        <div class="use-case">
          <h4>典型應用</h4>
          <p>視頻轉碼（上傳後排隊處理）、電郵批量發送（Worker Pool 並行發送）、訂單處理流程（Workflow Engine 編排支付 → 庫存 → 物流）。</p>
        </div>
      </div>
    </div>

    <!-- ============ TAB 3: 可靠性模式 ============ -->
    <div id="tab-reliability" class="tab-content">

      <div class="card">
        <h2>Failures &amp; Reliability — 故障與可靠性</h2>
        <div class="subtitle">Retries / Idempotency / Circuit Breakers / Self-healing</div>
        <p>分佈式系統入面，故障係必然會發生嘅。關鍵唔係避免故障，而係設計一套機制令系統喺故障發生時能夠優雅應對並自動恢復。</p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 260" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="reqGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#a5b4fc" stop-opacity="0.3" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <linearGradient id="retryGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#f59e0b" stop-opacity="0.3" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <linearGradient id="cbGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#f87171" stop-opacity="0.3" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <linearGradient id="healGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#6366f1" stop-opacity="0.3" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <linearGradient id="successGrad" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="#34d399" stop-opacity="0.35" />
                <stop offset="100%" stop-color="#1e293b" />
              </linearGradient>
              <filter id="shadowR">
                <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.4" />
              </filter>
              <filter id="glowSuccess">
                <feGaussianBlur stdDeviation="5" result="blur" />
                <feMerge>
                  <feMergeNode in="blur" />
                  <feMergeNode in="SourceGraphic" />
                </feMerge>
              </filter>
              <marker id="arwAmber" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b" />
              </marker>
              <marker id="arwRed" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#f87171" />
              </marker>
              <marker id="arwIndigo2" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1" />
              </marker>
              <marker id="arwGreen" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#34d399" />
              </marker>
            </defs>

            <!-- Request -->
            <rect x="20" y="90" width="120" height="55" rx="14" fill="url(#reqGrad)" stroke="#a5b4fc" stroke-width="1.5" filter="url(#shadowR)" />
            <text x="80" y="122" text-anchor="middle" fill="#e0e0e0" font-size="13" font-weight="600">Request</text>

            <!-- Retry with Backoff -->
            <rect x="190" y="90" width="140" height="55" rx="14" fill="url(#retryGrad)" stroke="#f59e0b" stroke-width="1.5" filter="url(#shadowR)" />
            <text x="260" y="114" text-anchor="middle" fill="#f59e0b" font-size="12" font-weight="600">Retry</text>
            <text x="260" y="132" text-anchor="middle" fill="#c0c4cc" font-size="10">with Backoff</text>

            <!-- Circuit Breaker -->
            <rect x="380" y="90" width="140" height="55" rx="14" fill="url(#cbGrad)" stroke="#f87171" stroke-width="1.5" filter="url(#shadowR)" />
            <text x="450" y="114" text-anchor="middle" fill="#f87171" font-size="12" font-weight="600">Circuit Breaker</text>
            <text x="450" y="132" text-anchor="middle" fill="#c0c4cc" font-size="10">Open / Half / Closed</text>

            <!-- Self-healing -->
            <rect x="570" y="90" width="120" height="55" rx="14" fill="url(#healGrad)" stroke="#6366f1" stroke-width="1.5" filter="url(#shadowR)" />
            <text x="630" y="122" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="600">Self-healing</text>

            <!-- Success -->
            <rect x="735" y="90" width="50" height="55" rx="14" fill="url(#successGrad)" stroke="#34d399" stroke-width="1.5" filter="url(#glowSuccess)" />
            <text x="760" y="122" text-anchor="middle" fill="#34d399" font-size="11" font-weight="700">OK</text>

            <!-- Arrows -->
            <path d="M140,117 C155,117 170,117 188,117" stroke="#f59e0b" stroke-width="1.5" fill="none" marker-end="url(#arwAmber)" />
            <path d="M330,117 C345,117 360,117 378,117" stroke="#f87171" stroke-width="1.5" fill="none" marker-end="url(#arwRed)" />
            <path d="M520,117 C535,117 550,117 568,117" stroke="#6366f1" stroke-width="1.5" fill="none" marker-end="url(#arwIndigo2)" />
            <path d="M690,117 C700,117 715,117 733,117" stroke="#34d399" stroke-width="1.5" fill="none" marker-end="url(#arwGreen)" />

            <!-- Retry loop arrow -->
            <path d="M260,90 C260,55 210,40 200,60 C192,75 220,88 240,90" stroke="#f59e0b" stroke-width="1" stroke-dasharray="4,3" fill="none" marker-end="url(#arwAmber)" />
            <text x="220" y="48" text-anchor="middle" fill="#9ca3af" font-size="9">Exponential Backoff</text>

            <!-- Labels below -->
            <text x="80" y="170" text-anchor="middle" fill="#9ca3af" font-size="10">發起請求</text>
            <text x="260" y="170" text-anchor="middle" fill="#9ca3af" font-size="10">失敗重試</text>
            <text x="450" y="170" text-anchor="middle" fill="#9ca3af" font-size="10">熔斷保護</text>
            <text x="630" y="170" text-anchor="middle" fill="#9ca3af" font-size="10">自動恢復</text>
            <text x="760" y="170" text-anchor="middle" fill="#9ca3af" font-size="10">成功</text>
          </svg>
        </div>

        <div class="key-points">
          <div class="key-point">
            <h4>Retry with Exponential Backoff</h4>
            <p>每次重試之間等待嘅時間指數遞增（例如 1s → 2s → 4s → 8s），避免對已經過載嘅服務造成更大壓力。通常加入 Jitter（隨機偏移）防止重試風暴。</p>
          </div>
          <div class="key-point">
            <h4>Idempotency（冪等性）</h4>
            <p>確保同一個操作執行多次同執行一次效果相同。常見做法係用 Idempotency Key，服務端記錄已處理嘅請求 ID，重複請求直接返回之前嘅結果。</p>
          </div>
          <div class="key-point">
            <h4>Circuit Breaker（熔斷器）</h4>
            <p>監控下游服務嘅失敗率，當失敗率超過閾值時「斷路」停止請求，避免連鎖故障。經過一段冷卻期後進入 Half-Open 狀態嘗試恢復。</p>
          </div>
          <div class="key-point">
            <h4>Self-healing（自我修復）</h4>
            <p>系統具備自動偵測異常同恢復嘅能力。常見手段包括：健康檢查（Health Check）、自動重啟失敗嘅服務實例、自動擴容應對流量突增。</p>
          </div>
        </div>

        <div class="use-case">
          <h4>實際應用場景</h4>
          <p>支付系統（Idempotency Key 防止重複扣款）、微服務架構（Circuit Breaker 防止雪崩效應）、Kubernetes（Self-healing 自動重啟 crashed pods）、API Gateway（Retry + Backoff 處理瞬時故障）。</p>
        </div>
      </div>
    </div>

  </div>

  <script>
    const tabs = document.querySelectorAll('.tab-btn');
    const contents = document.querySelectorAll('.tab-content');
    tabs.forEach(tab => { tab.addEventListener('click', () => { tabs.forEach(t => t.classList.remove('active')); contents.forEach(c => c.classList.remove('active')); tab.classList.add('active'); document.getElementById(tab.dataset.tab)?.classList.add('active'); }); });
  </script>
</body>
</html>
