<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cache 失效策略 — 系統架構圖解</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang HK", "Microsoft JhengHei", sans-serif;
      background: #0f1117;
      color: #e0e0e0;
      min-height: 100vh;
    }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 40px 24px;
    }

    header {
      text-align: center;
      margin-bottom: 40px;
    }

    header h1 {
      font-size: 2rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
    }

    header p {
      font-size: 1rem;
      color: #9ca3af;
      line-height: 1.6;
    }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 4px;
      background: #1a1d27;
      border-radius: 12px;
      padding: 4px;
      margin-bottom: 32px;
      overflow-x: auto;
    }

    .tab-btn {
      flex: 1;
      padding: 12px 16px;
      border: none;
      background: transparent;
      color: #9ca3af;
      font-size: 0.9rem;
      font-weight: 500;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.25s ease;
      white-space: nowrap;
      font-family: inherit;
    }

    .tab-btn:hover {
      color: #e0e0e0;
      background: rgba(255, 255, 255, 0.05);
    }

    .tab-btn.active {
      background: #6366f1;
      color: #ffffff;
      font-weight: 600;
    }

    /* Tab Content */
    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: #1a1d27;
      border-radius: 16px;
      padding: 32px;
      margin-bottom: 24px;
      border: 1px solid #2a2d3a;
    }

    .card h2 {
      font-size: 1.5rem;
      color: #ffffff;
      margin-bottom: 8px;
    }

    .card .subtitle {
      font-size: 0.95rem;
      color: #6366f1;
      font-weight: 500;
      margin-bottom: 16px;
    }

    .card p {
      font-size: 0.95rem;
      color: #c0c4cc;
      line-height: 1.8;
      margin-bottom: 12px;
    }

    /* Diagram Container */
    .diagram-container {
      background: #13151c;
      border-radius: 12px;
      padding: 24px;
      margin: 24px 0;
      overflow-x: auto;
      border: 1px solid #2a2d3a;
    }

    .diagram-container svg {
      display: block;
      margin: 0 auto;
      max-width: 100%;
      height: auto;
    }

    /* Step List */
    .steps {
      list-style: none;
      padding: 0;
      margin: 16px 0;
    }

    .steps li {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px solid #2a2d3a;
      font-size: 0.95rem;
      color: #c0c4cc;
      line-height: 1.6;
    }

    .steps li:last-child {
      border-bottom: none;
    }

    .step-num {
      flex-shrink: 0;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: #6366f1;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 700;
    }

    /* Pros and Cons */
    .pros-cons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-top: 16px;
    }

    @media (max-width: 600px) {
      .pros-cons {
        grid-template-columns: 1fr;
      }
    }

    .pros, .cons {
      background: #13151c;
      border-radius: 10px;
      padding: 16px;
    }

    .pros h4 {
      color: #34d399;
      font-size: 0.9rem;
      margin-bottom: 8px;
    }

    .cons h4 {
      color: #f87171;
      font-size: 0.9rem;
      margin-bottom: 8px;
    }

    .pros ul, .cons ul {
      list-style: none;
      padding: 0;
    }

    .pros li, .cons li {
      font-size: 0.85rem;
      color: #c0c4cc;
      padding: 4px 0;
      line-height: 1.5;
    }

    .pros li::before {
      content: "✓ ";
      color: #34d399;
      font-weight: 700;
    }

    .cons li::before {
      content: "✗ ";
      color: #f87171;
      font-weight: 700;
    }

    .use-case {
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05));
      border-left: 3px solid #6366f1;
      border-radius: 0 10px 10px 0;
      padding: 16px 20px;
      margin-top: 16px;
    }

    .use-case h4 {
      color: #a5b4fc;
      font-size: 0.9rem;
      margin-bottom: 6px;
    }

    .use-case p {
      font-size: 0.9rem;
      color: #c0c4cc;
      margin-bottom: 0;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .container {
        padding: 24px 16px;
      }

      header h1 {
        font-size: 1.5rem;
      }

      .tabs {
        flex-wrap: nowrap;
      }

      .tab-btn {
        font-size: 0.8rem;
        padding: 10px 12px;
      }

      .card {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Cache 失效策略</h1>
      <p>我帶你用最簡單嘅方式，搞清楚四種常見嘅 Cache（快取）更新策略</p>
    </header>

    <div class="tabs">
      <button class="tab-btn active" data-tab="ttl">① TTL 時間到期</button>
      <button class="tab-btn" data-tab="write-through">② Write Through 同步寫入</button>
      <button class="tab-btn" data-tab="write-around">③ Write Around 繞過快取</button>
      <button class="tab-btn" data-tab="write-back">④ Write Back 延遲寫入</button>
    </div>

    <!-- ===================== TAB 1: TTL ===================== -->
    <div class="tab-content active" id="ttl">
      <div class="card">
        <h2>TTL — Time to Live（時間到期）</h2>
        <div class="subtitle">最簡單嘅 Cache 失效方法：設個時限，到期就刪</div>
        <p>
          我用個簡單嘅例子同你講。你去餐廳叫外賣，啲嘢食放雪櫃最多擺 5 分鐘就要掉咗佢。TTL 就係咁嘅概念——你嘅 Cache 入面嘅資料，放咗一段時間之後就會自動被移除，下次有人嚟攞資料，系統就會去資料庫攞返最新嘅。我建議你由呢個策略開始學，因為佢係最易理解嘅。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 380" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow1" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowIndigo1">
                <feGaussianBlur stdDeviation="6" result="blur"/>
                <feFlood flood-color="#6366f1" flood-opacity="0.3"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradCache1" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#252d3f"/>
              </linearGradient>
              <linearGradient id="gradDB1" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1a2e2a"/>
              </linearGradient>
              <marker id="arrowBlue1" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#6366f1"/>
              </marker>
              <marker id="arrowYellow1" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#fbbf24"/>
              </marker>
              <marker id="arrowGreen1" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#34d399"/>
              </marker>
              <marker id="arrowRed1" markerWidth="8" markerHeight="8" refX="4" refY="7" orient="auto">
                <path d="M0,0 L4,8 L8,0 Z" fill="#f87171"/>
              </marker>
            </defs>

            <!-- User -->
            <g transform="translate(60,160)">
              <circle cx="30" cy="20" r="18" fill="#6366f1" opacity="0.9"/>
              <text x="30" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="600">👤</text>
              <text x="30" y="55" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="500">用戶</text>
            </g>

            <!-- Cache -->
            <g transform="translate(300,120)" filter="url(#glowIndigo1)">
              <rect width="160" height="90" rx="14" fill="url(#gradCache1)" stroke="#6366f1" stroke-width="2" filter="url(#shadow1)"/>
              <text x="80" y="35" text-anchor="middle" fill="#6366f1" font-size="14" font-weight="700">⚡ Cache</text>
              <text x="80" y="55" text-anchor="middle" fill="#9ca3af" font-size="11">（快取記憶體）</text>
              <text x="80" y="75" text-anchor="middle" fill="#fbbf24" font-size="11">⏱ TTL = 5 分鐘</text>
            </g>

            <!-- Database -->
            <g transform="translate(600,120)">
              <rect width="150" height="90" rx="14" fill="url(#gradDB1)" stroke="#34d399" stroke-width="2" filter="url(#shadow1)"/>
              <text x="75" y="35" text-anchor="middle" fill="#34d399" font-size="14" font-weight="700">🗄 資料庫</text>
              <text x="75" y="55" text-anchor="middle" fill="#9ca3af" font-size="11">（Database）</text>
              <text x="75" y="75" text-anchor="middle" fill="#9ca3af" font-size="11">真正嘅資料來源</text>
            </g>

            <!-- Arrow: User -> Cache (Read Request) — curved -->
            <path d="M 120 170 Q 210 150 298 170" fill="none" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowBlue1)"/>
            <text x="200" y="150" text-anchor="middle" fill="#a5b4fc" font-size="11" font-weight="500">❶ 讀取請求</text>

            <!-- Arrow: Cache -> Database (Cache Miss) — curved -->
            <path d="M 462 150 Q 530 130 598 150" fill="none" stroke="#fbbf24" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrowYellow1)"/>
            <text x="530" y="128" text-anchor="middle" fill="#fbbf24" font-size="11" font-weight="500">❷ Cache 冇資料？</text>
            <text x="530" y="115" text-anchor="middle" fill="#fbbf24" font-size="10">去資料庫攞</text>

            <!-- Arrow: Database -> Cache (Store) — curved -->
            <path d="M 598 195 Q 530 215 462 195" fill="none" stroke="#34d399" stroke-width="2" marker-end="url(#arrowGreen1)"/>
            <text x="530" y="235" text-anchor="middle" fill="#34d399" font-size="11" font-weight="500">❸ 儲存到 Cache</text>

            <!-- TTL Expiry -->
            <g transform="translate(310,260)">
              <rect width="140" height="50" rx="10" fill="rgba(239,68,68,0.15)" stroke="#f87171" stroke-width="1.5"/>
              <text x="70" y="22" text-anchor="middle" fill="#f87171" font-size="11" font-weight="600">⏰ 5 分鐘後</text>
              <text x="70" y="40" text-anchor="middle" fill="#f87171" font-size="11">自動刪除 Cache</text>
            </g>
            <line x1="380" y1="212" x2="380" y2="258" stroke="#f87171" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arrowRed1)"/>
          </svg>
        </div>

        <h3 style="color:#fff; font-size:1.1rem; margin-bottom:12px;">我教你點樣理解佢嘅運作</h3>
        <ol class="steps">
          <li>
            <span class="step-num">1</span>
            <span>用戶想攞啲資料，系統先去 Cache 度睇下有冇。你要記住，Cache 係第一道防線。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span>如果 Cache 冇（我哋叫佢做「Cache Miss」），就去資料庫攞返，然後順便存入 Cache。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span>呢份資料喺 Cache 擺咗 5 分鐘之後，就會自動被移除。你可以理解為佢有「保質期」。</span>
          </li>
          <li>
            <span class="step-num">4</span>
            <span>下次有人再攞同一份資料，就重複上面嘅流程。就係咁簡單！</span>
          </li>
        </ol>

        <div class="pros-cons">
          <div class="pros">
            <h4>👍 好處</h4>
            <ul>
              <li>實現超簡單，我建議初學嘅你由呢個開始</li>
              <li>唔使理資料幾時被改過</li>
              <li>適合用嚟快取第三方 API 嘅資料</li>
            </ul>
          </div>
          <div class="cons">
            <h4>👎 壞處</h4>
            <ul>
              <li>喺 TTL 到期之前，用戶可能會睇到舊資料</li>
              <li>如果資料庫嘅嘢被人改咗，Cache 唔會即時更新</li>
            </ul>
          </div>
        </div>

        <div class="use-case">
          <h4>💡 我建議你幾時用？</h4>
          <p>當你用緊第三方 API（例如天氣預報、匯率），你控制唔到人哋幾時改資料，用 TTL 就最啱。我自己好多時候都會先試呢個方法。</p>
        </div>
      </div>
    </div>

    <!-- ===================== TAB 2: Write Through ===================== -->
    <div class="tab-content" id="write-through">
      <div class="card">
        <h2>Write Through — 同步寫入</h2>
        <div class="subtitle">寫入資料嘅時候，Cache 同資料庫一齊更新</div>
        <p>
          我用個生活例子同你解釋。你記低電話號碼，你會同時寫喺手機同紙上面，兩邊都有最新嘅資料。Write Through 就係咁——每次有人改資料，系統會同時更新 Cache 同資料庫，咁樣 Cache 入面永遠都係最新嘅。你要記住呢個策略嘅核心：<strong>兩邊同步</strong>。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 350" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow2" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowAmber2">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#f59e0b" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradCache2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#252d3f"/>
              </linearGradient>
              <linearGradient id="gradDB2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1a2e2a"/>
              </linearGradient>
              <marker id="arrowOrange2" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#f59e0b"/>
              </marker>
              <marker id="arrowBlue2" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#6366f1"/>
              </marker>
            </defs>

            <!-- User -->
            <g transform="translate(60,130)">
              <circle cx="30" cy="20" r="18" fill="#6366f1" opacity="0.9"/>
              <text x="30" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="600">👤</text>
              <text x="30" y="55" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="500">用戶</text>
            </g>

            <!-- Cache -->
            <g transform="translate(300,60)">
              <rect width="160" height="80" rx="14" fill="url(#gradCache2)" stroke="#6366f1" stroke-width="2" filter="url(#shadow2)"/>
              <text x="80" y="30" text-anchor="middle" fill="#6366f1" font-size="14" font-weight="700">⚡ Cache</text>
              <text x="80" y="50" text-anchor="middle" fill="#9ca3af" font-size="11">（快取記憶體）</text>
              <text x="80" y="68" text-anchor="middle" fill="#34d399" font-size="11">✓ 即時更新</text>
            </g>

            <!-- Database -->
            <g transform="translate(300,200)">
              <rect width="160" height="80" rx="14" fill="url(#gradDB2)" stroke="#34d399" stroke-width="2" filter="url(#shadow2)"/>
              <text x="80" y="30" text-anchor="middle" fill="#34d399" font-size="14" font-weight="700">🗄 資料庫</text>
              <text x="80" y="50" text-anchor="middle" fill="#9ca3af" font-size="11">（Database）</text>
              <text x="80" y="68" text-anchor="middle" fill="#34d399" font-size="11">✓ 即時更新</text>
            </g>

            <!-- Arrow: User -> Cache — curved -->
            <path d="M 120 138 Q 200 90 298 100" fill="none" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowOrange2)"/>
            <text x="190" y="95" text-anchor="middle" fill="#f59e0b" font-size="11" font-weight="500">❶ 寫入 Cache</text>

            <!-- Arrow: User -> Database — curved -->
            <path d="M 120 160 Q 200 230 298 238" fill="none" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowOrange2)"/>
            <text x="190" y="220" text-anchor="middle" fill="#f59e0b" font-size="11" font-weight="500">❶ 寫入資料庫</text>

            <!-- Simultaneous Label -->
            <g transform="translate(150,155)" filter="url(#glowAmber2)">
              <rect width="70" height="24" rx="12" fill="rgba(245,158,11,0.2)" stroke="#f59e0b" stroke-width="1"/>
              <text x="35" y="16" text-anchor="middle" fill="#f59e0b" font-size="10" font-weight="600">同時進行</text>
            </g>

            <!-- Read path -->
            <g transform="translate(570,60)">
              <rect width="160" height="80" rx="14" fill="rgba(99,102,241,0.08)" stroke="#6366f1" stroke-width="1" stroke-dasharray="4,3"/>
              <text x="80" y="25" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="600">讀取嘅時候</text>
              <text x="80" y="45" text-anchor="middle" fill="#9ca3af" font-size="11">Cache 一定有</text>
              <text x="80" y="62" text-anchor="middle" fill="#9ca3af" font-size="11">最新嘅資料 ✓</text>
            </g>
            <path d="M 462 100 Q 515 95 568 100" fill="none" stroke="#6366f1" stroke-width="1.5" stroke-dasharray="5,4" marker-end="url(#arrowBlue2)"/>
          </svg>
        </div>

        <h3 style="color:#fff; font-size:1.1rem; margin-bottom:12px;">我教你理解佢嘅運作</h3>
        <ol class="steps">
          <li>
            <span class="step-num">1</span>
            <span>用戶想改資料（例如改名、改地址）。你要知道，呢個係一個「寫入」操作。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span>系統會同時將新資料寫入 Cache 同資料庫。呢個「同時」就係 Write Through 嘅核心。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span>之後有人讀取呢份資料嘅時候，Cache 入面已經係最新版本。你完全唔使擔心資料過期嘅問題。</span>
          </li>
        </ol>

        <div class="pros-cons">
          <div class="pros">
            <h4>👍 好處</h4>
            <ul>
              <li>Cache 入面嘅資料永遠係最新</li>
              <li>讀取速度快，因為 Cache 一定有資料</li>
              <li>資料一致性強，你唔使怕 Cache 同 DB 唔同步</li>
            </ul>
          </div>
          <div class="cons">
            <h4>👎 壞處</h4>
            <ul>
              <li>寫入會慢啲，因為要同時寫兩個地方</li>
              <li>如果其中一邊寫入失敗，Cache 同資料庫可能會唔一致</li>
              <li>有出錯嘅風險需要額外處理</li>
            </ul>
          </div>
        </div>

        <div class="use-case">
          <h4>💡 我建議你幾時用？</h4>
          <p>當你需要 Cache 入面嘅資料永遠都係最新，而且你可以接受寫入慢少少嘅時候。例如用戶個人資料、帳戶設定呢啲經常被讀取嘅資料，我會推薦你用呢個策略。</p>
        </div>
      </div>
    </div>

    <!-- ===================== TAB 3: Write Around ===================== -->
    <div class="tab-content" id="write-around">
      <div class="card">
        <h2>Write Around — 繞過快取寫入</h2>
        <div class="subtitle">寫入嘅時候只寫資料庫，然後踢走 Cache 入面嘅舊資料</div>
        <p>
          我同你講個比喻。你更新咗屋企嘅電話簿，但你唔急住喺手機度同步，你只係刪除手機舊嘅記錄。下次你需要嗰個號碼嘅時候，再從電話簿抄返。Write Around 就係咁——寫入嘅時候只更新資料庫，然後將 Cache 入面嘅舊記錄刪除，等下次有人需要嘅時候再重新快取。你要記住呢個模式：<strong>寫 DB、踢 Cache、懶加載</strong>。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 380" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow3" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowGreen3">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#34d399" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradCacheR3" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a2030"/>
              </linearGradient>
              <linearGradient id="gradDB3" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1a2e2a"/>
              </linearGradient>
              <marker id="arrowGreen3" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#34d399"/>
              </marker>
              <marker id="arrowRed3" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#f87171"/>
              </marker>
              <marker id="arrowBlue3" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#6366f1"/>
              </marker>
            </defs>

            <!-- User -->
            <g transform="translate(60,150)">
              <circle cx="30" cy="20" r="18" fill="#6366f1" opacity="0.9"/>
              <text x="30" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="600">👤</text>
              <text x="30" y="55" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="500">用戶</text>
            </g>

            <!-- Cache -->
            <g transform="translate(300,60)">
              <rect width="160" height="80" rx="14" fill="url(#gradCacheR3)" stroke="#f87171" stroke-width="2" filter="url(#shadow3)"/>
              <text x="80" y="30" text-anchor="middle" fill="#6366f1" font-size="14" font-weight="700">⚡ Cache</text>
              <text x="80" y="50" text-anchor="middle" fill="#9ca3af" font-size="11">（快取記憶體）</text>
              <text x="80" y="68" text-anchor="middle" fill="#f87171" font-size="11">🗑 舊資料被刪除</text>
            </g>

            <!-- Database -->
            <g transform="translate(300,220)" filter="url(#glowGreen3)">
              <rect width="160" height="80" rx="14" fill="url(#gradDB3)" stroke="#34d399" stroke-width="2" filter="url(#shadow3)"/>
              <text x="80" y="30" text-anchor="middle" fill="#34d399" font-size="14" font-weight="700">🗄 資料庫</text>
              <text x="80" y="50" text-anchor="middle" fill="#9ca3af" font-size="11">（Database）</text>
              <text x="80" y="68" text-anchor="middle" fill="#34d399" font-size="11">✓ 直接寫入新資料</text>
            </g>

            <!-- Arrow: User -> Database (Write) — curved -->
            <path d="M 120 178 Q 200 260 298 258" fill="none" stroke="#34d399" stroke-width="2.5" marker-end="url(#arrowGreen3)"/>
            <text x="185" y="245" text-anchor="middle" fill="#34d399" font-size="11" font-weight="600">❶ 直接寫入資料庫</text>

            <!-- Arrow: Evict Cache — curved -->
            <path d="M 120 160 Q 200 100 298 102" fill="none" stroke="#f87171" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrowRed3)"/>
            <text x="195" y="110" text-anchor="middle" fill="#f87171" font-size="11" font-weight="500">❷ 刪除 Cache 舊記錄</text>

            <!-- Later Read -->
            <g transform="translate(570,120)">
              <rect width="180" height="100" rx="14" fill="rgba(99,102,241,0.08)" stroke="#6366f1" stroke-width="1" stroke-dasharray="4,3"/>
              <text x="90" y="25" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="600">之後有人讀取時</text>
              <text x="90" y="48" text-anchor="middle" fill="#9ca3af" font-size="11">Cache 冇資料（Miss）</text>
              <text x="90" y="66" text-anchor="middle" fill="#9ca3af" font-size="11">去資料庫攞最新版本</text>
              <text x="90" y="84" text-anchor="middle" fill="#34d399" font-size="11">重新存入 Cache ✓</text>
            </g>
            <path d="M 462 100 Q 515 130 568 155" fill="none" stroke="#6366f1" stroke-width="1.5" stroke-dasharray="5,4" marker-end="url(#arrowBlue3)"/>
          </svg>
        </div>

        <h3 style="color:#fff; font-size:1.1rem; margin-bottom:12px;">我教你理解佢嘅運作</h3>
        <ol class="steps">
          <li>
            <span class="step-num">1</span>
            <span>用戶想改資料，系統直接寫入資料庫，唔寫 Cache。你留意到冇？佢「繞過」咗 Cache。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span>如果 Cache 入面有呢份資料嘅舊版本，即刻刪除佢（我哋叫做「evict」）。呢步好重要，唔好忘記。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span>下次有人要讀呢份資料，Cache 冇嘢（Cache Miss），就去資料庫攞返最新版，然後重新存入 Cache。呢個就係「懶加載」嘅概念。</span>
          </li>
        </ol>

        <div class="pros-cons">
          <div class="pros">
            <h4>👍 好處</h4>
            <ul>
              <li>唔使擔心 Cache 同資料庫唔同步</li>
              <li>寫入只寫一個地方，減低出錯風險</li>
              <li>簡單直接，我好推薦初學者用呢個</li>
            </ul>
          </div>
          <div class="cons">
            <h4>👎 壞處</h4>
            <ul>
              <li>寫入之後第一次讀取會慢啲（因為要去資料庫攞）</li>
              <li>如果啲資料寫完之後好快就被讀，就唔夠快</li>
            </ul>
          </div>
        </div>

        <div class="use-case">
          <h4>💡 我建議你幾時用？</h4>
          <p>當你改完資料之後，唔預期即刻會有人讀返佢，或者你唔想處理 Cache 同資料庫同步出錯嘅問題嘅時候。例如日誌記錄、歷史資料更新等，我都會揀呢個策略。</p>
        </div>
      </div>
    </div>

    <!-- ===================== TAB 4: Write Back ===================== -->
    <div class="tab-content" id="write-back">
      <div class="card">
        <h2>Write Back — 延遲寫入（寫先快取）</h2>
        <div class="subtitle">追求最快寫入速度：先寫 Cache，遲啲再同步去資料庫</div>
        <p>
          我要同你講一個進階嘅策略。想像你喺白板度快速記低嘢，遲啲得閒先抄入筆記簿。Write Back 就係呢個概念——用戶改資料嘅時候，系統只寫入 Cache（超快！），然後背景會有個「小助手」定時將 Cache 入面嘅新資料同步返去資料庫。你要特別留意佢嘅風險：<strong>Cache 一掛，未同步嘅資料就冇咗</strong>。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow4" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowIndigo4">
                <feGaussianBlur stdDeviation="6" result="blur"/>
                <feFlood flood-color="#6366f1" flood-opacity="0.3"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradCache4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#252d3f"/>
              </linearGradient>
              <linearGradient id="gradDB4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1a2e2a"/>
              </linearGradient>
              <linearGradient id="gradAsync4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="rgba(245,158,11,0.2)"/>
                <stop offset="100%" stop-color="rgba(245,158,11,0.08)"/>
              </linearGradient>
              <marker id="arrowBlue4" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#6366f1"/>
              </marker>
              <marker id="arrowOrange4" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#f59e0b"/>
              </marker>
            </defs>

            <!-- User -->
            <g transform="translate(60,120)">
              <circle cx="30" cy="20" r="18" fill="#6366f1" opacity="0.9"/>
              <text x="30" y="25" text-anchor="middle" fill="#fff" font-size="14" font-weight="600">👤</text>
              <text x="30" y="55" text-anchor="middle" fill="#a5b4fc" font-size="12" font-weight="500">用戶</text>
            </g>

            <!-- Cache -->
            <g transform="translate(250,90)" filter="url(#glowIndigo4)">
              <rect width="180" height="90" rx="14" fill="url(#gradCache4)" stroke="#6366f1" stroke-width="2" filter="url(#shadow4)"/>
              <text x="90" y="30" text-anchor="middle" fill="#6366f1" font-size="14" font-weight="700">⚡ Cache</text>
              <text x="90" y="50" text-anchor="middle" fill="#9ca3af" font-size="11">（快取記憶體）</text>
              <text x="90" y="70" text-anchor="middle" fill="#34d399" font-size="11">✓ 直接寫入，超快！</text>
            </g>

            <!-- Async Job -->
            <g transform="translate(280,240)">
              <rect width="130" height="60" rx="30" fill="url(#gradAsync4)" stroke="#f59e0b" stroke-width="2"/>
              <text x="65" y="25" text-anchor="middle" fill="#f59e0b" font-size="12" font-weight="700">🔄 背景任務</text>
              <text x="65" y="42" text-anchor="middle" fill="#fbbf24" font-size="10">（Async Job）</text>
            </g>

            <!-- Database -->
            <g transform="translate(560,90)">
              <rect width="170" height="90" rx="14" fill="url(#gradDB4)" stroke="#34d399" stroke-width="2" filter="url(#shadow4)"/>
              <text x="85" y="30" text-anchor="middle" fill="#34d399" font-size="14" font-weight="700">🗄 資料庫</text>
              <text x="85" y="50" text-anchor="middle" fill="#9ca3af" font-size="11">（Database）</text>
              <text x="85" y="70" text-anchor="middle" fill="#fbbf24" font-size="11">⏳ 遲啲先更新</text>
            </g>

            <!-- Arrow: User -> Cache (Fast Write) — curved -->
            <path d="M 120 138 Q 185 115 248 133" fill="none" stroke="#6366f1" stroke-width="2.5" marker-end="url(#arrowBlue4)"/>
            <text x="175" y="112" text-anchor="middle" fill="#a5b4fc" font-size="11" font-weight="600">❶ 寫入 Cache</text>
            <g transform="translate(155,118)">
              <rect width="48" height="16" rx="8" fill="rgba(52,211,153,0.2)" stroke="#34d399" stroke-width="1"/>
              <text x="24" y="12" text-anchor="middle" fill="#34d399" font-size="9" font-weight="700">超快⚡</text>
            </g>

            <!-- Arrow: Cache -> Async Job -->
            <line x1="340" y1="182" x2="340" y2="238" stroke="#f59e0b" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrowOrange4)"/>

            <!-- Arrow: Async Job -> Database — curved -->
            <path d="M 412 270 Q 500 270 558 160" fill="none" stroke="#f59e0b" stroke-width="2" stroke-dasharray="6,4" marker-end="url(#arrowOrange4)"/>
            <text x="510" y="250" text-anchor="middle" fill="#f59e0b" font-size="11" font-weight="500">❷ 稍後同步到資料庫</text>

            <!-- No direct write to DB -->
            <g transform="translate(430,30)">
              <rect width="160" height="40" rx="10" fill="rgba(248,113,113,0.1)" stroke="#f87171" stroke-width="1" stroke-dasharray="4,3"/>
              <text x="80" y="16" text-anchor="middle" fill="#f87171" font-size="10">✗ 寫入時唔直接寫資料庫</text>
              <text x="80" y="32" text-anchor="middle" fill="#f87171" font-size="10">所以寫入超級快！</text>
            </g>
          </svg>
        </div>

        <h3 style="color:#fff; font-size:1.1rem; margin-bottom:12px;">我教你理解佢嘅運作</h3>
        <ol class="steps">
          <li>
            <span class="step-num">1</span>
            <span>用戶想寫資料，系統只寫入 Cache——唔寫資料庫，所以超快！呢個就係 Write Back 嘅精髓。</span>
          </li>
          <li>
            <span class="step-num">2</span>
            <span>背景有個自動任務（Async Job），會定時將 Cache 入面嘅新資料同步返去資料庫。你可以理解為有個「小助手」幫你搞。</span>
          </li>
          <li>
            <span class="step-num">3</span>
            <span>讀取嘅時候，Cache 入面已經有最新嘅資料，即刻回覆用戶。用戶體驗超好。</span>
          </li>
        </ol>

        <div class="pros-cons">
          <div class="pros">
            <h4>👍 好處</h4>
            <ul>
              <li>寫入速度係所有策略入面最快嘅</li>
              <li>用戶唔使等資料庫寫入完成</li>
              <li>適合高流量嘅系統</li>
            </ul>
          </div>
          <div class="cons">
            <h4>👎 壞處</h4>
            <ul>
              <li>如果 Cache 掛咗（例如斷電），未同步嘅資料可能會不見</li>
              <li>資料庫同 Cache 之間會有短暫嘅唔一致</li>
              <li>實現比較複雜，你需要處理同步失敗嘅情況</li>
            </ul>
          </div>
        </div>

        <div class="use-case">
          <h4>💡 我建議你幾時用？</h4>
          <p>當你最在乎寫入速度，而且可以接受短暫嘅資料唔一致。例如社交媒體嘅「讚」數、即時通訊嘅訊息狀態、遊戲入面嘅分數記錄等。我提醒你，用呢個策略之前一定要做好容錯機制。</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Tab switching
    const tabs = document.querySelectorAll('.tab-btn');
    const contents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // Remove active from all
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));

        // Add active to clicked tab and corresponding content
        tab.classList.add('active');
        const target = document.getElementById(tab.dataset.tab);
        if (target) target.classList.add('active');
      });
    });
  </script>
</body>
</html>
