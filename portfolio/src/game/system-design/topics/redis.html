<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Redis — 系統架構圖解</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang HK", "Microsoft JhengHei", sans-serif; background: #0f1117; color: #e0e0e0; min-height: 100vh; }
    .container { max-width: 960px; margin: 0 auto; padding: 40px 24px; }
    header { text-align: center; margin-bottom: 40px; }
    header h1 { font-size: 2rem; font-weight: 700; color: #ffffff; margin-bottom: 8px; }
    header p { font-size: 1rem; color: #9ca3af; line-height: 1.6; }
    .card { background: #1a1d27; border-radius: 16px; padding: 32px; margin-bottom: 24px; border: 1px solid #2a2d3a; }
    .card h2 { font-size: 1.5rem; color: #ffffff; margin-bottom: 8px; }
    .card .subtitle { font-size: 0.95rem; color: #6366f1; font-weight: 500; margin-bottom: 16px; }
    .card p { font-size: 0.95rem; color: #c0c4cc; line-height: 1.8; margin-bottom: 12px; }
    .diagram-container { background: #13151c; border-radius: 12px; padding: 24px; margin: 24px 0; overflow-x: auto; border: 1px solid #2a2d3a; }
    .diagram-container svg { display: block; margin: 0 auto; max-width: 100%; height: auto; }
    .steps { list-style: none; padding: 0; margin: 16px 0; }
    .steps li { display: flex; align-items: flex-start; gap: 12px; padding: 12px 0; border-bottom: 1px solid #2a2d3a; font-size: 0.95rem; color: #c0c4cc; line-height: 1.6; }
    .steps li:last-child { border-bottom: none; }
    .step-num { flex-shrink: 0; width: 28px; height: 28px; border-radius: 50%; background: #6366f1; color: #fff; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: 700; }
    .key-points { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px; }
    @media (max-width: 600px) { .key-points { grid-template-columns: 1fr; } .container { padding: 24px 16px; } header h1 { font-size: 1.5rem; } .card { padding: 20px; } }
    .key-point { background: #13151c; border-radius: 10px; padding: 16px; border-left: 3px solid #6366f1; }
    .key-point h4 { color: #a5b4fc; font-size: 0.9rem; margin-bottom: 6px; }
    .key-point p { font-size: 0.85rem; color: #c0c4cc; margin-bottom: 0; line-height: 1.6; }
    .use-case { background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05)); border-left: 3px solid #6366f1; border-radius: 0 10px 10px 0; padding: 16px 20px; margin-top: 16px; }
    .use-case h4 { color: #a5b4fc; font-size: 0.9rem; margin-bottom: 6px; }
    .use-case p { font-size: 0.9rem; color: #c0c4cc; margin-bottom: 0; }
    .tabs { display: flex; gap: 4px; background: #1a1d27; border-radius: 12px; padding: 4px; margin-bottom: 24px; overflow-x: auto; }
    .tab-btn { flex: 1; padding: 12px 16px; border: none; background: transparent; color: #9ca3af; font-size: 0.9rem; font-weight: 500; border-radius: 8px; cursor: pointer; transition: all 0.25s ease; white-space: nowrap; font-family: inherit; }
    .tab-btn:hover { color: #e0e0e0; background: rgba(255, 255, 255, 0.05); }
    .tab-btn.active { background: #6366f1; color: #ffffff; font-weight: 600; }
    .tab-content { display: none; animation: fadeIn 0.3s ease; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    .highlight-box { background: rgba(245,158,11,0.1); border-left: 3px solid #F59E0B; border-radius: 0 10px 10px 0; padding: 16px 20px; margin: 16px 0; }
    .highlight-box p { color: #fbbf24; font-size: 0.95rem; line-height: 1.8; margin: 0; font-weight: 500; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Redis</h1>
      <p>In-Memory Key-Value Store — 微秒級嘅延遲點樣做到</p>
    </header>

    <div class="tabs">
      <button class="tab-btn active" data-tab="what">① Redis 係咩</button>
      <button class="tab-btn" data-tab="tradeoffs">② Trade-offs</button>
      <button class="tab-btn" data-tab="realworld">③ 實戰應用</button>
    </div>

    <div class="tab-content active" id="what">
      <div class="card">
        <h2>Redis 係咩？</h2>
        <div class="subtitle">In-Memory Key-Value Database</div>
        <p>
          我想同你講一個好重要嘅概念。傳統嘅資料庫（好似 Postgres、MySQL）將資料存喺硬碟度，所以每次查詢都要經過磁碟 I/O。而 <strong style="color:#34d399">Redis 將資料存喺 RAM（記憶體）入面</strong>，完全跳過咗磁碟呢一層。結果係：<strong style="color:#6366f1">微秒級（microsecond）嘅延遲</strong>。
        </p>
        <p>
          呢個係一個 Key-Value Store，即係話你用一個 key 去攞對應嘅 value。好似一個超快嘅字典咁。Redis 支援唔同嘅資料結構：String、List、Set、Hash、Sorted Set 等等。所以佢唔止係簡單嘅 key-value，仲可以做好多複雜嘅操作。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 680 360" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow" x="-4%" y="-4%" width="108%" height="108%"><feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/></filter>
              <filter id="glowGreen">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#34d399" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <filter id="glowPurple">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#8B5CF6" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradRedis" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a1e1e"/>
              </linearGradient>
              <linearGradient id="gradDisk" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#251e35"/>
              </linearGradient>
              <linearGradient id="gradApp" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1e2940"/>
              </linearGradient>
              <marker id="arrGreen" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 Z" fill="#34d399"/></marker>
              <marker id="arrPurple" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 Z" fill="#8B5CF6"/></marker>
              <marker id="arrAmber" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 Z" fill="#fbbf24"/></marker>
            </defs>

            <!-- App -->
            <g transform="translate(40,150)" filter="url(#glowGreen)">
              <rect width="120" height="70" rx="14" fill="url(#gradApp)" stroke="#3B82F6" stroke-width="2" filter="url(#shadow)"/>
              <text x="60" y="30" text-anchor="middle" fill="#3B82F6" font-size="13" font-weight="700">App</text>
              <text x="60" y="50" text-anchor="middle" fill="#9ca3af" font-size="10">應用程式</text>
            </g>

            <!-- Redis (RAM) -->
            <g transform="translate(270,60)">
              <rect width="160" height="90" rx="14" fill="url(#gradRedis)" stroke="#EF4444" stroke-width="2" filter="url(#shadow)"/>
              <text x="80" y="25" text-anchor="middle" fill="#EF4444" font-size="13" font-weight="700">Redis (RAM)</text>
              <text x="80" y="45" text-anchor="middle" fill="#9ca3af" font-size="10">Key-Value Store</text>
              <text x="80" y="65" text-anchor="middle" fill="#34d399" font-size="11" font-weight="700">Microsecond</text>
              <text x="80" y="80" text-anchor="middle" fill="#34d399" font-size="11" font-weight="700">Latency</text>
            </g>

            <!-- PostgreSQL (Disk) -->
            <g transform="translate(270,210)">
              <rect width="160" height="90" rx="14" fill="url(#gradDisk)" stroke="#8B5CF6" stroke-width="2" filter="url(#shadow)"/>
              <text x="80" y="25" text-anchor="middle" fill="#8B5CF6" font-size="13" font-weight="700">Postgres (Disk)</text>
              <text x="80" y="45" text-anchor="middle" fill="#9ca3af" font-size="10">傳統資料庫</text>
              <text x="80" y="65" text-anchor="middle" fill="#f87171" font-size="11" font-weight="700">Millisecond</text>
              <text x="80" y="80" text-anchor="middle" fill="#f87171" font-size="11" font-weight="700">Latency</text>
            </g>

            <!-- Arrows -->
            <path d="M 162 175 Q 210 110 268 100" fill="none" stroke="#34d399" stroke-width="2" marker-end="url(#arrGreen)"/>
            <text x="200" y="135" fill="#34d399" font-size="11" font-weight="600">超快查詢</text>

            <path d="M 162 195 Q 210 235 268 250" fill="none" stroke="#8B5CF6" stroke-width="2" marker-end="url(#arrPurple)"/>
            <text x="200" y="225" fill="#8B5CF6" font-size="11" font-weight="600">慢啲</text>

            <!-- Speed comparison -->
            <g transform="translate(480,60)">
              <rect width="160" height="240" rx="14" fill="rgba(245,158,11,0.08)" stroke="#F59E0B" stroke-width="1.5"/>
              <text x="80" y="25" text-anchor="middle" fill="#fbbf24" font-size="12" font-weight="700">速度對比</text>

              <text x="20" y="55" fill="#34d399" font-size="11" font-weight="700">Redis (RAM):</text>
              <text x="20" y="75" fill="#9ca3af" font-size="10">• 微秒級 (μs)</text>
              <text x="20" y="92" fill="#9ca3af" font-size="10">• 1-100 μs</text>
              <text x="20" y="109" fill="#9ca3af" font-size="10">• 極快讀寫</text>

              <line x1="20" y1="125" x2="140" y2="125" stroke="#2a2d3a" stroke-width="1"/>

              <text x="20" y="150" fill="#f87171" font-size="11" font-weight="700">Postgres (Disk):</text>
              <text x="20" y="170" fill="#9ca3af" font-size="10">• 毫秒級 (ms)</text>
              <text x="20" y="187" fill="#9ca3af" font-size="10">• 1-100 ms</text>
              <text x="20" y="204" fill="#9ca3af" font-size="10">• 慢 1000 倍</text>

              <text x="80" y="230" text-anchor="middle" fill="#fbbf24" font-size="10" font-weight="600">差距：1000x</text>
            </g>
          </svg>
        </div>

        <h3 style="color:#fff; font-size:1.1rem; margin-bottom:12px;">點解咁快？</h3>
        <div class="key-points">
          <div class="key-point">
            <h4>RAM vs Disk</h4>
            <p>RAM 存取速度比 Disk 快成千倍。傳統資料庫需要讀寫硬碟，Redis 全部操作都喺記憶體完成，所以可以做到微秒級嘅延遲。</p>
          </div>
          <div class="key-point">
            <h4>簡單嘅資料結構</h4>
            <p>Key-Value 係最簡單嘅資料結構，唔需要複雜嘅查詢計劃或者 JOIN 操作。直接用 key 攞 value，O(1) 時間複雜度。</p>
          </div>
          <div class="key-point">
            <h4>Single-threaded</h4>
            <p>Redis 用單線程處理所有請求，避免咗多線程嘅 lock 同 context switch overhead。反而因為係 in-memory，單線程都夠快。</p>
          </div>
          <div class="key-point">
            <h4>豐富嘅資料類型</h4>
            <p>雖然係 Key-Value Store，但支援 List、Set、Hash、Sorted Set 等等。可以做 Leaderboard、Session Store、Message Queue 等等用途。</p>
          </div>
        </div>

        <div class="highlight-box">
          <p>關鍵重點：Redis 犧牲咗儲存空間同持久性，換取咗極致嘅速度。呢個就係典型嘅 trade-off。</p>
        </div>
      </div>
    </div>

    <div class="tab-content" id="tradeoffs">
      <div class="card">
        <h2>Trade-offs</h2>
        <div class="subtitle">冇嘢係完美嘅 — RAM 嘅代價</div>
        <p>
          好，而家我要同你講 Redis 嘅缺點。因為 Redis 將所有嘢放喺 RAM 入面，呢個決定帶嚟兩個核心問題：<strong style="color:#f87171">RAM 好貴而且好有限</strong>，同埋 <strong style="color:#f87171">資料喺 crash 嘅時候會遺失</strong>。我哋逐個拆解。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 680 400" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow2" x="-4%" y="-4%" width="108%" height="108%"><feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/></filter>
              <linearGradient id="gradCost" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a1e1e"/>
              </linearGradient>
            </defs>

            <!-- Cost Comparison -->
            <g transform="translate(40,40)">
              <rect width="280" height="140" rx="14" fill="url(#gradCost)" stroke="#f87171" stroke-width="2" filter="url(#shadow2)"/>
              <text x="140" y="25" text-anchor="middle" fill="#f87171" font-size="13" font-weight="700">儲存成本</text>

              <text x="20" y="55" fill="#fbbf24" font-size="11" font-weight="700">RAM (Redis):</text>
              <text x="20" y="75" fill="#9ca3af" font-size="10">• 每 GB 約 $10-20</text>
              <text x="20" y="92" fill="#9ca3af" font-size="10">• 容量有限 (幾十 GB)</text>

              <line x1="20" y1="105" x2="260" y2="105" stroke="#2a2d3a" stroke-width="1"/>

              <text x="20" y="125" fill="#34d399" font-size="11" font-weight="700">Disk (SSD):</text>
              <text x="160" y="125" fill="#9ca3af" font-size="10">每 GB 約 $0.10</text>
            </g>

            <!-- Durability Problem -->
            <g transform="translate(360,40)">
              <rect width="280" height="140" rx="14" fill="url(#gradCost)" stroke="#f87171" stroke-width="2" filter="url(#shadow2)"/>
              <text x="140" y="25" text-anchor="middle" fill="#f87171" font-size="13" font-weight="700">持久性問題</text>

              <text x="20" y="55" fill="#fbbf24" font-size="11" font-weight="700">Server Crash:</text>
              <text x="20" y="75" fill="#9ca3af" font-size="10">• RAM 資料全部遺失</text>
              <text x="20" y="92" fill="#9ca3af" font-size="10">• 重啟後 Redis 空白</text>

              <line x1="20" y1="105" x2="260" y2="105" stroke="#2a2d3a" stroke-width="1"/>

              <text x="20" y="125" fill="#34d399" font-size="11" font-weight="700">解決方案存在但唔完美</text>
            </g>

            <!-- Backup Methods -->
            <g transform="translate(40,220)">
              <rect width="600" height="160" rx="14" fill="rgba(99,102,241,0.08)" stroke="#6366f1" stroke-width="1.5"/>
              <text x="300" y="25" text-anchor="middle" fill="#6366f1" font-size="13" font-weight="700">備份方法</text>

              <g transform="translate(20,45)">
                <rect width="260" height="95" rx="10" fill="#13151c" stroke="#2a2d3a" stroke-width="1"/>
                <text x="130" y="22" text-anchor="middle" fill="#a5b4fc" font-size="11" font-weight="700">RDB (Snapshot)</text>
                <text x="15" y="42" fill="#9ca3af" font-size="10">• 定時將整個資料集寫入 disk</text>
                <text x="15" y="59" fill="#9ca3af" font-size="10">• 快速恢復</text>
                <text x="15" y="76" fill="#f87171" font-size="10">• 但會遺失最後一次 snapshot</text>
                <text x="15" y="90" fill="#f87171" font-size="10">  後嘅所有寫入</text>
              </g>

              <g transform="translate(310,45)">
                <rect width="270" height="95" rx="10" fill="#13151c" stroke="#2a2d3a" stroke-width="1"/>
                <text x="135" y="22" text-anchor="middle" fill="#a5b4fc" font-size="11" font-weight="700">AOF (Append-Only File)</text>
                <text x="15" y="42" fill="#9ca3af" font-size="10">• 每個寫入操作都記錄到 log</text>
                <text x="15" y="59" fill="#9ca3af" font-size="10">• 更好嘅持久性</text>
                <text x="15" y="76" fill="#f87171" font-size="10">• 但會影響寫入效能</text>
                <text x="15" y="90" fill="#f87171" font-size="10">• 重啟恢復時間較長</text>
              </g>
            </g>
          </svg>
        </div>

        <h3 style="color:#fff; font-size:1.1rem; margin-bottom:12px;">核心 Trade-offs</h3>
        <ol class="steps">
          <li><span class="step-num">1</span><span><strong>成本高昂：</strong>RAM 比 SSD 貴成 100 倍。如果你要儲 1TB 嘅資料，用 Disk 可能只係 $100，但用 RAM 就要成萬蚊。所以 Redis 通常只會用嚟存最熱門嘅資料。</span></li>
          <li><span class="step-num">2</span><span><strong>容量有限：</strong>一台 Server 嘅 RAM 通常只有幾十 GB，唔似 Disk 可以去到幾 TB。所以 Redis 唔適合做主資料庫，通常係做 Cache 或者 Session Store。</span></li>
          <li><span class="step-num">3</span><span><strong>資料會遺失：</strong>Server crash 或者重啟嘅時候，RAM 入面嘅嘢會全部清空。雖然有 RDB 同 AOF 兩種備份方法，但都會遺失最近嘅寫入。呢個係無可避免嘅。</span></li>
          <li><span class="step-num">4</span><span><strong>唔適合做唯一資料來源：</strong>因為以上嘅問題，我哋通常會將 Redis 同傳統資料庫（好似 Postgres）一齊用。Redis 做快取，Postgres 做持久化。呢個就係最常見嘅組合策略。</span></li>
        </ol>

        <div class="highlight-box">
          <p>我嘅結論：Redis 唔係用嚟取代傳統資料庫，而係補充佢。用 Redis 嘅速度處理熱門資料，用 Postgres 嘅持久性保護重要資料。</p>
        </div>
      </div>
    </div>

    <div class="tab-content" id="realworld">
      <div class="card">
        <h2>實戰應用</h2>
        <div class="subtitle">遊戲排行榜：Redis + Postgres 組合策略</div>
        <p>
          我而家想同你講一個真實場景：即時排行榜系統。假設你做緊一個遊戲，需要顯示全球玩家嘅即時排名。呢個場景需要：<strong style="color:#34d399">超低延遲</strong>（玩家打完一局即刻更新）同 <strong style="color:#34d399">高併發</strong>（成千上萬玩家同時玩）。呢個就係 Redis 嘅完美用途。
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 700 440" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow3" x="-4%" y="-4%" width="108%" height="108%"><feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/></filter>
              <linearGradient id="gradFE" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1e2940"/>
              </linearGradient>
              <linearGradient id="gradBE" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a1e2a"/>
              </linearGradient>
              <linearGradient id="gradRedis2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a1e1e"/>
              </linearGradient>
              <linearGradient id="gradPG" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#251e35"/>
              </linearGradient>
              <marker id="arrBlue2" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 Z" fill="#6366f1"/></marker>
              <marker id="arrGreen2" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 Z" fill="#34d399"/></marker>
              <marker id="arrAmber2" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto"><path d="M0,0 L8,4 L0,8 Z" fill="#fbbf24"/></marker>
            </defs>

            <!-- React Frontend -->
            <g transform="translate(40,180)">
              <rect width="120" height="70" rx="14" fill="url(#gradFE)" stroke="#3B82F6" stroke-width="2" filter="url(#shadow3)"/>
              <text x="60" y="30" text-anchor="middle" fill="#3B82F6" font-size="13" font-weight="700">React</text>
              <text x="60" y="50" text-anchor="middle" fill="#9ca3af" font-size="10">前端</text>
            </g>

            <!-- Backend -->
            <g transform="translate(270,180)">
              <rect width="120" height="70" rx="14" fill="url(#gradBE)" stroke="#a5b4fc" stroke-width="2" filter="url(#shadow3)"/>
              <text x="60" y="30" text-anchor="middle" fill="#a5b4fc" font-size="13" font-weight="700">Backend</text>
              <text x="60" y="50" text-anchor="middle" fill="#9ca3af" font-size="10">Node.js / Go</text>
            </g>

            <!-- Redis -->
            <g transform="translate(500,80)">
              <rect width="160" height="90" rx="14" fill="url(#gradRedis2)" stroke="#EF4444" stroke-width="2" filter="url(#shadow3)"/>
              <text x="80" y="25" text-anchor="middle" fill="#EF4444" font-size="13" font-weight="700">Redis</text>
              <text x="80" y="45" text-anchor="middle" fill="#9ca3af" font-size="10">Sorted Set</text>
              <text x="80" y="62" text-anchor="middle" fill="#34d399" font-size="10" font-weight="600">即時排行榜</text>
              <text x="80" y="77" text-anchor="middle" fill="#34d399" font-size="10" font-weight="600">Leaderboard</text>
            </g>

            <!-- Postgres -->
            <g transform="translate(500,230)">
              <rect width="160" height="90" rx="14" fill="url(#gradPG)" stroke="#8B5CF6" stroke-width="2" filter="url(#shadow3)"/>
              <text x="80" y="25" text-anchor="middle" fill="#8B5CF6" font-size="13" font-weight="700">Postgres</text>
              <text x="80" y="45" text-anchor="middle" fill="#9ca3af" font-size="10">持久化資料</text>
              <text x="80" y="62" text-anchor="middle" fill="#a5b4fc" font-size="10" font-weight="600">用戶資料</text>
              <text x="80" y="77" text-anchor="middle" fill="#a5b4fc" font-size="10" font-weight="600">歷史記錄</text>
            </g>

            <!-- WebSocket Connection -->
            <path d="M 162 210 Q 210 205 268 210" fill="none" stroke="#6366f1" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrBlue2)"/>
            <text x="215" y="195" text-anchor="middle" fill="#6366f1" font-size="10" font-weight="600">WebSocket</text>
            <text x="215" y="208" text-anchor="middle" fill="#6366f1" font-size="9">即時連接</text>

            <!-- Backend to Redis -->
            <path d="M 392 200 Q 440 150 498 125" fill="none" stroke="#34d399" stroke-width="2" marker-end="url(#arrGreen2)"/>
            <text x="445" y="155" text-anchor="middle" fill="#34d399" font-size="10" font-weight="600">讀/寫排名</text>
            <text x="445" y="168" text-anchor="middle" fill="#34d399" font-size="9">微秒級</text>

            <!-- Backend to Postgres -->
            <path d="M 392 220 Q 440 250 498 270" fill="none" stroke="#8B5CF6" stroke-width="2" marker-end="url(#arrAmber2)"/>
            <text x="445" y="260" text-anchor="middle" fill="#8B5CF6" font-size="10" font-weight="600">儲存用戶</text>

            <!-- Flow annotations -->
            <g transform="translate(40,30)">
              <rect width="620" height="35" rx="10" fill="rgba(245,158,11,0.1)" stroke="#F59E0B" stroke-width="1.5"/>
              <text x="310" y="23" text-anchor="middle" fill="#fbbf24" font-size="11" font-weight="700">即時排行榜流程：玩家完成遊戲 → Backend 更新 Redis Sorted Set → WebSocket 推送最新排名</text>
            </g>

            <!-- Data Flow Steps -->
            <g transform="translate(40,340)">
              <rect width="300" height="85" rx="10" fill="#13151c" stroke="#34d399" stroke-width="1.5"/>
              <text x="150" y="20" text-anchor="middle" fill="#34d399" font-size="11" font-weight="700">Redis 操作</text>
              <text x="15" y="40" fill="#9ca3af" font-size="10">1. ZADD leaderboard 1500 user:123</text>
              <text x="15" y="57" fill="#9ca3af" font-size="10">2. ZREVRANGE leaderboard 0 99</text>
              <text x="15" y="74" fill="#9ca3af" font-size="10">3. ZRANK leaderboard user:123</text>
            </g>

            <g transform="translate(360,340)">
              <rect width="300" height="85" rx="10" fill="#13151c" stroke="#8B5CF6" stroke-width="1.5"/>
              <text x="150" y="20" text-anchor="middle" fill="#8B5CF6" font-size="11" font-weight="700">Postgres 操作</text>
              <text x="15" y="40" fill="#9ca3af" font-size="10">1. 儲存用戶完整資料</text>
              <text x="15" y="57" fill="#9ca3af" font-size="10">2. 記錄遊戲歷史</text>
              <text x="15" y="74" fill="#9ca3af" font-size="10">3. 分析統計報告</text>
            </g>
          </svg>
        </div>

        <h3 style="color:#fff; font-size:1.1rem; margin-bottom:12px;">系統架構詳解</h3>
        <ol class="steps">
          <li><span class="step-num">1</span><span><strong>React 前端：</strong>顯示即時排行榜，通過 WebSocket 連接到 Backend。每當有玩家分數更新，即刻收到推送，唔需要不停 polling。呢個係即時系統嘅標準做法。</span></li>
          <li><span class="step-num">2</span><span><strong>Backend Server：</strong>處理遊戲邏輯，玩家打完一局之後，用 ZADD 指令更新 Redis Sorted Set。然後通過 WebSocket 推送最新排名俾所有在線玩家。微秒級嘅更新速度。</span></li>
          <li><span class="step-num">3</span><span><strong>Redis Sorted Set：</strong>呢個係 Redis 最強嘅資料結構之一。每個玩家係一個 member，分數係 score。自動按分數排序，查詢 Top 100 只係 O(log N)。ZREVRANGE 攞排名，ZRANK 查個人位置，全部都係超快操作。</span></li>
          <li><span class="step-num">4</span><span><strong>Postgres 持久化：</strong>同時將用戶資料、遊戲歷史寫入 Postgres。如果 Redis crash，可以從 Postgres 重建排行榜。Postgres 負責長期儲存，Redis 負責即時查詢。完美分工。</span></li>
        </ol>

        <div class="use-case">
          <h4>WebSocket 即時推送</h4>
          <p>當排行榜更新，Backend 通過 WebSocket 推送新排名俾所有在線玩家。呢個比傳統嘅 HTTP polling 快好多，而且減少咗大量無謂嘅請求。配合 Redis 嘅微秒級查詢，玩家可以見到真正嘅即時更新。</p>
        </div>

        <div class="use-case">
          <h4>組合策略嘅核心原則</h4>
          <p>Redis 做熱數據快取（排行榜、Session），Postgres 做冷數據持久化（用戶資料、歷史記錄）。呢個係最經典嘅組合。Redis 俾你速度，Postgres 俾你可靠性。兩個一齊用，先係完整嘅方案。</p>
        </div>

        <div class="highlight-box">
          <p>記住：Redis 唔係萬能，但喺需要極低延遲嘅場景（排行榜、Session、Cache、Real-time Analytics），佢係無可取代嘅。配合傳統資料庫使用，先係正確嘅姿勢。</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    const tabs = document.querySelectorAll('.tab-btn');
    const contents = document.querySelectorAll('.tab-content');
    tabs.forEach(tab => { tab.addEventListener('click', () => { tabs.forEach(t => t.classList.remove('active')); contents.forEach(c => c.classList.remove('active')); tab.classList.add('active'); document.getElementById(tab.dataset.tab)?.classList.add('active'); }); });
  </script>
</body>
</html>
