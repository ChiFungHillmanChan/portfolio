<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é»æ¨£ Debug æ…¢å˜… Database â€” ç³»çµ±æ¶æ§‹åœ–è§£</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang HK", "Microsoft JhengHei", sans-serif; background: #0f1117; color: #e0e0e0; min-height: 100vh; }
    .container { max-width: 960px; margin: 0 auto; padding: 40px 24px; }
    header { text-align: center; margin-bottom: 40px; }
    header h1 { font-size: 2rem; font-weight: 700; color: #ffffff; margin-bottom: 8px; }
    header p { font-size: 1rem; color: #9ca3af; line-height: 1.6; }
    .card { background: #1a1d27; border-radius: 16px; padding: 32px; margin-bottom: 24px; border: 1px solid #2a2d3a; }
    .card h2 { font-size: 1.5rem; color: #ffffff; margin-bottom: 8px; }
    .card .subtitle { font-size: 0.95rem; color: #6366f1; font-weight: 500; margin-bottom: 16px; }
    .card h3 { color: #ffffff; font-size: 1.1rem; margin: 20px 0 12px; }
    .card p { font-size: 0.95rem; color: #c0c4cc; line-height: 1.8; margin-bottom: 12px; }
    .diagram-container { background: #13151c; border-radius: 12px; padding: 24px; margin: 24px 0; overflow-x: auto; border: 1px solid #2a2d3a; }
    .diagram-container svg { display: block; margin: 0 auto; max-width: 100%; height: auto; }
    .steps { list-style: none; padding: 0; margin: 16px 0; }
    .steps li { display: flex; align-items: flex-start; gap: 12px; padding: 12px 0; border-bottom: 1px solid #2a2d3a; font-size: 0.95rem; color: #c0c4cc; line-height: 1.6; }
    .steps li:last-child { border-bottom: none; }
    .step-num { flex-shrink: 0; width: 28px; height: 28px; border-radius: 50%; background: #6366f1; color: #fff; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; font-weight: 700; }
    .key-points { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px; }
    @media (max-width: 600px) { .key-points { grid-template-columns: 1fr; } .container { padding: 24px 16px; } header h1 { font-size: 1.5rem; } .card { padding: 20px; } .tabs { flex-wrap: nowrap; } .tab-btn { font-size: 0.8rem; padding: 10px 12px; } }
    .key-point { background: #13151c; border-radius: 10px; padding: 16px; border-left: 3px solid #6366f1; }
    .key-point h4 { color: #a5b4fc; font-size: 0.9rem; margin-bottom: 6px; }
    .key-point p { font-size: 0.85rem; color: #c0c4cc; margin-bottom: 0; line-height: 1.6; }
    .use-case { background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05)); border-left: 3px solid #6366f1; border-radius: 0 10px 10px 0; padding: 16px 20px; margin-top: 16px; }
    .use-case h4 { color: #a5b4fc; font-size: 0.9rem; margin-bottom: 6px; }
    .use-case p { font-size: 0.9rem; color: #c0c4cc; margin-bottom: 0; }
    .tabs { display: flex; gap: 4px; background: #1a1d27; border-radius: 12px; padding: 4px; margin-bottom: 24px; overflow-x: auto; }
    .tab-btn { flex: 1; padding: 12px 16px; border: none; background: transparent; color: #9ca3af; font-size: 0.9rem; font-weight: 500; border-radius: 8px; cursor: pointer; transition: all 0.25s ease; white-space: nowrap; font-family: inherit; }
    .tab-btn:hover { color: #e0e0e0; background: rgba(255, 255, 255, 0.05); }
    .tab-btn.active { background: #6366f1; color: #ffffff; font-weight: 600; }
    .tab-content { display: none; animation: fadeIn 0.3s ease; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    /* AI Viber */
    .prompt-card { background: #13151c; border-radius: 12px; padding: 20px; margin-bottom: 16px; border: 1px solid #2a2d3a; }
    .prompt-card h4 { color: #a5b4fc; font-size: 0.95rem; margin-bottom: 12px; }
    .prompt-text { background: #0a0b10; border-radius: 8px; padding: 16px; font-size: 0.85rem; color: #c0c4cc; line-height: 1.8; white-space: pre-wrap; word-break: break-word; border: 1px solid #2a2d3a; position: relative; }
    .prompt-text .placeholder { color: #fbbf24; font-weight: 600; }
    .copy-btn { margin-top: 10px; padding: 8px 16px; background: #6366f1; color: #fff; border: none; border-radius: 8px; font-size: 0.8rem; cursor: pointer; font-family: inherit; transition: all 0.2s ease; }
    .copy-btn:hover { background: #4f46e5; }
    .copy-btn.copied { background: #10B981; }
    .flow-step { background: #13151c; border-radius: 12px; padding: 20px; margin-bottom: 16px; border: 1px solid #2a2d3a; position: relative; }
    .flow-step .flow-number { position: absolute; top: -12px; left: 20px; background: #6366f1; color: #fff; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; }
    .flow-step h4 { color: #ffffff; font-size: 1rem; margin-bottom: 8px; padding-left: 4px; }
    .flow-step p { font-size: 0.9rem; color: #c0c4cc; line-height: 1.7; margin-bottom: 0; }
    .flow-step .tag { display: inline-block; background: rgba(99, 102, 241, 0.15); color: #a5b4fc; font-size: 0.75rem; padding: 2px 8px; border-radius: 4px; margin-right: 6px; margin-bottom: 6px; }
    .flow-step .tag.green { background: rgba(34, 197, 94, 0.15); color: #34d399; }
    .flow-step .tag.yellow { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
    .flow-step .tag.red { background: rgba(239, 68, 68, 0.15); color: #f87171; }
    .flow-connector { text-align: center; color: #4b5563; font-size: 1.2rem; margin: -4px 0; }
    .code-block { background: #0d0f14; border: 1px solid #2a2d3a; border-radius: 8px; padding: 14px 16px; margin: 12px 0; font-family: 'SF Mono', 'Fira Code', monospace; font-size: 0.82rem; color: #a5b4fc; line-height: 1.7; overflow-x: auto; white-space: pre; }
    .code-comment { color: #4b5563; }
  
    .related-topics { margin-top: 32px; }
    .related-topics h3 { color: #ffffff; font-size: 1.1rem; margin-bottom: 14px; }
    .related-links { display: flex; flex-wrap: wrap; gap: 10px; }
    .related-link { display: inline-block; padding: 8px 16px; background: #13151c; border: 1px solid #2a2d3a; border-radius: 20px; color: #a5b4fc; font-size: 0.85rem; text-decoration: none; transition: all 0.2s ease; }
    .related-link:hover { background: #6366f1; color: #ffffff; border-color: #6366f1; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸŒ é»æ¨£ Debug æ…¢å˜… Database</h1>
      <p>é¢è©¦å¿…å•å˜…ç¶“å…¸é¡Œï¼šä¸€æ­¥æ­¥æ’æŸ¥è³‡æ–™åº«æ•ˆèƒ½å•é¡Œ</p>
    </header>

    <div class="tabs">
      <button class="tab-btn active" data-tab="overview">â‘  æ’æŸ¥æµç¨‹</button>
      <button class="tab-btn" data-tab="detail">â‘¡ é€æ­¥æ‹†è§£</button>
      <button class="tab-btn" data-tab="practice">â‘¢ å¯¦æˆ°æŠ€å·§</button>
      <button class="tab-btn" data-tab="ai-viber">â‘£ AI Viber</button>
    </div>

    <!-- ===================== TAB 1: Overview ===================== -->
    <div class="tab-content active" id="overview">
      <div class="card">
        <h2>é¢è©¦ç¶“å…¸ï¼šã€ŒDatabase å¥½æ…¢ï¼Œæœƒé»åšï¼Ÿã€</h2>
        <div class="subtitle">é‡é»ä¿‚ç³»çµ±æ€§æ€ç¶­â€”â€”å””ä¿‚äº‚è©¦ï¼Œè€Œä¿‚æœ‰æ­¥é©Ÿå’æ’æŸ¥</div>
        <p>
          å¥½å¤šæ–°æ‰‹ä¸€è½åˆ°ã€ŒDatabase æ…¢ã€å°±å³åˆ»è©±ã€ŒåŠ  Cacheï¼åŠ  Indexï¼ã€â€”â€”ä½†å‘¢å€‹ä¿‚éŒ¯å˜…ã€‚æ­£ç¢ºåšæ³•ä¿‚ç”±æ·ºå…¥æ·±ï¼Œä¸€æ­¥æ­¥æ’æŸ¥ï¼Œæµåˆ°çœŸæ­£å˜…æ¨½é ¸ä½å…ˆè‡³å‡ºæ‰‹ã€‚ä»¥ä¸‹ä¿‚ä¸€å€‹å®Œæ•´å˜… Debug æµç¨‹ï¼Œè·Ÿä½å‘¢å€‹æ¡†æ¶åšŸç­”ï¼Œé¢è©¦å®˜ä¸€å®šæœƒä¿¾é«˜åˆ†ã€‚
        </p>

        <div class="diagram-container">
          <svg viewBox="0 0 800 520" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <filter id="shadow" x="-4%" y="-4%" width="108%" height="108%">
                <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
              </filter>
              <filter id="glowIndigo">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#6366f1" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <filter id="glowPurple">
                <feGaussianBlur stdDeviation="5" result="blur"/>
                <feFlood flood-color="#8B5CF6" flood-opacity="0.25"/>
                <feComposite in2="blur" operator="in"/>
                <feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>
              </filter>
              <linearGradient id="gradS1" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#252040"/>
              </linearGradient>
              <linearGradient id="gradS2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a2520"/>
              </linearGradient>
              <linearGradient id="gradS3" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#1e2e25"/>
              </linearGradient>
              <linearGradient id="gradS4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#2a1e22"/>
              </linearGradient>
              <linearGradient id="gradS5" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#1e293b"/>
                <stop offset="100%" stop-color="#251e35"/>
              </linearGradient>
              <marker id="arrDown" markerWidth="8" markerHeight="8" refX="4" refY="7" orient="auto">
                <path d="M0,0 L4,8 L8,0 Z" fill="#6366f1"/>
              </marker>
              <marker id="arrDownGreen" markerWidth="8" markerHeight="8" refX="4" refY="7" orient="auto">
                <path d="M0,0 L4,8 L8,0 Z" fill="#34d399"/>
              </marker>
              <marker id="arrRight" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto">
                <path d="M0,0 L8,4 L0,8 Z" fill="#34d399"/>
              </marker>
            </defs>

            <!-- Step 1: Collect Data -->
            <g transform="translate(250,20)" filter="url(#glowIndigo)">
              <rect width="300" height="60" rx="14" fill="url(#gradS1)" stroke="#6366f1" stroke-width="2" filter="url(#shadow)"/>
              <text x="150" y="24" text-anchor="middle" fill="#6366f1" font-size="13" font-weight="700">â‘  æ”¶é›†æ•¸æ“š</text>
              <text x="150" y="44" text-anchor="middle" fill="#9ca3af" font-size="11">é‚Šå•² Query æ…¢ï¼Ÿå¹¾æ…¢ï¼Ÿè² è¼‰é«˜å…ˆæ…¢å®šä¸€ç›´æ…¢ï¼Ÿ</text>
            </g>
            <line x1="400" y1="82" x2="400" y2="108" stroke="#6366f1" stroke-width="2" marker-end="url(#arrDown)"/>

            <!-- Step 2: Inspect Queries -->
            <g transform="translate(250,110)">
              <rect width="300" height="60" rx="14" fill="url(#gradS2)" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
              <text x="150" y="24" text-anchor="middle" fill="#f59e0b" font-size="13" font-weight="700">â‘¡ æª¢æŸ¥å…·é«” Query</text>
              <text x="150" y="44" text-anchor="middle" fill="#9ca3af" font-size="11">ä½¢æœ‰å†‡åšå¤šé¤˜å˜…å˜¢ï¼Ÿæœ‰å†‡æ›´å¥½å˜…å¯«æ³•ï¼Ÿ</text>
            </g>
            <line x1="400" y1="172" x2="400" y2="198" stroke="#6366f1" stroke-width="2" marker-end="url(#arrDown)"/>

            <!-- Step 3: Indexes / Schema -->
            <g transform="translate(250,200)">
              <rect width="300" height="60" rx="14" fill="url(#gradS3)" stroke="#10B981" stroke-width="2" filter="url(#shadow)"/>
              <text x="150" y="24" text-anchor="middle" fill="#10B981" font-size="13" font-weight="700">â‘¢ åŠ  Index / èª¿æ•´ Schema</text>
              <text x="150" y="44" text-anchor="middle" fill="#9ca3af" font-size="11">è³‡æ–™åº«çµæ§‹æœ‰å†‡é…åˆå¸¸è¦‹å˜…æŸ¥è©¢æ¨¡å¼ï¼Ÿ</text>
            </g>
            <line x1="400" y1="262" x2="400" y2="288" stroke="#6366f1" stroke-width="2" marker-end="url(#arrDown)"/>

            <!-- Step 4: Cache -->
            <g transform="translate(250,290)">
              <rect width="300" height="60" rx="14" fill="url(#gradS4)" stroke="#EF4444" stroke-width="2" filter="url(#shadow)"/>
              <text x="150" y="24" text-anchor="middle" fill="#EF4444" font-size="13" font-weight="700">â‘£ å¼•å…¥ Cache</text>
              <text x="150" y="44" text-anchor="middle" fill="#9ca3af" font-size="11">é‡è¤‡åˆè¨ˆç®—é‡å¤§å˜… Queryï¼ŸCache è¿”å€‹çµæœ</text>
            </g>
            <line x1="400" y1="352" x2="400" y2="378" stroke="#6366f1" stroke-width="2" marker-end="url(#arrDown)"/>

            <!-- Step 5: Change DB -->
            <g transform="translate(250,380)" filter="url(#glowPurple)">
              <rect width="300" height="60" rx="14" fill="url(#gradS5)" stroke="#8B5CF6" stroke-width="2" filter="url(#shadow)"/>
              <text x="150" y="24" text-anchor="middle" fill="#8B5CF6" font-size="13" font-weight="700">â‘¤ è€ƒæ…®æ› Database</text>
              <text x="150" y="44" text-anchor="middle" fill="#9ca3af" font-size="11">ä¿‚å’ªç”¨éŒ¯å’— DB é¡å‹ï¼Ÿæœ‰å†‡æ›´é©åˆå˜…æ–¹æ¡ˆï¼Ÿ</text>
            </g>

            <!-- "å•é¡Œè§£æ±º" arrows on the right â€” curved -->
            <g transform="translate(570,45)">
              <rect width="140" height="36" rx="10" fill="rgba(52,211,153,0.1)" stroke="#34d399" stroke-width="1"/>
              <text x="70" y="23" text-anchor="middle" fill="#34d399" font-size="11" font-weight="600">æµåˆ°å•é¡Œï¼Ÿä¿®å¥½æ”¶å·¥ï¼</text>
            </g>
            <path d="M 552 50 Q 560 55 568 60" fill="none" stroke="#34d399" stroke-width="1.5" marker-end="url(#arrRight)"/>

            <g transform="translate(570,135)">
              <rect width="140" height="36" rx="10" fill="rgba(52,211,153,0.1)" stroke="#34d399" stroke-width="1"/>
              <text x="70" y="23" text-anchor="middle" fill="#34d399" font-size="11" font-weight="600">æµåˆ°å•é¡Œï¼Ÿä¿®å¥½æ”¶å·¥ï¼</text>
            </g>
            <path d="M 552 140 Q 560 145 568 150" fill="none" stroke="#34d399" stroke-width="1.5" marker-end="url(#arrRight)"/>

            <g transform="translate(570,225)">
              <rect width="140" height="36" rx="10" fill="rgba(52,211,153,0.1)" stroke="#34d399" stroke-width="1"/>
              <text x="70" y="23" text-anchor="middle" fill="#34d399" font-size="11" font-weight="600">æµåˆ°å•é¡Œï¼Ÿä¿®å¥½æ”¶å·¥ï¼</text>
            </g>
            <path d="M 552 230 Q 560 235 568 240" fill="none" stroke="#34d399" stroke-width="1.5" marker-end="url(#arrRight)"/>

            <!-- Left labels -->
            <text x="230" y="55" text-anchor="end" fill="#4b5563" font-size="10">æœ€å¸¸è¦‹</text>
            <text x="230" y="415" text-anchor="end" fill="#4b5563" font-size="10">æœ€æ¥µç«¯</text>
            <line x1="235" y1="65" x2="235" y2="400" stroke="#2a2d3a" stroke-width="1" stroke-dasharray="4,4"/>
          </svg>
        </div>

        <div class="use-case">
          <h4>ğŸ’¡ é¢è©¦æ ¸å¿ƒè¦é»</h4>
          <p>é¢è©¦å®˜æƒ³ç‡å˜…ä¿‚<strong>ç³»çµ±æ€§æ€ç¶­</strong>â€”â€”å””ä¿‚ä¸€ä¸ŠåšŸå°±è¬›ã€ŒåŠ  Cacheã€æˆ–è€…ã€Œæ› DBã€ã€‚å‘¢å€‹æµç¨‹ç”±ä¸Šåˆ°ä¸‹ï¼Œæˆæœ¬è¶ŠåšŸè¶Šé«˜ï¼Œæ”¹å‹•è¶ŠåšŸè¶Šå¤§ã€‚é—œéµåœ¨æ–¼å±•ç¤ºæœƒç”±æœ€ç°¡å–®ã€æœ€å¸¸è¦‹å˜…åŸå› é–‹å§‹æ’æŸ¥ï¼Œä¸€æ­¥æ­¥æ·±å…¥åˆ°æ›´è¤‡é›œå˜…è§£æ±ºæ–¹æ¡ˆã€‚å’æ¨£é¢è©¦å®˜å°±çŸ¥é“å‘¢å€‹ä¿‚æœ‰ç¶“é©—å˜…å·¥ç¨‹å¸«æ€ç¶­ã€‚</p>
        </div>
      </div>
    </div>

    <!-- ===================== TAB 2: Detail ===================== -->
    <div class="tab-content" id="detail">
      <div class="card">
        <h2>é€æ­¥æ‹†è§£</h2>
        <div class="subtitle">é€æ­¥æ‹†è§£æ¯ä¸€æ­¥å…·é«”è¦åšå•²å’©ã€é»æ¨£åš</div>

        <div class="flow-step" style="margin-top:20px;">
          <div class="flow-number">1</div>
          <h4>ğŸ“Š æ”¶é›†æ•¸æ“š â€” å…ˆææ¸…æ¥šå•é¡Œ</h4>
          <p>
            å””å¥½ä¸€åšŸå°±æ”¹å˜¢ï¼å…ˆææ¸…æ¥šï¼š<strong style="color:#fbbf24">é‚Šå•² query æ…¢</strong>ã€<strong style="color:#fbbf24">å¹¾æ…¢</strong>ï¼ˆ500msï¼Ÿ5 ç§’ï¼Ÿï¼‰ã€<strong style="color:#fbbf24">å¹¾æ™‚æ…¢</strong>ï¼ˆé«˜å³°æœŸå®šä¸€ç›´éƒ½æ…¢ï¼‰ã€‚å””æ”¶é›†æ•¸æ“šå°±å»æ”¹å˜¢ï¼Œå°±å¥½ä¼¼é†«ç”Ÿå””åšæª¢æŸ¥å°±é–‹è—¥å’å±éšªã€‚
          </p>
          <div style="margin-top:10px;">
            <span class="tag">Slow Query Log</span>
            <span class="tag">Query Profiler</span>
            <span class="tag">APM ç›£æ§å·¥å…·</span>
          </div>
          <div class="code-block"><span class="code-comment">-- MySQL: é–‹å•Ÿæ…¢æŸ¥è©¢æ—¥èªŒ</span>
SET GLOBAL slow_query_log = 'ON';
SET GLOBAL long_query_time = 1;  <span class="code-comment">-- è¶…é 1 ç§’å˜… query æœƒè¢«è¨˜éŒ„</span>

<span class="code-comment">-- PostgreSQL: æŸ¥ç‡æœ€æ…¢å˜… query</span>
SELECT query, mean_exec_time, calls
FROM pg_stat_statements
ORDER BY mean_exec_time DESC
LIMIT 10;</div>
          <p style="margin-top:8px;">
            è¦ç•™æ„ï¼šå¦‚æœåªä¿‚å–ºé«˜è² è¼‰æ™‚å…ˆæ…¢ï¼Œå•é¡Œå¯èƒ½ä¿‚è³‡æºä¸è¶³ï¼ˆCPUã€è¨˜æ†¶é«”ã€é€£æ¥æ•¸ï¼‰ï¼Œè€Œå””ä¿‚ query æœ¬èº«å˜…å•é¡Œã€‚å¿…é ˆåˆ†æ¸…æ¥šå‘¢å…©ç¨®æƒ…æ³ã€‚
          </p>
        </div>

        <div class="flow-connector">â†“</div>

        <div class="flow-step">
          <div class="flow-number">2</div>
          <h4>ğŸ” æª¢æŸ¥å…·é«” Query â€” ä½¢åšç·Šå•²å’©ï¼Ÿ</h4>
          <p>
            ç”¨ <strong style="color:#fbbf24">EXPLAIN</strong> ç‡ä¸€ä¸‹ query å˜…åŸ·è¡Œè¨ˆåŠƒã€‚ä½¢æœ‰å†‡åš full table scanï¼ˆæˆå€‹è¡¨æƒä¸€æ¬¡ï¼‰ï¼Ÿæœ‰å†‡åšå•²å””å¿…è¦å˜… JOINï¼Ÿæœ‰å†‡ SELECT * æ”æ™’æ‰€æœ‰ columnï¼Œä½†å…¶å¯¦åªéœ€è¦å…©ä¸‰å€‹ï¼Ÿå¿…é ˆå­¸è­˜ç”¨ EXPLAINï¼Œå‘¢å€‹ä¿‚ debug å˜…æœ€å¼·æ­¦å™¨ã€‚
          </p>
          <div class="code-block"><span class="code-comment">-- ç”¨ EXPLAIN åˆ†æ query é»æ¨£è·‘</span>
EXPLAIN ANALYZE
SELECT u.name, o.total
FROM users u
JOIN orders o ON u.id = o.user_id
WHERE u.created_at > '2024-01-01';

<span class="code-comment">-- ç•™æ„ï¼šSeq Scan = å†‡ç”¨ Indexï¼Œå¯èƒ½å¥½æ…¢ï¼</span>
<span class="code-comment">-- ç•™æ„ï¼šNested Loop = å¯èƒ½æœ‰ N+1 å•é¡Œ</span></div>
          <div style="margin-top:10px;">
            <span class="tag red">SELECT *ï¼ˆæ”å¤ªå¤šå˜¢ï¼‰</span>
            <span class="tag red">N+1 Query å•é¡Œ</span>
            <span class="tag red">Full Table Scan</span>
          </div>
          <p style="margin-top:8px;">
            å¥½å¤šæ™‚å€™ï¼Œå•é¡Œå°±ä¿‚ query å¯«å¾—å””å¥½ã€‚ä¾‹å¦‚ç”¨ ORM å˜…æ™‚å€™ï¼Œå””çŸ¥ä¸è¦ºåšå’— N+1 queryï¼ˆä¸€æ¢ query æ” 100 å€‹ userï¼Œç„¶å¾Œé€å€‹ user å†ç™¼ä¸€æ¢ query æ” orderâ€”â€”å³ä¿‚ 101 æ¢ queryï¼Œä½†å…¶å¯¦ä¸€æ¢ JOIN å°±ææ‚ï¼‰ã€‚è¦ç‰¹åˆ¥ç•™æ„å‘¢å€‹é™·é˜±ã€‚
          </p>
        </div>

        <div class="flow-connector">â†“</div>

        <div class="flow-step">
          <div class="flow-number">3</div>
          <h4>ğŸ—‚ åŠ  Index / èª¿æ•´ Schema</h4>
          <p>
            å¦‚æœ query æœ¬èº«å¯«å¾—å†‡å•é¡Œï¼Œä½†ä»ç„¶æ…¢ï¼Œå°±è¦ç‡ä¸‹ Database å˜…çµæ§‹æœ‰å†‡é…åˆå¸¸è¦‹å˜…æŸ¥è©¢æ¨¡å¼ã€‚æœ€å¸¸è¦‹å˜…åšæ³•å°±ä¿‚<strong style="color:#34d399">åŠ  Index</strong>ã€‚é‡é»ä¿‚ï¼šIndex å°±ä¿‚è³‡æ–™åº«å˜…ã€Œç›®éŒ„ã€ã€‚
          </p>
          <div class="code-block"><span class="code-comment">-- å¹«ç¶“å¸¸è¢« WHERE åŒ JOIN ç”¨åˆ°å˜… column åŠ  Index</span>
CREATE INDEX idx_users_created_at ON users(created_at);
CREATE INDEX idx_orders_user_id ON orders(user_id);

<span class="code-comment">-- Composite Indexï¼šå¦‚æœæˆæ—¥ä¸€é½ŠæŸ¥</span>
CREATE INDEX idx_orders_user_date ON orders(user_id, created_at);</div>
          <div style="margin-top:10px;">
            <span class="tag green">åŠ  Index</span>
            <span class="tag green">Composite Index</span>
            <span class="tag yellow">Denormalization</span>
            <span class="tag yellow">Partitioning</span>
          </div>
          <p style="margin-top:8px;">
            å†é€²ä¸€æ­¥ï¼šå¯ä»¥è€ƒæ…® <strong>Denormalization</strong>ï¼ˆæ•…æ„åŠ å†—é¤˜æ¬„ä½ï¼Œæ¸›å°‘ JOINï¼‰æˆ–è€… <strong>Table Partitioning</strong>ï¼ˆå°‡ä¸€å€‹è¶…å¤§å˜… table æ‹†æˆå¹¾å€‹ç´°å˜…ï¼‰ã€‚ä½†è¦ç•™æ„ï¼Œå‘¢å•²éƒ½ä¿‚ trade-offâ€”â€”åŠ é€Ÿè®€å–å˜…åŒæ™‚ï¼Œå¯«å…¥å¯èƒ½æœƒæ…¢å•²ã€‚
          </p>
        </div>

        <div class="flow-connector">â†“</div>

        <div class="flow-step">
          <div class="flow-number">4</div>
          <h4>âš¡ å¼•å…¥ Cache</h4>
          <p>
            å¦‚æœæœ‰å•² query å¥½é‡è¤‡åˆå¥½è€—è³‡æºï¼ˆä¾‹å¦‚æ¯å€‹ç”¨æˆ¶éƒ½æœƒè§¸ç™¼å˜… dashboard çµ±è¨ˆ queryï¼‰ï¼Œå»ºè­°å–º Database åŒ Server ä¹‹é–“åŠ ä¸€å±¤ <strong style="color:#EF4444">Cacheï¼ˆä¾‹å¦‚ Redisï¼‰</strong>ã€‚ç¬¬ä¸€æ¬¡æŸ¥å®Œå°±å­˜è½ Cacheï¼Œä¹‹å¾Œç›´æ¥å¾ Cache è¿”å›ï¼Œå””ä½¿å†æ‰“ Databaseã€‚
          </p>
          <p>
            ä½†è¦æ³¨æ„ï¼šå¦‚æœæ¯æ¬¡ query éƒ½å””åŒï¼ˆå””é‡è¤‡ï¼‰ï¼ŒCache å°±å†‡ç”¨ã€‚Cache åªé©åˆ<strong>è®€å¤šå¯«å°‘ã€çµæœå¯ä»¥é‡ç”¨</strong>å˜…å ´æ™¯ã€‚å””å¥½ä¹œéƒ½ç”¨ Cache åšŸè§£æ±ºã€‚
          </p>
        </div>

        <div class="flow-connector">â†“</div>

        <div class="flow-step">
          <div class="flow-number">5</div>
          <h4>ğŸ”„ è€ƒæ…®æ› Database</h4>
          <p>
            å¦‚æœä»¥ä¸Šå…¨éƒ¨éƒ½è©¦éä»²ä¿‚æ…¢ï¼Œå¯èƒ½æ ¹æœ¬ç”¨éŒ¯å’— Database é¡å‹ã€‚å””åŒå˜… Database æ“…é•·åšå””åŒå˜…å˜¢ï¼Œè¦æ€å•±å·¥å…·ï¼š
          </p>
          <div style="margin-top:10px;">
            <span class="tag">PostgreSQL â€” è¤‡é›œ queryã€äº‹å‹™</span>
            <span class="tag">Elasticsearch â€” å…¨æ–‡æœç´¢ã€æ¨¡ç³Šæœç´¢</span>
            <span class="tag">Redis â€” Key-Value å¿«é€Ÿè®€å¯«</span>
            <span class="tag">ClickHouse â€” å¤§æ•¸æ“šåˆ†æ</span>
            <span class="tag">MongoDB â€” éˆæ´»å˜… document çµæ§‹</span>
          </div>
          <p style="margin-top:8px;">
            èˆ‰å€‹ä¾‹å­ï¼šç”¨ PostgreSQL åš fuzzy searchï¼ˆæ¨¡ç³Šæœç´¢ï¼‰ï¼ŒæŠ€è¡“ä¸Šè¡Œå¾—é€šï¼Œä½†æ›æˆ <strong style="color:#34d399">Elasticsearch</strong> å¯ä»¥å¿«å¹¾åå€ã€‚æ ¸å¿ƒåŸå‰‡å°±ä¿‚ï¼šé¸å•±å·¥å…·æ¯”ç¡¬å„ªåŒ–é‡è¦å¥½å¤šã€‚
          </p>
        </div>
      </div>
    </div>

    <!-- ===================== TAB 3: Practice ===================== -->
    <div class="tab-content" id="practice">
      <div class="card">
        <h2>å¯¦æˆ°æŠ€å·§</h2>
        <div class="subtitle">é¢è©¦åŒçœŸå¯¦é–‹ç™¼éƒ½ç”¨å¾—è‘—å˜… tips</div>

        <div class="key-points">
          <div class="key-point">
            <h4>ğŸ“‹ EXPLAIN ä¿‚æœ€å¥½å˜…æœ‹å‹</h4>
            <p>ä»»ä½•æ™‚å€™è¦ºå¾— query æ…¢ï¼Œç¬¬ä¸€æ­¥å°±ä¿‚ EXPLAINã€‚ä½¢æœƒå‘Šè¨´ Database ç”¨å’—å’© Indexã€åšå’—å¹¾å¤šæ¬¡æƒæã€é è¨ˆè™•ç†å¹¾å¤šè¡Œã€‚å‘¢å•²è³‡è¨Šä¿‚ debug å˜…åŸºç¤ï¼Œä¸€å®šè¦ç†Ÿç·´ã€‚</p>
          </div>
          <div class="key-point">
            <h4>ğŸš« é¿å… SELECT *</h4>
            <p>å””å¥½ç¿’æ…£æ€§å¯« SELECT *ã€‚å¦‚æœåªéœ€è¦ name åŒ emailï¼Œå°±å¯« SELECT name, emailã€‚å°‘æ”å˜… data å°‘å’— I/Oï¼Œè‡ªç„¶å°±å¿«å•²ã€‚å‘¢å€‹ä¿‚æœ€ç°¡å–®ä½†æœ€æœ‰æ•ˆå˜…ç¿’æ…£ã€‚</p>
          </div>
          <div class="key-point">
            <h4>âš ï¸ N+1 Query å•é¡Œ</h4>
            <p>ç”¨ ORMï¼ˆä¾‹å¦‚ Prismaã€Sequelizeï¼‰å˜…æ™‚å€™ç‰¹åˆ¥å®¹æ˜“ä¸­æ‹›ã€‚ä¸€å€‹ loop å…¥é¢æ¯æ¬¡éƒ½ç™¼ä¸€æ¢ queryâ€”â€”æ‡‰è©²ç”¨ JOIN æˆ–è€… batch query å–ä»£ã€‚å‘¢å€‹ä¿‚æœ€å¸¸è¦‹å˜…æ•ˆèƒ½æ®ºæ‰‹ã€‚</p>
          </div>
          <div class="key-point">
            <h4>ğŸ“Š æ…¢ Query ç›£æ§</h4>
            <p>ç”Ÿç”¢ç’°å¢ƒä¸€å®šè¦é–‹ slow query logã€‚è¨­å®š thresholdï¼ˆä¾‹å¦‚ 500msï¼‰ï¼Œå®šæœŸ review æœ€æ…¢å˜… queryã€‚å””å¥½ç­‰ç”¨æˆ¶æŠ•è¨´å…ˆè‡³å»æŸ¥ï¼Œä¸»å‹•ç›£æ§å…ˆä¿‚å°ˆæ¥­å˜…åšæ³•ã€‚</p>
          </div>
          <div class="key-point">
            <h4>ğŸ”¢ Index å””ä¿‚è¬èƒ½</h4>
            <p>è¦æ³¨æ„ï¼ŒåŠ å¤ªå¤š Index æœƒæ‹–æ…¢å¯«å…¥é€Ÿåº¦ï¼ˆæ¯æ¬¡ INSERT / UPDATE éƒ½è¦æ›´æ–° Indexï¼‰ã€‚åªå–ºç¶“å¸¸è¢«æŸ¥è©¢å˜… column åŠ  Indexï¼Œå””å¥½äº‚åŠ ã€‚å¿…é ˆæœ‰å–æ¨å˜…æ€ç¶­ã€‚</p>
          </div>
          <div class="key-point">
            <h4>ğŸ”Œ é€£æ¥æ± ï¼ˆConnection Poolï¼‰</h4>
            <p>å¦‚æœå•é¡Œä¿‚ã€Œå¥½å¤š query ç­‰ç·Šé€£æ¥ã€è€Œå””ä¿‚ã€Œquery æœ¬èº«æ…¢ã€ï¼Œå°±è¦ç‡ä¸‹ connection pool ä¿‚å’ªå¤ªç´°ã€‚èª¿å¤§ pool size æˆ–è€…ç”¨ PgBouncer å‘¢é¡ poolerï¼Œå¥½å¤šæ™‚å€™å°±ææ‚ã€‚</p>
          </div>
        </div>

        <div class="use-case" style="margin-top:24px;">
          <h4>ğŸ’¡ é¢è©¦ç­”é¡Œæ¡†æ¶</h4>
          <p>
            é¢è©¦å˜…æ™‚å€™ï¼Œè·Ÿä½å‘¢å€‹é †åºç­”å°±å””æœƒéŒ¯ï¼š<br>
            <strong style="color:#6366f1">â‘  æ”¶é›†æ•¸æ“š</strong> â†’ <strong style="color:#f59e0b">â‘¡ æª¢æŸ¥ Query</strong> â†’ <strong style="color:#10B981">â‘¢ åŠ  Index / èª¿ Schema</strong> â†’ <strong style="color:#EF4444">â‘£ åŠ  Cache</strong> â†’ <strong style="color:#8B5CF6">â‘¤ æ› Database</strong><br><br>
            ç”±æˆæœ¬æœ€ä½ã€æœ€å¸¸è¦‹å˜…åŸå› é–‹å§‹ï¼Œé€æ­¥æ·±å…¥åˆ°æˆæœ¬æœ€é«˜ã€æœ€æ¥µç«¯å˜…æ–¹æ¡ˆã€‚è·Ÿä½å‘¢å€‹æ¡†æ¶ç­”ï¼Œå±•ç¤ºå’—ç³»çµ±æ€§æ€ç¶­ï¼Œé¢è©¦å®˜ä¸€å®šæœƒæ¬£è³ã€‚
          </p>
        </div>
      </div>
    </div>

    <div class="tab-content" id="ai-viber">
      <div class="card">
        <h2>AI Viber</h2>
        <div class="subtitle">è¤‡è£½ Promptï¼Œè²¼å» AI å·¥å…·ï¼Œå³åˆ»é–‹å§‹ Build</div>

        <div class="prompt-card">
          <h4>Prompt 1 â€” è¨ºæ–·åŒä¿®å¾©æ…¢ Query</h4>
          <div class="prompt-text" id="prompt1">å¹«æ‰‹åˆ†æåŒå„ªåŒ–ä»¥ä¸‹æ…¢ Query å˜…æ•ˆèƒ½å•é¡Œã€‚

Databaseï¼š<span class="placeholder">[PostgreSQL / MySQL]</span>
Table çµæ§‹ï¼š
- users è¡¨ï¼šid, name, email, created_atï¼ˆ<span class="placeholder">[100 è¬ / 1000 è¬]</span> è¡Œï¼‰
- orders è¡¨ï¼šid, user_id, total, status, created_atï¼ˆ<span class="placeholder">[500 è¬ / 5000 è¬]</span> è¡Œï¼‰

æ…¢ Queryï¼š
<span class="placeholder">[è²¼ä¸Šéœ€è¦å„ªåŒ–å˜… SQL Query]</span>

è«‹åšä»¥ä¸‹åˆ†æï¼š
1. ç”¨ EXPLAIN ANALYZE è§£è®€åŸ·è¡Œè¨ˆåŠƒï¼ŒæŒ‡å‡ºæ¨½é ¸ä½
2. æª¢æŸ¥æœ‰å†‡ Full Table Scanã€N+1 å•é¡Œã€ä¸å¿…è¦å˜… JOIN
3. å»ºè­°éœ€è¦åŠ å˜… Indexï¼ˆåŒ…æ‹¬ Composite Indexï¼‰
4. æä¾›å„ªåŒ–å¾Œå˜… Query å¯«æ³•
5. å¦‚æœé©ç”¨ï¼Œå»ºè­° Denormalization æˆ– Partitioning ç­–ç•¥
6. ä¼°ç®—å„ªåŒ–å‰å¾Œå˜…åŸ·è¡Œæ™‚é–“å·®ç•°</div>
          <button class="copy-btn" onclick="copyPrompt('prompt1', this)">ğŸ“‹ è¤‡è£½</button>
        </div>

        <div class="prompt-card">
          <h4>Prompt 2 â€” è¨­è¨ˆ Database Indexing ç­–ç•¥</h4>
          <div class="prompt-text" id="prompt2">å¹«æ‰‹ç‚ºä¸€å€‹ <span class="placeholder">[é›»å•†å¹³å° / SaaS æ‡‰ç”¨ / ç¤¾äº¤å¹³å°]</span> è¨­è¨ˆå®Œæ•´å˜… Database Indexing ç­–ç•¥ã€‚

Databaseï¼š<span class="placeholder">[PostgreSQL / MySQL]</span>

ä¸»è¦ Table åŒå¸¸è¦‹ Query Patternï¼š
<span class="placeholder">[æè¿°ä¸»è¦å˜… table çµæ§‹åŒæœ€å¸¸ç”¨å˜…æŸ¥è©¢æ¨¡å¼]</span>

è¦æ±‚ï¼š
1. åˆ†ææ¯å€‹å¸¸ç”¨ Queryï¼Œå»ºè­°æœ€é©åˆå˜… Index é¡å‹ï¼ˆB-Treeã€Hashã€GINã€GiSTï¼‰
2. è¨­è¨ˆ Composite Indexï¼Œè€ƒæ…® column é †åºå°æ•ˆèƒ½å˜…å½±éŸ¿
3. è­˜åˆ¥å””éœ€è¦å˜… Indexï¼ˆé¿å… over-indexing æ‹–æ…¢å¯«å…¥ï¼‰
4. å»ºè­° Partial Index åŒ Covering Index å˜…ä½¿ç”¨å ´æ™¯
5. æä¾› Index ç¶­è­·è¨ˆåŠƒï¼ˆREINDEXã€VACUUM é »ç‡ï¼‰
6. ä¼°ç®—åŠ  Index å¾Œå°è®€å¯«æ•ˆèƒ½å˜…å½±éŸ¿
7. å¯«å‡ºæ‰€æœ‰ CREATE INDEX èªå¥ï¼Œé™„å¸¶è§£é‡‹</div>
          <button class="copy-btn" onclick="copyPrompt('prompt2', this)">ğŸ“‹ è¤‡è£½</button>
        </div>

        <div class="prompt-card">
          <h4>Prompt 3 â€” å»ºç«‹ Database æ•ˆèƒ½ç›£æ§ç³»çµ±</h4>
          <div class="prompt-text" id="prompt3">ç”¨ <span class="placeholder">[Node.js / Python]</span> å»ºç«‹ä¸€å€‹ Database æ•ˆèƒ½ç›£æ§åŒè‡ªå‹•å‘Šè­¦ç³»çµ±ã€‚

ç›£æ§ç›®æ¨™ï¼š<span class="placeholder">[PostgreSQL / MySQL]</span>

åŠŸèƒ½éœ€æ±‚ï¼š
- è‡ªå‹•æ”¶é›† Slow Query Logï¼ˆthreshold: <span class="placeholder">[500ms / 1s]</span>ï¼‰
- å®šæœŸåˆ†æ pg_stat_statements / performance_schema å˜…æ•¸æ“š
- è­˜åˆ¥ Top 10 æœ€æ…¢å˜… Query åŒæœ€é »ç¹å˜… Query
- ç›£æ§ Connection Pool ä½¿ç”¨ç‡
- æª¢æ¸¬ Missing Indexï¼ˆåˆ†æ sequential scan å˜…é »ç‡ï¼‰
- ç•¶å‡ºç¾ç•°å¸¸æ™‚ç™¼é€å‘Šè­¦ï¼ˆSlack / Emailï¼‰
- æä¾›ä¸€å€‹ç°¡å–®å˜… Dashboard UI é¡¯ç¤ºç›£æ§æ•¸æ“š
- åŒ…å«è‡ªå‹•å»ºè­°åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼šã€Œå‘¢å€‹ Query å»ºè­°åŠ  Indexã€ï¼‰</div>
          <button class="copy-btn" onclick="copyPrompt('prompt3', this)">ğŸ“‹ è¤‡è£½</button>
        </div>
      </div>
    </div>

    <div class="related-topics">
      <div class="card">
        <h3>ç›¸é—œèª²é¡Œ</h3>
        <div class="related-links">
        <a href="database-basics.html" class="related-link">Database åŸºç¤</a>
        <a href="pick-database.html" class="related-link">é»æ€ Database</a>
        <a href="scale-reads.html" class="related-link">æ“´å±•è®€å–èƒ½åŠ›</a>
        <a href="metrics-logging.html" class="related-link">Metrics & Logging ç›£æ§æ—¥èªŒ</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    const tabs = document.querySelectorAll('.tab-btn');
    const contents = document.querySelectorAll('.tab-content');
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        const target = document.getElementById(tab.dataset.tab);
        if (target) target.classList.add('active');
      });
    });

    function copyPrompt(id, btn) {
      const text = document.getElementById(id).innerText;
      navigator.clipboard.writeText(text).then(() => {
        btn.textContent = 'âœ… å·²è¤‡è£½';
        btn.classList.add('copied');
        setTimeout(() => { btn.textContent = 'ğŸ“‹ è¤‡è£½'; btn.classList.remove('copied'); }, 2000);
      });
    }
  </script>
</body>
</html>
