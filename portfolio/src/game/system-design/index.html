<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç³»çµ±æ¶æ§‹åœ–è§£æ•™å®¤</title>
  <meta property="og:type" content="website">
  <meta property="og:title" content="ç³»çµ±æ¶æ§‹åœ–è§£æ•™å®¤">
  <meta property="og:description" content="ç”¨å»£æ±è©±ï¼Œè¼•é¬†å­¸ç³»çµ±è¨­è¨ˆã€‚æ¯ä¸€èª²éƒ½æœ‰äº’å‹•åœ–è§£ã€çœŸå¯¦ä¾‹å­ã€‚">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ç³»çµ±æ¶æ§‹åœ–è§£æ•™å®¤">
  <meta name="twitter:description" content="ç”¨å»£æ±è©±ï¼Œè¼•é¬†å­¸ç³»çµ±è¨­è¨ˆã€‚æ¯ä¸€èª²éƒ½æœ‰äº’å‹•åœ–è§£ã€çœŸå¯¦ä¾‹å­ã€‚">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang HK", "Microsoft JhengHei", sans-serif;
      background: #0a0b10;
      color: #e0e0e0;
      height: 100vh;
      overflow: hidden;
    }

    /* ==================== Layout ==================== */
    .app-layout {
      display: flex;
      height: 100vh;
    }

    /* ==================== Sidebar ==================== */
    .sidebar {
      width: 280px;
      min-width: 280px;
      background: #0f1117;
      border-right: 1px solid #1e2030;
      display: flex;
      flex-direction: column;
      height: 100vh;
      transition: transform 0.3s ease;
      z-index: 100;
    }

    .sidebar-header {
      padding: 24px 20px 20px;
      border-bottom: 1px solid #1e2030;
      cursor: pointer;
      transition: background 0.2s ease;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .sidebar-header:hover {
      background: rgba(255, 255, 255, 0.02);
    }

    .sidebar-header-text {
      flex: 1;
      min-width: 0;
    }

    .sidebar-header h1 {
      font-size: 1.15rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 4px;
      letter-spacing: -0.02em;
    }

    .sidebar-header p {
      font-size: 0.78rem;
      color: #6b7280;
      line-height: 1.5;
    }

    /* ==================== Filters ==================== */
    .sidebar-filters {
      padding: 10px 10px 4px;
      border-bottom: 1px solid #1e2030;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .filter-chip {
      padding: 4px 10px;
      border-radius: 100px;
      border: 1px solid #2a2d3a;
      background: transparent;
      color: #6b7280;
      font-size: 0.68rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: inherit;
      white-space: nowrap;
    }

    .filter-chip:hover {
      border-color: #4b5563;
      color: #9ca3af;
    }

    .filter-chip.active {
      background: rgba(99, 102, 241, 0.15);
      border-color: #6366f1;
      color: #a5b4fc;
    }

    .sidebar-nav {
      flex: 1;
      overflow-y: auto;
      padding: 12px 10px;
    }

    .nav-section-title {
      font-size: 0.7rem;
      font-weight: 600;
      color: #4b5563;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      padding: 16px 10px 8px;
    }

    .nav-section-title.hidden,
    .nav-item.hidden {
      display: none;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      background: transparent;
      width: 100%;
      text-align: left;
      font-family: inherit;
      color: #9ca3af;
      font-size: 0.88rem;
      position: relative;
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.04);
      color: #d1d5db;
    }

    .nav-item.active {
      background: rgba(99, 102, 241, 0.12);
      color: #a5b4fc;
    }

    .nav-item.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 3px;
      height: 20px;
      background: #6366f1;
      border-radius: 0 3px 3px 0;
    }

    .nav-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.95rem;
      flex-shrink: 0;
    }

    .nav-item-text {
      display: flex;
      flex-direction: column;
      gap: 1px;
      min-width: 0;
    }

    .nav-item-title {
      font-weight: 500;
      font-size: 0.85rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .nav-item-sub {
      font-size: 0.72rem;
      color: #6b7280;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .nav-item.active .nav-item-sub {
      color: #818cf8;
    }

    /* Topic badge colors */
    .nav-icon.cache { background: rgba(99, 102, 241, 0.15); }
    .nav-icon.placeholder { background: rgba(75, 85, 99, 0.2); }

    .nav-item.coming-soon {
      opacity: 0.45;
      cursor: default;
    }

    .nav-item.coming-soon:hover {
      background: transparent;
      color: #9ca3af;
    }

    .nav-item:focus {
      outline: 1px solid #6366f1;
      outline-offset: -1px;
    }

    .viewed-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #34d399;
      margin-left: auto;
      flex-shrink: 0;
    }

    .sidebar-search {
      padding: 10px 10px 6px;
      border-bottom: 1px solid #1e2030;
    }

    .sidebar-search input {
      width: 100%;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #2a2d3a;
      background: #13151c;
      color: #e0e0e0;
      font-size: 0.82rem;
      font-family: inherit;
      outline: none;
      transition: border-color 0.2s ease;
    }

    .sidebar-search input::placeholder {
      color: #4b5563;
    }

    .sidebar-search input:focus {
      border-color: #6366f1;
    }

    .coming-soon-badge {
      font-size: 0.62rem;
      color: #6b7280;
      background: rgba(75, 85, 99, 0.25);
      padding: 2px 6px;
      border-radius: 4px;
      margin-left: auto;
      flex-shrink: 0;
      white-space: nowrap;
    }

    .sidebar-footer {
      padding: 16px 20px;
      border-top: 1px solid #1e2030;
      font-size: 0.72rem;
      color: #4b5563;
      text-align: center;
    }

    /* ==================== Main Content ==================== */
    .main-content {
      flex: 1;
      overflow: hidden;
      position: relative;
      background: #0f1117;
    }

    .main-content iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: #0f1117;
    }

    /* Welcome screen (when no topic is loaded yet) */
    .welcome-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      text-align: center;
      padding: 40px;
    }

    .welcome-screen.hidden {
      display: none;
    }

    .welcome-icon {
      width: 80px;
      height: 80px;
      border-radius: 20px;
      background: rgba(99, 102, 241, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.2rem;
      margin-bottom: 24px;
    }

    .welcome-screen h2 {
      font-size: 1.5rem;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
    }

    .welcome-screen p {
      font-size: 0.95rem;
      color: #6b7280;
      line-height: 1.7;
      max-width: 400px;
    }

    .welcome-hint {
      margin-top: 32px;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #4b5563;
      font-size: 0.82rem;
    }

    .welcome-hint .arrow {
      font-size: 1.2rem;
    }

    /* ==================== Mobile hamburger ==================== */
    .mobile-header {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 52px;
      background: #0f1117;
      border-bottom: 1px solid #1e2030;
      z-index: 200;
      align-items: center;
      padding: 0 16px;
      gap: 12px;
    }

    .hamburger {
      width: 36px;
      height: 36px;
      border: none;
      background: transparent;
      color: #9ca3af;
      font-size: 1.3rem;
      cursor: pointer;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .hamburger:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .mobile-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: #fff;
    }

    .overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 99;
    }

    .overlay.visible {
      display: block;
    }

    /* ==================== Responsive ==================== */
    @media (max-width: 768px) {
      .mobile-header {
        display: flex;
      }

      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        transform: translateX(-100%);
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        padding-top: 52px;
      }

      .main-content iframe {
        height: calc(100% - 0px);
      }
    }

    /* Scrollbar */
    .sidebar-nav::-webkit-scrollbar {
      width: 4px;
    }

    .sidebar-nav::-webkit-scrollbar-track {
      background: transparent;
    }

    .sidebar-nav::-webkit-scrollbar-thumb {
      background: #2a2d3a;
      border-radius: 4px;
    }

    /* ==================== Coffee Button ==================== */
    .coffee-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(165, 180, 252, 0.25), rgba(99, 102, 241, 0.15));
      border: 2px solid rgba(99, 102, 241, 0.5);
      box-shadow: 0 6px 16px rgba(99, 102, 241, 0.2);
      color: #a5b4fc;
      font-size: 1.3rem;
      text-decoration: none;
      transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
      flex-shrink: 0;
    }

    .coffee-btn:hover,
    .coffee-btn:focus {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 10px 22px rgba(99, 102, 241, 0.35);
      border-color: rgba(129, 140, 248, 0.8);
      outline: none;
    }

    .coffee-btn:active {
      transform: translateY(0) scale(0.96);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);
    }

    /* ==================== Chat Widget ==================== */
    .chat-fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, #6366f1, #4f46e5);
      border: none;
      color: #fff;
      font-size: 1.5rem;
      cursor: pointer;
      z-index: 300;
      box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .chat-fab:hover {
      transform: scale(1.08);
      box-shadow: 0 6px 28px rgba(99, 102, 241, 0.55);
    }

    .chat-fab.open { display: none; }

    .chat-panel {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 380px;
      height: 540px;
      background: #13151c;
      border: 1px solid #2a2d3a;
      border-radius: 16px;
      z-index: 301;
      display: none;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 12px 48px rgba(0, 0, 0, 0.5);
    }

    .chat-panel.open { display: flex; }

    .chat-panel-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      border-bottom: 1px solid #2a2d3a;
      background: #1a1d27;
    }

    .chat-panel-header span {
      font-size: 0.92rem;
      font-weight: 600;
      color: #e0e0e0;
    }

    .chat-close-btn {
      width: 30px;
      height: 30px;
      border-radius: 8px;
      border: none;
      background: transparent;
      color: #6b7280;
      font-size: 1.1rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .chat-close-btn:hover {
      background: rgba(255, 255, 255, 0.05);
      color: #9ca3af;
    }

    /* ---- Welcome / Login view ---- */
    .chat-welcome {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 16px 18px;
    }

    .chat-welcome-intro {
      text-align: center;
      margin-bottom: 12px;
    }

    .chat-welcome-intro h3 {
      font-size: 0.95rem;
      color: #e0e0e0;
      margin-bottom: 4px;
    }

    .chat-welcome-intro p {
      font-size: 0.72rem;
      color: #6b7280;
      line-height: 1.5;
    }

    .chat-feature-list {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }

    .chat-feature-item {
      flex: 1;
      padding: 10px;
      background: #1a1d27;
      border-radius: 8px;
      border: 1px solid #2a2d3a;
      text-align: center;
    }

    .chat-feature-item .feat-icon {
      font-size: 1.1rem;
      display: block;
      margin-bottom: 4px;
    }

    .chat-feature-item .feat-label {
      font-size: 0.72rem;
      color: #a5b4fc;
      font-weight: 600;
      display: block;
      margin-bottom: 2px;
    }

    .chat-feature-item .feat-desc {
      font-size: 0.65rem;
      color: #6b7280;
      line-height: 1.4;
    }

    .chat-coffee-cta {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
      border: 1px solid rgba(99, 102, 241, 0.25);
      border-radius: 8px;
      margin-bottom: 12px;
      text-decoration: none;
      transition: border-color 0.2s ease;
    }

    .chat-coffee-cta:hover { border-color: rgba(99, 102, 241, 0.5); }

    .chat-coffee-cta .cta-icon { font-size: 1.2rem; flex-shrink: 0; }
    .chat-coffee-cta .cta-text { flex: 1; }

    .chat-coffee-cta .cta-text strong {
      display: block;
      font-size: 0.76rem;
      color: #a5b4fc;
      margin-bottom: 1px;
    }

    .chat-coffee-cta .cta-text span { font-size: 0.68rem; color: #6b7280; }
    .chat-coffee-cta .cta-arrow { color: #6366f1; font-size: 0.9rem; }

    .chat-login-divider {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .chat-login-divider::before,
    .chat-login-divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #2a2d3a;
    }

    .chat-login-divider span {
      font-size: 0.68rem;
      color: #4b5563;
      white-space: nowrap;
    }

    .chat-login-form {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .chat-login-form input {
      width: 100%;
      padding: 9px 12px;
      border-radius: 8px;
      border: 1px solid #2a2d3a;
      background: #0f1117;
      color: #e0e0e0;
      font-size: 0.82rem;
      font-family: inherit;
      outline: none;
      transition: border-color 0.2s ease;
    }

    .chat-login-form input::placeholder { color: #4b5563; }
    .chat-login-form input:focus { border-color: #6366f1; }

    .chat-login-btn {
      width: 100%;
      padding: 9px;
      border-radius: 8px;
      border: none;
      background: #6366f1;
      color: #fff;
      font-size: 0.84rem;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .chat-login-btn:hover { background: #4f46e5; }
    .chat-login-btn:disabled { opacity: 0.5; cursor: not-allowed; }

    .chat-login-error {
      font-size: 0.74rem;
      color: #f87171;
      text-align: center;
      min-height: 1em;
    }

    /* ---- Main view (after login) ---- */
    .chat-main {
      flex: 1;
      display: none;
      flex-direction: column;
    }

    .chat-main.active { display: flex; }

    /* Action buttons */
    .chat-actions {
      display: flex;
      gap: 8px;
      padding: 12px 14px 0;
    }

    .chat-action-btn {
      flex: 1;
      padding: 12px 8px;
      border-radius: 10px;
      border: 1px solid #2a2d3a;
      background: #1a1d27;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: inherit;
      text-align: center;
    }

    .chat-action-btn:hover { border-color: #4b5563; }

    .chat-action-btn.active {
      border-color: #6366f1;
      background: rgba(99, 102, 241, 0.1);
    }

    .chat-action-btn .action-icon {
      font-size: 1.2rem;
      display: block;
      margin-bottom: 4px;
    }

    .chat-action-btn .action-label {
      font-size: 0.76rem;
      font-weight: 600;
      color: #a5b4fc;
      display: block;
    }

    .chat-action-btn .action-desc {
      font-size: 0.65rem;
      color: #6b7280;
      display: block;
      margin-top: 2px;
    }

    /* Chat messages */
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 14px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .chat-messages::-webkit-scrollbar { width: 4px; }
    .chat-messages::-webkit-scrollbar-thumb { background: #2a2d3a; border-radius: 4px; }

    .chat-msg {
      max-width: 90%;
      padding: 10px 14px;
      border-radius: 12px;
      font-size: 0.84rem;
      line-height: 1.6;
      word-break: break-word;
    }

    .chat-msg.user {
      align-self: flex-end;
      background: rgba(99, 102, 241, 0.2);
      color: #c7d2fe;
      border-bottom-right-radius: 4px;
    }

    .chat-msg.bot {
      align-self: flex-start;
      background: #1a1d27;
      color: #d1d5db;
      border-bottom-left-radius: 4px;
    }

    .chat-msg.bot.error { color: #f87171; }

    /* Search result cards */
    .chat-result-card {
      display: block;
      padding: 10px 12px;
      margin-top: 6px;
      background: #0f1117;
      border: 1px solid #2a2d3a;
      border-radius: 8px;
      cursor: pointer;
      transition: border-color 0.2s ease;
      text-decoration: none;
    }

    .chat-result-card:hover { border-color: #6366f1; }

    .chat-result-card .card-title {
      font-size: 0.82rem;
      font-weight: 600;
      color: #a5b4fc;
      margin-bottom: 2px;
    }

    .chat-result-card .card-desc {
      font-size: 0.72rem;
      color: #6b7280;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .chat-result-card .card-cat {
      font-size: 0.65rem;
      color: #4b5563;
      margin-top: 4px;
    }

    .chat-result-card.coming-soon {
      opacity: 0.5;
      cursor: default;
      border-color: #2a2d3a;
    }

    .chat-result-card.coming-soon .card-title::after {
      content: ' (Coming Soon)';
      color: #4b5563;
      font-weight: 400;
      font-size: 0.7rem;
    }

    /* Viber prompt output */
    .chat-viber-output {
      background: #0a0b10;
      border: 1px solid #2a2d3a;
      border-radius: 8px;
      padding: 14px;
      margin-top: 6px;
      font-size: 0.82rem;
      color: #c0c4cc;
      line-height: 1.7;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .chat-copy-btn {
      margin-top: 8px;
      padding: 6px 14px;
      background: #6366f1;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 0.76rem;
      cursor: pointer;
      font-family: inherit;
      transition: background 0.2s ease;
    }

    .chat-copy-btn:hover { background: #4f46e5; }
    .chat-copy-btn.copied { background: #10B981; }

    /* Viber: topic picker step */
    .chat-topic-picker {
      padding: 10px 14px;
      border-bottom: 1px solid #2a2d3a;
    }

    .chat-topic-picker select {
      width: 100%;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #2a2d3a;
      background: #0f1117;
      color: #e0e0e0;
      font-size: 0.82rem;
      font-family: inherit;
      outline: none;
      cursor: pointer;
    }

    .chat-topic-picker select:focus { border-color: #6366f1; }

    .chat-topic-picker label {
      display: block;
      font-size: 0.72rem;
      color: #6b7280;
      margin-bottom: 6px;
    }

    /* Input area */
    .chat-input-area {
      display: flex;
      gap: 8px;
      padding: 12px 14px;
      border-top: 1px solid #2a2d3a;
      background: #1a1d27;
    }

    .chat-input-area textarea {
      flex: 1;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #2a2d3a;
      background: #0f1117;
      color: #e0e0e0;
      font-size: 0.84rem;
      font-family: inherit;
      outline: none;
      resize: none;
      min-height: 38px;
      max-height: 100px;
      line-height: 1.5;
    }

    .chat-input-area textarea::placeholder { color: #4b5563; }
    .chat-input-area textarea:focus { border-color: #6366f1; }

    .chat-send-btn {
      width: 38px;
      height: 38px;
      border-radius: 8px;
      border: none;
      background: #6366f1;
      color: #fff;
      font-size: 1rem;
      cursor: pointer;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s ease;
    }

    .chat-send-btn:hover { background: #4f46e5; }
    .chat-send-btn:disabled { opacity: 0.4; cursor: not-allowed; }

    .chat-typing {
      font-size: 0.78rem;
      color: #6b7280;
      padding: 4px 0;
    }

    @keyframes chatDots {
      0%, 20% { opacity: 0.2; }
      50% { opacity: 1; }
      80%, 100% { opacity: 0.2; }
    }

    .chat-typing span { animation: chatDots 1.4s infinite; }
    .chat-typing span:nth-child(2) { animation-delay: 0.2s; }
    .chat-typing span:nth-child(3) { animation-delay: 0.4s; }

    /* Mobile chat panel */
    @media (max-width: 768px) {
      .chat-fab {
        bottom: 16px;
        right: 16px;
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
      }

      .chat-panel {
        bottom: 0;
        right: 0;
        left: 0;
        width: 100%;
        height: 80vh;
        max-height: 80vh;
        border-radius: 16px 16px 0 0;
        border-bottom: none;
      }

      .chat-welcome {
        padding: 14px 16px;
      }

      .chat-feature-list {
        gap: 6px;
        margin-bottom: 10px;
      }

      .chat-feature-item {
        padding: 8px;
      }

      .chat-actions {
        padding: 10px 12px 0;
      }

      .chat-action-btn {
        padding: 10px 6px;
      }

      .chat-topic-picker {
        padding: 8px 12px;
      }

      .chat-input-area {
        padding: 10px 12px;
      }
    }
  </style>
</head>
<body>

  <!-- Mobile header -->
  <div class="mobile-header">
    <button class="hamburger" id="menuBtn">â˜°</button>
    <span class="mobile-title">ç³»çµ±æ¶æ§‹åœ–è§£æ•™å®¤</span>
  </div>
  <div class="overlay" id="overlay"></div>

  <div class="app-layout">
    <!-- ==================== Sidebar ==================== -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header" id="sidebarHeader">
        <div class="sidebar-header-text">
          <h1>ç³»çµ±æ¶æ§‹åœ–è§£æ•™å®¤</h1>
          <p>è¼•é¬†å­¸ç³»çµ±è¨­è¨ˆ</p>
        </div>
        <a class="coffee-btn" href="https://buymeacoffee.com/hillmanchan709" target="_blank" rel="noopener noreferrer" aria-label="Buy me a coffee" onclick="event.stopPropagation()">â˜•</a>
      </div>

      <div class="sidebar-filters">
        <button class="filter-chip active" data-filter="all">å…¨éƒ¨</button>
        <button class="filter-chip" data-filter="career">é¢è©¦</button>
        <button class="filter-chip" data-filter="engineering">å·¥ç¨‹</button>
        <button class="filter-chip" data-filter="network">ç¶²çµ¡</button>
        <button class="filter-chip" data-filter="storage">å­˜å„²</button>
        <button class="filter-chip" data-filter="cache">å¿«å–</button>
        <button class="filter-chip" data-filter="async">ç•°æ­¥</button>
        <button class="filter-chip" data-filter="app">æ‡‰ç”¨</button>
        <button class="filter-chip" data-filter="security">å®‰å…¨</button>
        <button class="filter-chip" data-filter="deploy">éƒ¨ç½²</button>
        <button class="filter-chip" data-filter="resource">è³‡æº</button>
      </div>

      <div class="sidebar-search">
        <input type="text" id="navSearch" placeholder="æœå°‹èª²é¡Œ..." autocomplete="off">
      </div>

      <nav class="sidebar-nav">
        <!-- ===== è·å ´èˆ‡é¢è©¦ ===== -->
        <div class="nav-section-title" data-section="career">è·å ´èˆ‡é¢è©¦</div>

        <button class="nav-item" data-topic="topics/backend-roadmap.html" data-category="career">
          <span class="nav-icon" style="background:rgba(139,92,246,0.15)">ğŸ—º</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Backend å­¸ç¿’è·¯ç·š</span>
            <span class="nav-item-sub">Java / Linux / DB / API / Cloud</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/junior-vs-senior.html" data-category="career">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">ğŸ“Š</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Junior å®š Senior</span>
            <span class="nav-item-sub">Tasks vs Goals / å‡è·ç­–ç•¥</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/ai-vs-software-engineer.html" data-category="career">
          <span class="nav-icon" style="background:rgba(99,102,241,0.15)">ğŸ¤–</span>
          <span class="nav-item-text">
            <span class="nav-item-title">AI æœƒå–ä»£å·¥ç¨‹å¸«ï¼Ÿ</span>
            <span class="nav-item-sub">å¯« Code å¾ä¾†å””ä¿‚ä¸»è¦å·¥ä½œ</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/interview-process.html" data-category="career">
          <span class="nav-icon" style="background:rgba(59,130,246,0.15)">ğŸ¢</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Big Tech é¢è©¦æµç¨‹</span>
            <span class="nav-item-sub">HR Screen â†’ On-site â†’ Team Match</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/star-method.html" data-category="career">
          <span class="nav-icon" style="background:rgba(251,191,36,0.15)">â­</span>
          <span class="nav-item-text">
            <span class="nav-item-title">STAR é¢è©¦æ³•</span>
            <span class="nav-item-sub">Behavioral Interview ç­”é¡Œæ¡†æ¶</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/coding-interview.html" data-category="career">
          <span class="nav-icon" style="background:rgba(34,197,94,0.15)">ğŸ’»</span>
          <span class="nav-item-text">
            <span class="nav-item-title">ç¨‹å¼é¢è©¦æ”»ç•¥</span>
            <span class="nav-item-sub">é‡æ¸…å•é¡Œ / æºé€š / åˆä½œæ…‹åº¦</span>
          </span>
        </button>

        <!-- ===== å·¥ç¨‹å¯¦è¸ ===== -->
        <div class="nav-section-title" data-section="engineering">å·¥ç¨‹å¯¦è¸</div>

        <button class="nav-item" data-topic="topics/git-vs-github.html" data-category="engineering">
          <span class="nav-icon" style="background:rgba(59,130,246,0.15)">ğŸ”€</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Git vs GitHub</span>
            <span class="nav-item-sub">æœ¬åœ°ç‰ˆæœ¬æ§åˆ¶ vs é›²ç«¯å”ä½œ</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/print-vs-debugger.html" data-category="engineering">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">ğŸ”</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Print å®š Debugger</span>
            <span class="nav-item-sub">Breakpoint / stdout / é»æ¨£æ€</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/docker.html" data-category="engineering">
          <span class="nav-icon" style="background:rgba(59,130,246,0.15)">ğŸ³</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Docker å®¹å™¨åŒ–</span>
            <span class="nav-item-sub">Alpine ç˜¦èº« / .dockerignore / æ“´å±•</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/dependency-injection.html" data-category="engineering">
          <span class="nav-icon" style="background:rgba(99,102,241,0.15)">ğŸ’‰</span>
          <span class="nav-item-text">
            <span class="nav-item-title">ä¾è³´æ³¨å…¥</span>
            <span class="nav-item-sub">è§£è€¦ / Mock æ¸¬è©¦ / Constructor DI</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/system-design-patterns.html" data-category="engineering">
          <span class="nav-icon" style="background:rgba(34,197,94,0.15)">ğŸ§©</span>
          <span class="nav-item-text">
            <span class="nav-item-title">ç³»çµ±è¨­è¨ˆæ¨¡å¼ç¸½è¦½</span>
            <span class="nav-item-sub">æ“´å±• / å¯¦æ™‚ / å¯é æ€§æ¨¡å¼</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/coding-agent-design.html" data-category="engineering">
          <span class="nav-icon" style="background:rgba(139,92,246,0.15)">ğŸ¤–</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Coding Agent è¨­è¨ˆ</span>
            <span class="nav-item-sub">ReAct Loop / Tool Use / Sandbox</span>
          </span>
        </button>

        <!-- ===== ç¶²çµ¡èˆ‡æµé‡æ§åˆ¶ ===== -->
        <div class="nav-section-title" data-section="network">ç¶²çµ¡èˆ‡æµé‡æ§åˆ¶</div>

        <button class="nav-item" data-topic="topics/port-forwarding.html" data-category="network">
          <span class="nav-icon" style="background:rgba(248,113,113,0.15)">ğŸ”Œ</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Port Forwarding</span>
            <span class="nav-item-sub">NAT / Router è¦å‰‡ / Tunneling</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/localhost-hosting.html" data-category="network">
          <span class="nav-icon" style="background:rgba(16,185,129,0.15)">ğŸ </span>
          <span class="nav-item-text">
            <span class="nav-item-title">æœ¬åœ°é–‹ç™¼åˆ†äº«</span>
            <span class="nav-item-sub">ngrok / Cloudflare Tunnel</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/cdn.html" data-category="network">
          <span class="nav-icon" style="background:rgba(34,197,94,0.15)">ğŸŒ</span>
          <span class="nav-item-text">
            <span class="nav-item-title">CDN å…§å®¹åˆ†ç™¼</span>
            <span class="nav-item-sub">GeoDNS / Edge Cache / Purge</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/load-balancer.html" data-category="network">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">âš–ï¸</span>
          <span class="nav-item-text">
            <span class="nav-item-title">è² è¼‰å‡è¡¡å™¨</span>
            <span class="nav-item-sub">Round Robin / L4 vs L7 / Health Check</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/api-gateway.html" data-category="network">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">ğŸšª</span>
          <span class="nav-item-text">
            <span class="nav-item-title">API é–˜é“</span>
            <span class="nav-item-sub">é©—è­‰ / é™æµ / è·¯ç”±åˆ†ç™¼</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/large-api-response.html" data-category="network">
          <span class="nav-icon" style="background:rgba(59,130,246,0.15)">ğŸ“¦</span>
          <span class="nav-item-text">
            <span class="nav-item-title">å¤§å‹ API å›æ‡‰</span>
            <span class="nav-item-sub">Pagination / å£“ç¸® / S3 å¸è¼‰</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/rate-limiter.html" data-category="network">
          <span class="nav-icon" style="background:rgba(239,68,68,0.15)">ğŸš¦</span>
          <span class="nav-item-text">
            <span class="nav-item-title">æµé‡é™åˆ¶å™¨</span>
            <span class="nav-item-sub">Token Bucket / Sliding Window / 429</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/scraping-vs-crawling.html" data-category="network">
          <span class="nav-icon" style="background:rgba(139,92,246,0.15)">ğŸ•·</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Scraping vs Crawling</span>
            <span class="nav-item-sub">æ•¸æ“šæå– / ç¶²ç«™åœ°åœ– / SEO</span>
          </span>
        </button>

        <!-- ===== æ•¸æ“šèˆ‡å­˜å„² ===== -->
        <div class="nav-section-title" data-section="storage">æ•¸æ“šèˆ‡å­˜å„²</div>

        <button class="nav-item" data-topic="topics/database-basics.html" data-category="storage">
          <span class="nav-icon" style="background:rgba(59,130,246,0.15)">ğŸ—ƒ</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Database åŸºç¤</span>
            <span class="nav-item-sub">DBMS / ACID / SQL vs NoSQL</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/pick-database.html" data-category="storage">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">ğŸ¯</span>
          <span class="nav-item-text">
            <span class="nav-item-title">é»æ€ Database</span>
            <span class="nav-item-sub">CAP å®šç† / SQL vs NoSQL</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/redis.html" data-category="storage">
          <span class="nav-icon" style="background:rgba(239,68,68,0.15)">âš¡</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Redis</span>
            <span class="nav-item-sub">In-Memory / Leaderboard / Postgres é…åˆ</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/key-value-store.html" data-category="storage">
          <span class="nav-icon" style="background:rgba(139,92,246,0.15)">ğŸ—„</span>
          <span class="nav-item-text">
            <span class="nav-item-title">éµå€¼å­˜å„²</span>
            <span class="nav-item-sub">åˆ†å€ / è¤‡è£½ / Quorum å…±è­˜</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/object-storage.html" data-category="storage">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">ğŸ“¦</span>
          <span class="nav-item-text">
            <span class="nav-item-title">ç‰©ä»¶å­˜å„²</span>
            <span class="nav-item-sub">é ç°½åç¶²å€ / åˆ†æ®µä¸Šå‚³ / CDN</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/unique-id-generator.html" data-category="storage">
          <span class="nav-icon" style="background:rgba(34,197,94,0.15)">â„ï¸</span>
          <span class="nav-item-text">
            <span class="nav-item-title">å”¯ä¸€ ID ç”Ÿæˆå™¨</span>
            <span class="nav-item-sub">Snowflake 64-bit / æ™‚é–“æ’åº</span>
          </span>
        </button>

        <!-- ===== å¿«å–èˆ‡è®€å–å„ªåŒ– ===== -->
        <div class="nav-section-title" data-section="cache">å¿«å–èˆ‡è®€å–å„ªåŒ–</div>

        <button class="nav-item" data-topic="topics/cache-invalidation.html" data-category="cache">
          <span class="nav-icon cache">âš¡</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Cache å¤±æ•ˆç­–ç•¥</span>
            <span class="nav-item-sub">TTL / Write Through / Around / Back</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/fix-slow-database.html" data-category="cache">
          <span class="nav-icon" style="background:rgba(239,68,68,0.15)">ğŸŒ</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Debug æ…¢ Database</span>
            <span class="nav-item-sub">Slow Query / Index / Cache / æ› DB</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/scale-reads.html" data-category="cache">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">ğŸ“ˆ</span>
          <span class="nav-item-text">
            <span class="nav-item-title">è®€å–æ“´å±•</span>
            <span class="nav-item-sub">ç´¢å¼• / ä¸‰å±¤å¿«å– / è®€å–å‰¯æœ¬</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/distributed-cache.html" data-category="cache">
          <span class="nav-icon" style="background:rgba(239,68,68,0.15)">âš¡</span>
          <span class="nav-item-text">
            <span class="nav-item-title">åˆ†æ•£å¼å¿«å–</span>
            <span class="nav-item-sub">Consistent Hashing / é›ªå´©é˜²è­·</span>
          </span>
        </button>

        <!-- ===== ç•°æ­¥èˆ‡æ¶ˆæ¯è™•ç† ===== -->
        <div class="nav-section-title" data-section="async">ç•°æ­¥èˆ‡æ¶ˆæ¯è™•ç†</div>

        <button class="nav-item" data-topic="topics/task-queue.html" data-category="async">
          <span class="nav-icon" style="background:rgba(99,102,241,0.15)">ğŸ“‹</span>
          <span class="nav-item-text">
            <span class="nav-item-title">ä»»å‹™ä½‡åˆ—</span>
            <span class="nav-item-sub">ç•°æ­¥ä»»å‹™ / é‡è©¦æ©Ÿåˆ¶ / æ­»ä¿¡ä½‡åˆ—</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/notification-system.html" data-category="async">
          <span class="nav-icon" style="background:rgba(236,72,153,0.15)">ğŸ””</span>
          <span class="nav-item-text">
            <span class="nav-item-title">é€šçŸ¥ç³»çµ±</span>
            <span class="nav-item-sub">æ¨é€ / çŸ­è¨Š / é›»éƒµå¤šæ¸ é“</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/message-queue.html" data-category="async">
          <span class="nav-icon" style="background:rgba(16,185,129,0.15)">ğŸ“¨</span>
          <span class="nav-item-text">
            <span class="nav-item-title">æ¶ˆæ¯ä½‡åˆ—</span>
            <span class="nav-item-sub">Kafka / ç™¼ä½ˆè¨‚é–± / ç²¾ç¢ºä¸€æ¬¡</span>
          </span>
        </button>

        <!-- ===== æ‡‰ç”¨ç³»çµ±è¨­è¨ˆ ===== -->
        <div class="nav-section-title" data-section="app">æ‡‰ç”¨ç³»çµ±è¨­è¨ˆ</div>

        <button class="nav-item" data-topic="topics/url-shortener.html" data-category="app">
          <span class="nav-icon" style="background:rgba(16,185,129,0.15)">ğŸ”—</span>
          <span class="nav-item-text">
            <span class="nav-item-title">çŸ­ç¶²å€ç³»çµ±</span>
            <span class="nav-item-sub">Base62 / 301 vs 302 / æ•¸æ“šåˆ†æ</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/session-manager.html" data-category="app">
          <span class="nav-icon" style="background:rgba(99,102,241,0.15)">ğŸ”</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Session ç®¡ç†å™¨</span>
            <span class="nav-item-sub">Cookie vs JWT / Redis å­˜å„²</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/search-autocomplete.html" data-category="app">
          <span class="nav-icon" style="background:rgba(139,92,246,0.15)">ğŸ”</span>
          <span class="nav-item-text">
            <span class="nav-item-title">æœå°‹è‡ªå‹•è£œå…¨</span>
            <span class="nav-item-sub">Trie å‰ç¶´æ¨¹ / æ’å / é˜²æŠ–</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/web-crawler.html" data-category="app">
          <span class="nav-icon" style="background:rgba(248,113,113,0.15)">ğŸ•·</span>
          <span class="nav-item-text">
            <span class="nav-item-title">ç¶²é çˆ¬èŸ²</span>
            <span class="nav-item-sub">å»£åº¦å„ªå…ˆ / å¸ƒéš†éæ¿¾å™¨ / robots.txt</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/news-feed.html" data-category="app">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">ğŸ“°</span>
          <span class="nav-item-text">
            <span class="nav-item-title">å‹•æ…‹æ¶ˆæ¯æµ</span>
            <span class="nav-item-sub">å¯«æ™‚æ¨é€ vs è®€æ™‚æ‹‰å– / æ’å</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/chat-system.html" data-category="app">
          <span class="nav-icon" style="background:rgba(59,130,246,0.15)">ğŸ’¬</span>
          <span class="nav-item-text">
            <span class="nav-item-title">å³æ™‚é€šè¨Šç³»çµ±</span>
            <span class="nav-item-sub">WebSocket / æ¶ˆæ¯ä½‡åˆ— / é›¢ç·šæ¶ˆæ¯</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/chess-game-design.html" data-category="app">
          <span class="nav-icon" style="background:rgba(34,197,94,0.15)">â™Ÿ</span>
          <span class="nav-item-text">
            <span class="nav-item-title">ç·šä¸Šæ£‹é¡éŠæˆ²</span>
            <span class="nav-item-sub">Matchmaking / WebSocket / Game State</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/video-streaming.html" data-category="app">
          <span class="nav-icon" style="background:rgba(236,72,153,0.15)">ğŸ¬</span>
          <span class="nav-item-text">
            <span class="nav-item-title">å½±ç‰‡ä¸²æµ</span>
            <span class="nav-item-sub">è½‰ç¢¼ / HLS-DASH / CDN åˆ†ç™¼</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/payment-system.html" data-category="app">
          <span class="nav-icon" style="background:rgba(34,197,94,0.15)">ğŸ’³</span>
          <span class="nav-item-text">
            <span class="nav-item-title">æ”¯ä»˜ç³»çµ±</span>
            <span class="nav-item-sub">å†ªç­‰æ€§ / è¤‡å¼è¨˜å¸³ / Saga / Webhook</span>
          </span>
        </button>

        <!-- ===== ç›£æ§èˆ‡å®‰å…¨ ===== -->
        <div class="nav-section-title" data-section="security">ç›£æ§èˆ‡å®‰å…¨</div>

        <button class="nav-item" data-topic="topics/authentication.html" data-category="security">
          <span class="nav-icon" style="background:rgba(248,113,113,0.15)">ğŸ”‘</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Authentication é©—è­‰</span>
            <span class="nav-item-sub">Basic / Session / JWT</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/server-vs-serverless.html" data-category="security">
          <span class="nav-icon" style="background:rgba(16,185,129,0.15)">ğŸ–¥</span>
          <span class="nav-item-text">
            <span class="nav-item-title">Server vs Serverless</span>
            <span class="nav-item-sub">VPS / Lambda / é»æ¨£æ€</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/self-host-vs-cloud.html" data-category="security">
          <span class="nav-icon" style="background:rgba(245,158,11,0.15)">â˜ï¸</span>
          <span class="nav-item-text">
            <span class="nav-item-title">è‡ªæ¶ vs é›²ç«¯</span>
            <span class="nav-item-sub">AWS vs è‡ªæ¶ / æ“´å±• / ç›£æ§æ¯”è¼ƒ</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/metrics-logging.html" data-category="security">
          <span class="nav-icon" style="background:rgba(99,102,241,0.15)">ğŸ“Š</span>
          <span class="nav-item-text">
            <span class="nav-item-title">ç›£æ§èˆ‡æ—¥èªŒ</span>
            <span class="nav-item-sub">Kafka / Prometheus / Grafana</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/monitoring.html" data-category="security">
          <span class="nav-icon" style="background:rgba(16,185,129,0.15)">ğŸ“¡</span>
          <span class="nav-item-text">
            <span class="nav-item-title">æ‡‰ç”¨ç¨‹å¼ç›£æ§</span>
            <span class="nav-item-sub">Prometheus / Grafana / å‘Šè­¦ç³»çµ±</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/cicd-pipeline.html" data-category="security">
          <span class="nav-icon" style="background:rgba(59,130,246,0.15)">ğŸ”„</span>
          <span class="nav-item-text">
            <span class="nav-item-title">CI/CD è‡ªå‹•åŒ–éƒ¨ç½²</span>
            <span class="nav-item-sub">GitHub Actions / IaC / è‡ªå‹•æ¸¬è©¦</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/secure-ai-agents.html" data-category="security">
          <span class="nav-icon" style="background:rgba(248,113,113,0.15)">ğŸ›¡</span>
          <span class="nav-item-text">
            <span class="nav-item-title">AI Agent å®‰å…¨</span>
            <span class="nav-item-sub">Lethal Trifecta / Guardrail é˜²è­·</span>
          </span>
        </button>

        <button class="nav-item" data-topic="topics/ai-scraper-defense.html" data-category="security">
          <span class="nav-icon" style="background:rgba(139,92,246,0.15)">ğŸ•¸ï¸</span>
          <span class="nav-item-text">
            <span class="nav-item-title">é˜²ç¦¦ AI çˆ¬èŸ²</span>
            <span class="nav-item-sub">robots.txt / Honeypot / Bot åµæ¸¬</span>
          </span>
        </button>

        <!-- ===== éƒ¨ç½²èˆ‡è¨—ç®¡ ===== -->
        <div class="nav-section-title" data-section="deploy">éƒ¨ç½²èˆ‡è¨—ç®¡</div>

        <button class="nav-item" data-topic="topics/deployment.html" data-category="deploy">
          <span class="nav-icon" style="background:rgba(16,185,129,0.15)">ğŸš€</span>
          <span class="nav-item-text">
            <span class="nav-item-title">å…è²»éƒ¨ç½²å¹³å°</span>
            <span class="nav-item-sub">Vercel / Railway / Supabase / Firebase</span>
          </span>
        </button>

        <!-- ===== å­¸ç¿’è³‡æº ===== -->
        <div class="nav-section-title" data-section="resource">å­¸ç¿’è³‡æº</div>

        <button class="nav-item coming-soon" data-topic="topics/references.html" data-category="resource" disabled>
          <span class="nav-icon" style="background:rgba(251,191,36,0.15)">ğŸ“š</span>
          <span class="nav-item-text">
            <span class="nav-item-title">å­¸ç¿’è³‡æºåƒè€ƒ</span>
            <span class="nav-item-sub">YouTube / Reddit / GitHub / æ›¸ç±</span>
          </span>
        </button>
      </nav>

      <div class="sidebar-footer">
        <div id="progressCount"></div>
        ç”¨æœ€ç°¡å–®å˜…æ–¹å¼å­¸æœ€è¤‡é›œå˜…æ¦‚å¿µ
      </div>
    </aside>

    <!-- ==================== Main Content ==================== -->
    <main class="main-content" id="mainContent">
      <!-- Welcome screen -->
      <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-icon">ğŸ—</div>
        <h2>æ­¡è¿åšŸåˆ°ç³»çµ±æ¶æ§‹æ•™å®¤</h2>
        <p>å‘¢åº¦ç”¨å»£æ±è©±ï¼Œç”¨æœ€ç°¡å–®ã€æœ€ç›´ç™½å˜…æ–¹å¼ï¼Œç†è§£å„ç¨®ç³»çµ±è¨­è¨ˆå˜…æ¦‚å¿µåŒæ¶æ§‹åœ–ã€‚</p>
        <div class="welcome-hint">
          <span class="arrow">ğŸ‘ˆ</span>
          <span>å–ºå·¦é‚Šæ€ä¸€å€‹èª²é¡Œé–‹å§‹å­¸ç¿’</span>
        </div>
      </div>

      <!-- Topic iframe (hidden initially) -->
      <iframe id="topicFrame" style="display:none;" title="èª²é¡Œå…§å®¹"></iframe>
    </main>
  </div>

  <!-- ==================== Chat Widget ==================== -->
  <button class="chat-fab" id="chatFab" aria-label="AI åŠ©æ‰‹">ğŸ¤–</button>

  <div class="chat-panel" id="chatPanel">
    <div class="chat-panel-header">
      <span>ğŸ¤– AI åŠ©æ‰‹</span>
      <button class="chat-close-btn" id="chatCloseBtn" aria-label="é—œé–‰">âœ•</button>
    </div>

    <!-- Welcome / Login view -->
    <div class="chat-welcome" id="chatWelcomeView">
      <div class="chat-welcome-intro">
        <h3>AI åŠ©æ‰‹åŠŸèƒ½</h3>
        <p>å°ˆç‚ºç³»çµ±æ¶æ§‹æ•™å®¤è¨­è¨ˆå˜… AI å·¥å…·ï¼Œå¹«æ‰‹æ›´æœ‰æ•ˆç‡å’å­¸ç¿’åŒå¯¦è¸ã€‚</p>
      </div>

      <div class="chat-feature-list">
        <div class="chat-feature-item">
          <span class="feat-icon">ğŸ”</span>
          <span class="feat-label">æ™ºèƒ½æœå°‹</span>
          <span class="feat-desc">é—œéµå­—æµèª²é¡Œï¼Œç›´æ¥è·³è½‰</span>
        </div>
        <div class="chat-feature-item">
          <span class="feat-icon">âœï¸</span>
          <span class="feat-label">Prompt ç”Ÿæˆå™¨</span>
          <span class="feat-desc">AI Viber æ¨¡æ¿ï¼Œä¸€éµç”Ÿæˆ</span>
        </div>
      </div>

      <a class="chat-coffee-cta" href="https://buymeacoffee.com/hillmanchan709" target="_blank" rel="noopener noreferrer">
        <span class="cta-icon">â˜•</span>
        <div class="cta-text">
          <strong>Buy Me a Coffee è§£é– AI åŠŸèƒ½</strong>
          <span>ä»˜æ¬¾å¾Œæœƒæ”¶åˆ°é›»éƒµåŒå­˜å–ç¢¼</span>
        </div>
        <span class="cta-arrow">â†’</span>
      </a>

      <div class="chat-login-divider">
        <span>å·²æœ‰å­˜å–ç¢¼ï¼Ÿç™»å…¥</span>
      </div>

      <div class="chat-login-form" id="chatLoginForm">
        <input type="email" id="chatEmail" placeholder="é›»éƒµåœ°å€" autocomplete="email">
        <input type="text" id="chatCode" placeholder="å­˜å–ç¢¼ï¼ˆä¾‹å¦‚ SA2026-XXXXï¼‰" autocomplete="off">
        <div class="chat-login-error" id="chatLoginError"></div>
        <button class="chat-login-btn" id="chatLoginBtn">ç™»å…¥</button>
      </div>
    </div>

    <!-- Main view (after login) -->
    <div class="chat-main" id="chatMainView">
      <div class="chat-actions">
        <button class="chat-action-btn active" data-mode="search" id="actionSearch">
          <span class="action-icon">ğŸ”</span>
          <span class="action-label">æœå°‹èª²é¡Œ</span>
          <span class="action-desc">æµç›¸é—œèª²é¡Œ</span>
        </button>
        <button class="chat-action-btn" data-mode="viber" id="actionViber">
          <span class="action-icon">âœï¸</span>
          <span class="action-label">Prompt ç”Ÿæˆå™¨</span>
          <span class="action-desc">AI Viber Prompt</span>
        </button>
      </div>

      <!-- Viber: topic picker (hidden by default) -->
      <div class="chat-topic-picker" id="chatTopicPicker" style="display:none;">
        <label>æ€ä¸€å€‹èª²é¡Œä½œç‚º Prompt æ¨¡æ¿ï¼š</label>
        <select id="chatTopicSelect">
          <option value="">-- è«‹æ€èª²é¡Œ --</option>
        </select>
      </div>

      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input-area" id="chatInputArea">
        <textarea id="chatInput" rows="1" placeholder="è¼¸å…¥é—œéµå­—æœå°‹èª²é¡Œ..."></textarea>
        <button class="chat-send-btn" id="chatSendBtn" aria-label="ç™¼é€">â¤</button>
      </div>
    </div>
  </div>

  <script>
    const navItems = document.querySelectorAll('.nav-item:not(.coming-soon)');
    const welcomeScreen = document.getElementById('welcomeScreen');
    const topicFrame = document.getElementById('topicFrame');
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const menuBtn = document.getElementById('menuBtn');
    const sidebarHeader = document.getElementById('sidebarHeader');
    const navSearch = document.getElementById('navSearch');

    // ==================== Hash Deep Linking ====================
    function topicToHash(url) {
      return url.replace('topics/', '').replace('.html', '');
    }

    function hashToTopic(hash) {
      const slug = hash.replace('#', '');
      return slug ? 'topics/' + slug + '.html' : '';
    }

    // ==================== Progress Tracker ====================
    const STORAGE_KEY = 'sa-viewed-topics';

    function getViewedTopics() {
      try {
        return JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
      } catch { return []; }
    }

    function markTopicViewed(url) {
      const viewed = getViewedTopics();
      if (!viewed.includes(url)) {
        viewed.push(url);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(viewed));
      }
      updateViewedIndicators();
      updateProgressCount();
    }

    function updateViewedIndicators() {
      const viewed = getViewedTopics();
      document.querySelectorAll('.nav-item[data-topic]').forEach(item => {
        const existing = item.querySelector('.viewed-dot');
        if (existing) existing.remove();
        if (viewed.includes(item.getAttribute('data-topic')) && !item.querySelector('.coming-soon-badge')) {
          const dot = document.createElement('span');
          dot.className = 'viewed-dot';
          item.appendChild(dot);
        }
      });
    }

    function updateProgressCount() {
      const viewed = getViewedTopics();
      const total = document.querySelectorAll('.nav-item:not(.coming-soon)[data-topic]').length;
      const count = viewed.filter(url =>
        document.querySelector(`.nav-item[data-topic="${url}"]`)
      ).length;
      const el = document.getElementById('progressCount');
      if (el) el.textContent = count > 0 ? `å·²é–±è®€ ${count} / ${total} èª²` : '';
    }

    // ==================== Load Topic ====================
    function loadTopic(url, btn) {
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      if (btn) btn.classList.add('active');

      welcomeScreen.classList.add('hidden');
      topicFrame.style.display = 'block';
      topicFrame.src = url;

      // Update hash
      window.location.hash = topicToHash(url);

      // Track progress
      markTopicViewed(url);

      sidebar.classList.remove('open');
      overlay.classList.remove('visible');
    }

    // Go home
    function goHome() {
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      welcomeScreen.classList.add('hidden');
      topicFrame.style.display = 'block';
      topicFrame.src = 'topics/welcome.html';

      history.replaceState(null, '', window.location.pathname + window.location.search);

      sidebar.classList.remove('open');
      overlay.classList.remove('visible');
    }

    // Sidebar header â†’ home
    sidebarHeader.addEventListener('click', goHome);

    // Nav items
    navItems.forEach(item => {
      item.addEventListener('click', () => {
        const topic = item.getAttribute('data-topic');
        if (topic) loadTopic(topic, item);
      });
    });

    // ==================== Hash-aware Init ====================
    function initFromHash() {
      const hash = window.location.hash;
      if (hash && hash.length > 1) {
        const topicUrl = hashToTopic(hash);
        const targetBtn = document.querySelector(`.nav-item[data-topic="${topicUrl}"]`);
        if (targetBtn && !targetBtn.classList.contains('coming-soon')) {
          loadTopic(topicUrl, targetBtn);
          return;
        }
      }
      goHome();
    }

    initFromHash();

    // Browser back/forward
    window.addEventListener('hashchange', () => {
      const hash = window.location.hash;
      if (!hash || hash === '#') {
        goHome();
        return;
      }
      const topicUrl = hashToTopic(hash);
      const targetBtn = document.querySelector(`.nav-item[data-topic="${topicUrl}"]`);
      if (targetBtn && !targetBtn.classList.contains('coming-soon')) {
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        targetBtn.classList.add('active');
        welcomeScreen.classList.add('hidden');
        topicFrame.style.display = 'block';
        topicFrame.src = topicUrl;
        markTopicViewed(topicUrl);
      }
    });

    // Mobile menu
    menuBtn.addEventListener('click', () => {
      sidebar.classList.toggle('open');
      overlay.classList.toggle('visible');
    });

    overlay.addEventListener('click', () => {
      sidebar.classList.remove('open');
      overlay.classList.remove('visible');
    });

    // Listen for navigation requests from welcome page (iframe postMessage)
    window.addEventListener('message', (e) => {
      if (e.origin !== window.location.origin) return;
      if (e.data && e.data.type === 'loadTopic' && e.data.url) {
        const targetBtn = document.querySelector(`.nav-item[data-topic="${e.data.url}"]`);
        if (targetBtn) {
          loadTopic(e.data.url, targetBtn);
        }
      }
    });

    // ==================== Filters ====================
    const filterChips = document.querySelectorAll('.filter-chip');
    const sectionTitles = document.querySelectorAll('.nav-section-title[data-section]');
    const filteredItems = document.querySelectorAll('.nav-item[data-category]');

    function getActiveFilter() {
      const active = document.querySelector('.filter-chip.active');
      return active ? active.getAttribute('data-filter') : 'all';
    }

    function applyFilter(filter) {
      if (filter === 'all') {
        sectionTitles.forEach(t => t.classList.remove('hidden'));
        filteredItems.forEach(i => i.classList.remove('hidden'));
      } else {
        sectionTitles.forEach(t => {
          t.classList.toggle('hidden', t.getAttribute('data-section') !== filter);
        });
        filteredItems.forEach(i => {
          i.classList.toggle('hidden', i.getAttribute('data-category') !== filter);
        });
      }
    }

    filterChips.forEach(chip => {
      chip.addEventListener('click', () => {
        const filter = chip.getAttribute('data-filter');
        filterChips.forEach(c => c.classList.remove('active'));
        chip.classList.add('active');
        navSearch.value = '';
        applyFilter(filter);
      });
    });

    // ==================== Sidebar Search ====================
    navSearch.addEventListener('input', () => {
      const query = navSearch.value.trim().toLowerCase();

      if (!query) {
        // Restore to current filter
        applyFilter(getActiveFilter());
        return;
      }

      // Search across all items regardless of filter
      filteredItems.forEach(item => {
        const title = (item.querySelector('.nav-item-title')?.textContent || '').toLowerCase();
        const sub = (item.querySelector('.nav-item-sub')?.textContent || '').toLowerCase();
        item.classList.toggle('hidden', !title.includes(query) && !sub.includes(query));
      });

      // Show/hide section titles based on visible children
      sectionTitles.forEach(title => {
        const section = title.getAttribute('data-section');
        const hasVisible = Array.from(
          document.querySelectorAll(`.nav-item[data-category="${section}"]`)
        ).some(i => !i.classList.contains('hidden'));
        title.classList.toggle('hidden', !hasVisible);
      });
    });

    // ==================== Keyboard Navigation ====================
    document.addEventListener('keydown', (e) => {
      const active = document.activeElement;
      if (active === topicFrame || active === navSearch) return;

      if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
        e.preventDefault();
        const visible = Array.from(document.querySelectorAll('.nav-item:not(.hidden):not(.coming-soon)'));
        if (!visible.length) return;

        const currentIdx = visible.indexOf(document.activeElement);
        let nextIdx;
        if (e.key === 'ArrowDown') {
          nextIdx = currentIdx < 0 ? 0 : Math.min(currentIdx + 1, visible.length - 1);
        } else {
          nextIdx = currentIdx < 0 ? visible.length - 1 : Math.max(currentIdx - 1, 0);
        }
        visible[nextIdx].focus();
        visible[nextIdx].scrollIntoView({ block: 'nearest' });
      }

      if (e.key === 'Enter' && active?.classList.contains('nav-item')) {
        active.click();
      }
    });

    // ==================== Init Progress UI ====================
    updateViewedIndicators();
    updateProgressCount();

    // ==================== Chat Widget ====================
    (function () {
      const API_BASE = 'https://api.system-design.hillmanchan.com';
      const TOKEN_KEY = 'sa-chat-token';

      const fab = document.getElementById('chatFab');
      const panel = document.getElementById('chatPanel');
      const closeBtn = document.getElementById('chatCloseBtn');
      const welcomeView = document.getElementById('chatWelcomeView');
      const mainView = document.getElementById('chatMainView');
      const emailInput = document.getElementById('chatEmail');
      const codeInput = document.getElementById('chatCode');
      const loginBtn = document.getElementById('chatLoginBtn');
      const loginError = document.getElementById('chatLoginError');
      const messages = document.getElementById('chatMessages');
      const chatInput = document.getElementById('chatInput');
      const sendBtn = document.getElementById('chatSendBtn');
      const actionBtns = document.querySelectorAll('.chat-action-btn');
      const topicPicker = document.getElementById('chatTopicPicker');
      const topicSelect = document.getElementById('chatTopicSelect');

      let currentMode = 'search';

      // ---- JWT helpers ----
      function decodePayload(token) {
        try {
          const parts = token.split('.');
          if (parts.length !== 3) return null;
          const body = parts[1].replace(/-/g, '+').replace(/_/g, '/');
          return JSON.parse(atob(body));
        } catch { return null; }
      }

      function getToken() {
        const token = localStorage.getItem(TOKEN_KEY);
        if (!token) return null;
        const p = decodePayload(token);
        if (!p) {
          localStorage.removeItem(TOKEN_KEY);
          return null;
        }
        // Only check exp if present (permanent tokens have no exp)
        if (p.exp && p.exp < Date.now() / 1000) {
          localStorage.removeItem(TOKEN_KEY);
          return null;
        }
        return token;
      }

      function clearToken() {
        localStorage.removeItem(TOKEN_KEY);
        mainView.classList.remove('active');
        welcomeView.style.display = '';
        loginError.textContent = '';
      }

      // ---- UI state ----
      function showChat() {
        if (getToken()) {
          welcomeView.style.display = 'none';
          mainView.classList.add('active');
          populateTopicSelect();
        } else {
          welcomeView.style.display = '';
          mainView.classList.remove('active');
        }
      }

      fab.addEventListener('click', () => {
        fab.classList.add('open');
        panel.classList.add('open');
        showChat();
      });

      closeBtn.addEventListener('click', () => {
        panel.classList.remove('open');
        fab.classList.remove('open');
      });

      // ---- Login ----
      async function doLogin() {
        const email = emailInput.value.trim();
        const code = codeInput.value.trim();
        if (!email || !code) {
          loginError.textContent = 'è«‹å¡«å¯«é›»éƒµåŒå­˜å–ç¢¼';
          return;
        }

        loginBtn.disabled = true;
        loginError.textContent = '';

        try {
          const res = await fetch(`${API_BASE}/auth/login`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, code }),
          });

          const data = await res.json();

          if (!res.ok) {
            loginError.textContent = data.error || 'ç™»å…¥å¤±æ•—';
            return;
          }

          localStorage.setItem(TOKEN_KEY, data.token);
          welcomeView.style.display = 'none';
          mainView.classList.add('active');
          populateTopicSelect();
        } catch {
          loginError.textContent = 'ç¶²çµ¡éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦';
        } finally {
          loginBtn.disabled = false;
        }
      }

      loginBtn.addEventListener('click', doLogin);
      codeInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') doLogin();
      });

      // ---- Mode toggle (action buttons) ----
      actionBtns.forEach((btn) => {
        btn.addEventListener('click', () => {
          actionBtns.forEach((b) => b.classList.remove('active'));
          btn.classList.add('active');
          currentMode = btn.getAttribute('data-mode');

          if (currentMode === 'search') {
            topicPicker.style.display = 'none';
            chatInput.placeholder = 'è¼¸å…¥é—œéµå­—æœå°‹èª²é¡Œ...';
          } else {
            topicPicker.style.display = '';
            chatInput.placeholder = 'æè¿°å…·é«”éœ€æ±‚ï¼Œä¾‹å¦‚ã€Œé›»å•†å¹³å°å˜…æ”¯ä»˜ç³»çµ±ã€...';
          }
        });
      });

      // ---- Populate topic dropdown from sidebar nav items ----
      let topicSelectPopulated = false;

      function populateTopicSelect() {
        if (topicSelectPopulated) return;
        topicSelectPopulated = true;

        // Build from sidebar nav items that have AI Viber content
        const allNavItems = document.querySelectorAll('.nav-item[data-topic]:not(.coming-soon)');
        allNavItems.forEach((item) => {
          const url = item.getAttribute('data-topic');
          const title = item.querySelector('.nav-item-title')?.textContent || '';
          if (title) {
            const opt = document.createElement('option');
            opt.value = url;
            opt.textContent = title;
            topicSelect.appendChild(opt);
          }
        });
      }

      // ---- Messages ----
      function addMsg(content, type) {
        const div = document.createElement('div');
        div.className = `chat-msg ${type}`;
        div.textContent = content;
        messages.appendChild(div);
        messages.scrollTop = messages.scrollHeight;
        return div;
      }

      function addBotHtml(html) {
        const div = document.createElement('div');
        div.className = 'chat-msg bot';
        div.innerHTML = html;
        messages.appendChild(div);
        messages.scrollTop = messages.scrollHeight;
        return div;
      }

      function addTyping() {
        const div = document.createElement('div');
        div.className = 'chat-typing';
        div.innerHTML = '<span>.</span><span>.</span><span>.</span>';
        div.id = 'chatTyping';
        messages.appendChild(div);
        messages.scrollTop = messages.scrollHeight;
        return div;
      }

      function removeTyping() {
        const el = document.getElementById('chatTyping');
        if (el) el.remove();
      }

      function escapeHtml(str) {
        const d = document.createElement('div');
        d.textContent = str;
        return d.innerHTML;
      }

      // ---- Search result cards ----
      function renderSearchResults(results) {
        if (!results.length) {
          addBotHtml('<div class="chat-result-card coming-soon"><div class="card-title">æµå””åˆ°ç›¸é—œèª²é¡Œ</div><div class="card-desc">è©¦ä¸‹ç”¨å…¶ä»–é—œéµå­—ï¼Œæˆ–è€…å‘¢å€‹èª²é¡Œä»²æœªæ¨å‡ºã€‚</div></div>');
          return;
        }

        let html = '';
        for (const r of results) {
          const hasViber = r.prompts && r.prompts.length > 0;
          html += `<div class="chat-result-card" data-url="${r.url}">`;
          html += `<div class="card-title">${escapeHtml(r.h1 || r.title)}</div>`;
          if (r.description) {
            html += `<div class="card-desc">${escapeHtml(r.description)}</div>`;
          }
          html += `<div class="card-cat">${escapeHtml(r.category || '')}${hasViber ? ' Â· AI Viber' : ''}</div>`;
          html += '</div>';
        }

        const container = addBotHtml(html);

        container.querySelectorAll('.chat-result-card').forEach((card) => {
          card.addEventListener('click', () => {
            const url = card.getAttribute('data-url');
            const btn = document.querySelector(`.nav-item[data-topic="${url}"]`);
            loadTopic(url, btn);
            if (window.innerWidth <= 768) {
              panel.classList.remove('open');
              fab.classList.remove('open');
            }
          });
        });
      }

      // ---- Viber prompt result ----
      function renderViber(generated) {
        let html = `<div class="chat-viber-output">${escapeHtml(generated)}</div>`;
        html += '<button class="chat-copy-btn" id="chatCopyViber">ğŸ“‹ è¤‡è£½ Prompt</button>';

        const container = addBotHtml(html);

        container.querySelector('.chat-copy-btn').addEventListener('click', function () {
          const self = this;
          navigator.clipboard.writeText(generated).then(() => {
            self.textContent = 'âœ… å·²è¤‡è£½';
            self.classList.add('copied');
            setTimeout(() => {
              self.textContent = 'ğŸ“‹ è¤‡è£½ Prompt';
              self.classList.remove('copied');
            }, 2000);
          });
        });
      }

      // ---- Send ----
      async function send() {
        const token = getToken();
        if (!token) {
          clearToken();
          return;
        }

        const value = chatInput.value.trim();
        if (!value) return;

        // Viber mode: need a topic selected
        if (currentMode === 'viber' && !topicSelect.value) {
          addMsg('è«‹å…ˆæ€ä¸€å€‹èª²é¡Œä½œç‚º Prompt æ¨¡æ¿ã€‚', 'bot error');
          return;
        }

        chatInput.value = '';
        chatInput.style.height = 'auto';
        sendBtn.disabled = true;

        addMsg(value, 'user');
        addTyping();

        let reqBody;
        if (currentMode === 'search') {
          reqBody = { mode: 'search', query: value };
        } else {
          reqBody = { mode: 'viber', text: value, topicUrl: topicSelect.value };
        }

        try {
          const res = await fetch(`${API_BASE}/ai/chat`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              Authorization: `Bearer ${token}`,
            },
            body: JSON.stringify(reqBody),
          });

          removeTyping();

          if (res.status === 401) {
            clearToken();
            addMsg('ç™»å…¥å·²å¤±æ•ˆï¼Œè«‹é‡æ–°ç™»å…¥ã€‚', 'bot error');
            return;
          }

          const data = await res.json();

          if (!res.ok) {
            if (res.status === 404) {
              addBotHtml('<div class="chat-result-card coming-soon"><div class="card-title">å‘¢å€‹èª²é¡Œæš«æ™‚æœªæœ‰ AI Viber Prompt</div><div class="card-desc">å¯ä»¥è©¦å…¶ä»–èª²é¡Œï¼Œæˆ–è€…ç­‰ä¹‹å¾Œæ›´æ–°ã€‚</div></div>');
            } else {
              addMsg(data.error || 'å‡ºç¾éŒ¯èª¤', 'bot error');
            }
            return;
          }

          if (currentMode === 'search') {
            renderSearchResults(data.results || []);
          } else {
            renderViber(data.generated || 'ç„¡å›æ‡‰');
          }
        } catch {
          removeTyping();
          addMsg('ç¶²çµ¡éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚', 'bot error');
        } finally {
          sendBtn.disabled = false;
        }
      }

      sendBtn.addEventListener('click', send);
      chatInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          send();
        }
      });

      // Auto-resize textarea
      chatInput.addEventListener('input', () => {
        chatInput.style.height = 'auto';
        chatInput.style.height = Math.min(chatInput.scrollHeight, 100) + 'px';
      });
    })();
  </script>
</body>
</html>
